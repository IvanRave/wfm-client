<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: viewmodels/workspace.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: viewmodels/workspace.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>ï»¿/** @module */
define([
    'jquery',
    'knockout',
    'services/datacontext',
    'helpers/modal-helper',
    'helpers/app-helper',
    'models/user-profile',
    'helpers/knockout-lazy',
    'models/wfm-param-squad'], function ($, ko, datacontext, bootstrapModal, appHelper, UserProfile) {
        'use strict';

        var exports = function () {
            // Test company Id with Guid format (this checks retry server check in WorkSpace view of Home controller
            ////if (!appHelper.isGuidValid(companyId)) {
            ////    var errValidMsg = 'Company id is not valid GUID';
            ////    alert(errValidMsg);
            ////    throw new TypeError(errValidMsg);
            ////}        

            var self = this;

            // Left tree menu with well regions, groups, fields, wells
            self.isVisibleMenu = ko.observable(true);

            // Left tree menu with well regions, groups, fields, wells
            self.toggleIsVisibleMenu = function () {
                self.isVisibleMenu(!ko.unwrap(self.isVisibleMenu));
            };

            self.sidebarWrapCss = ko.computed({
                read: function () {
                    return ko.unwrap(self.isVisibleMenu) ? 'sidebar-wrap-visible' : 'hidden';
                },
                deferEvaluation: true
            });

            self.workAreaCss = ko.computed({
                read: function () {
                    return ko.unwrap(self.isVisibleMenu) ? 'work-area' : '';
                },
                deferEvaluation: true
            });

            self.sidebarToggleCss = ko.computed({
                read: function () {
                    return ko.unwrap(self.isVisibleMenu) ? 'sidebar-toggle-visible' : 'sidebar-toggle-hidden';
                },
                deferEvaluation: true
            });

            // =====================================Wfm parameters begin==========================================================
            self.wfmParamSquadList = ko.lazyObservableArray(function () {
                datacontext.getWfmParamSquadList({ is_inclusive: true }).done(function (r) {
                    // WfmParamSquadList (convert data objects into array)
                    function importWfmParamSquadList(data) {
                        return $.map(data || [], function (item) { return datacontext.createWfmParamSquad(item); });
                    }

                    self.wfmParamSquadList(importWfmParamSquadList(r));
                });
            }, self);

            /** Get list of section patterns: lazy loading by first request */
            self.ListOfSectionPatternDto = ko.lazyObservableArray(function () {
                datacontext.getListOfSectionPattern().done(function (r) {
                    require(['models/section-pattern'], function (SectionPattern) {

                        function importListOfSectionPattern(data) {
                            return $.map(data || [], function (item) { return new SectionPattern(item); });
                        }

                        self.ListOfSectionPatternDto(importListOfSectionPattern(r));
                    });
                });
            }, self);

            // Get all parameters from all groups as one dimensional array
            self.wfmParameterList = ko.computed({
                read: function () {
                    return $.map(ko.unwrap(self.wfmParamSquadList), function (sqdElem) {
                        return $.map(ko.unwrap(sqdElem.wfmParameterList), function (prmElem) {
                            return prmElem;
                        });
                    });
                },
                deferEvaluation: true
            });
            // =====================================Wfm parameters end==========================================================

            // TODO: back after repair getUserProfile();    
            // TODO: move selectItem() logic to parent objects:
            // well.selectWell() => wellGroup.selectWell()

            ////console.log(choosedObj);

            // load list of well region, well field...
            ////function loadStructure() {
            ////    function getSucceeded(data) {
            ////        var mappedStructure = $.map(data, function (list) {
            ////            return new WellRegion(list, self);
            ////        });

            ////        self.wellRegionList(mappedStructure);

            ////        // route region/id/field/id/group/id/well/id
            ////        ////var choosedObj = getChoosedIdFromHash();
            ////        console.log(choosedObj);
            ////        var tmpRegion = appHelper.getElementByPropertyValue(self.wellRegionList(), 'Id', choosedObj.regionId);
            ////        if (tmpRegion) {
            ////            self.selectedWellRegion(tmpRegion);
            ////            tmpRegion.isOpenItem(true);
            ////            var tmpField = appHelper.getElementByPropertyValue(self.selectedWellRegion().WellFields(), 'Id', choosedObj.fieldId);
            ////            if (tmpField) {
            ////                self.selectedWellRegion().selectedWellField(tmpField);
            ////                tmpField.isOpenItem(true);
            ////                var tmpGroup = appHelper.getElementByPropertyValue(self.selectedWellRegion().selectedWellField().WellGroups(), 'Id', choosedObj.groupId);
            ////                if (tmpGroup) {
            ////                    self.selectedWellRegion().selectedWellField().selectedWellGroup(tmpGroup);
            ////                    tmpGroup.isOpenItem(true);
            ////                    var tmpWell = appHelper.getElementByPropertyValue(self.selectedWellRegion().selectedWellField().selectedWellGroup().Wells(), 'Id', choosedObj.wellId);
            ////                    if (tmpWell) {
            ////                        self.selectedWellRegion().selectedWellField().selectedWellGroup().selectedWell(tmpWell);
            ////                        tmpWell.isOpenItem(true);
            ////                        // todo: change logic - when change selected id - need to execute additional logic
            ////                        if (choosedObj.sectionId) {
            ////                            tmpWell.selectedSectionByPatternId(choosedObj.sectionId);
            ////                        }
            ////                        else {
            ////                            // Null - show dashboard: load all widget layouts and data
            ////                            tmpWell.unselectSection();
            ////                        }
            ////                        // Apchive: previously - set summary as a default page
            ////                        ////else {
            ////                        ////    tmpWell.selectedSectionId(tmpWell.sectionList[0].id);
            ////                        ////}

            ////                        // this set selected well
            ////                        ////console.log(self.selectedWellRegion().selectedWellField().selectedWellGroup().selectedWell());
            ////                    }
            ////                }
            ////            }
            ////        }
            ////    }

            ////    datacontext.getWellRegionList({
            ////        company_id: companyId,
            ////        is_inclusive: true
            ////    }).done(getSucceeded);
            ////}

            //     loadStructure();

            /** 
            * User profile
            * @type {module:models/user-profile}
            */
            self.userProfile = new UserProfile(self);

            /** Auth user profile and load data if successful */
            self.userProfile.loadAccountInfo();
        };

        return exports;
    });</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="company.html">models/company</a></li><li><a href="employee.html">models/employee</a></li><li><a href="file-spec.html">models/file-spec</a></li><li><a href="job-type.html">models/job-type</a></li><li><a href="section-of-well.html">models/section-of-well</a></li><li><a href="section-of-wield.html">models/section-of-wield</a></li><li><a href="section-pattern.html">models/section-pattern</a></li><li><a href="user-profile.html">models/user-profile</a></li><li><a href="wegion.html">models/wegion</a></li><li><a href="well.html">models/well</a></li><li><a href="well-field.html">models/well-field</a></li><li><a href="well-field-map.html">models/well-field-map</a></li><li><a href="well-file.html">models/well-file</a></li><li><a href="well-group.html">models/well-group</a></li><li><a href="well-group-wfm-parameter.html">models/well-group-wfm-parameter</a></li><li><a href="wfm-parameter.html">models/wfm-parameter</a></li><li><a href="workspace.html">viewmodels/workspace</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0</a> on Mon Dec 09 2013 12:00:53 GMT+0200 (EET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
