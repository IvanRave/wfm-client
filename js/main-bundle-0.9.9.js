define("require-config",[],function(){requirejs.config({waitSeconds:0,paths:{jquery:"jquery.min",d3:"d3.min"},shim:{"bootstrap/transition":{deps:["jquery"]},"bootstrap/modal":{deps:["jquery","bootstrap/transition"]},"bootstrap/dropdown":{deps:["jquery","bootstrap/transition"]},"jquery.slimscroll":{deps:["jquery"]},"jquery.Jcrop":{deps:["jquery"]},d3:{exports:"d3"}}})}),require(["require-config"],function(){require(["console-shim","es5-shim","es5-sham"],function(){require(["jquery","knockout","viewmodels/workspace","models/workspace","bindings/all-bindings","bindings/svg-bindings","jquery.panzoom"],function(e,t,n,i){var r=function(){return this.hasItems=t.computed({read:function(){return t.unwrap(this).length>0},deferEvaluation:!0,owner:this}),this};t.computed.fn.trackHasItems=r,t.observableArray.fn.trackHasItems=r;var o=new i,a=new n(o);e(function(){var n=e(".panzoom").panzoom({$zoomIn:e(".panzoom-in"),$zoomOut:e(".panzoom-out"),$reset:e(".panzoom-reset"),increment:.3,minScale:1e-4,maxScale:1e4});n.parent().on("mousewheel.focal",function(e){e.preventDefault();var t=e.delta||e.originalEvent.wheelDelta,i=t?0>t:e.originalEvent.deltaY>0;n.panzoom("zoom",i,{increment:.1,focal:e})});var i=document.getElementById("workspace-project");t.applyBindings(a,i),e(i).removeClass("hide")})})})}),define("main",function(){}),function(e){"function"==typeof define?define("es5-shim",e):"function"==typeof YUI?YUI.add("es5",e):e()}(function(){function e(){}function t(e){return e=+e,e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function n(e){var t=typeof e;return null===e||"undefined"===t||"boolean"===t||"number"===t||"string"===t}function i(e){var t,i,r;if(n(e))return e;if(i=e.valueOf,"function"==typeof i&&(t=i.call(e),n(t)))return t;if(r=e.toString,"function"==typeof r&&(t=r.call(e),n(t)))return t;throw new TypeError}8!==parseInt("08")&&(parseInt=function(e){var t=/^0[xX]/;return function(n,i){return n=String(n).trim(),+i||(i=t.test(n)?16:10),e(n,i)}}(parseInt)),Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if("function"!=typeof n)throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var i=p.call(arguments,1),r=function(){if(this instanceof l){var e=n.apply(this,i.concat(p.call(arguments)));return Object(e)===e?e:this}return n.apply(t,i.concat(p.call(arguments)))},o=Math.max(0,n.length-i.length),a=[],s=0;o>s;s++)a.push("$"+s);var l=Function("binder","return function("+a.join(",")+"){return binder.apply(this,arguments)}")(r);return n.prototype&&(e.prototype=n.prototype,l.prototype=new e,e.prototype=null),l});var r,o,a,s,l,u=Function.prototype.call,c=Array.prototype,d=Object.prototype,p=c.slice,f=u.bind(d.toString),h=u.bind(d.hasOwnProperty);if((l=h(d,"__defineGetter__"))&&(r=u.bind(d.__defineGetter__),o=u.bind(d.__defineSetter__),a=u.bind(d.__lookupGetter__),s=u.bind(d.__lookupSetter__)),2!=[1,2].splice(0).length){var m=Array.prototype.splice,g=Array.prototype.push,w=Array.prototype.unshift;Array.prototype.splice=function(){function e(e){for(var t=[];e--;)t.unshift(e);return t}var t,n=[];return n.splice.bind(n,0,0).apply(null,e(20)),n.splice.bind(n,0,0).apply(null,e(26)),t=n.length,n.splice(5,0,"XXX"),t+1==n.length?!0:void 0}()?function(e,t){return arguments.length?m.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(p.call(arguments,2))):[]}:function(e,t){var n,i=p.call(arguments,2),r=i.length;if(!arguments.length)return[];if(void 0===e&&(e=0),void 0===t&&(t=this.length-e),r>0){if(0>=t){if(e==this.length)return g.apply(this,i),[];if(0==e)return w.apply(this,i),[]}return n=p.call(this,e,e+t),i.push.apply(i,p.call(this,e+t,this.length)),i.unshift.apply(i,p.call(this,0,e)),i.unshift(0,this.length),m.apply(this,i),n}return m.call(this,e,t)}}if(1!=[].unshift(0)){var w=Array.prototype.unshift;Array.prototype.unshift=function(){return w.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(e){return"[object Array]"==f(e)});var v=Object("a"),y="a"!=v[0]||!(0 in v),b=!0;if(Array.prototype.forEach&&Array.prototype.forEach.call("foo",function(e,t,n){"object"!=typeof n&&(b=!1)}),Array.prototype.forEach&&b||(Array.prototype.forEach=function(e){var t=F(this),n=y&&"[object String]"==f(this)?this.split(""):t,i=arguments[1],r=-1,o=n.length>>>0;if("[object Function]"!=f(e))throw new TypeError;for(;++r<o;)r in n&&e.call(i,n[r],r,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=F(this),n=y&&"[object String]"==f(this)?this.split(""):t,i=n.length>>>0,r=Array(i),o=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var a=0;i>a;a++)a in n&&(r[a]=e.call(o,n[a],a,t));return r}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,n=F(this),i=y&&"[object String]"==f(this)?this.split(""):n,r=i.length>>>0,o=[],a=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var s=0;r>s;s++)s in i&&(t=i[s],e.call(a,t,s,n)&&o.push(t));return o}),Array.prototype.every||(Array.prototype.every=function(e){var t=F(this),n=y&&"[object String]"==f(this)?this.split(""):t,i=n.length>>>0,r=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var o=0;i>o;o++)if(o in n&&!e.call(r,n[o],o,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=F(this),n=y&&"[object String]"==f(this)?this.split(""):t,i=n.length>>>0,r=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var o=0;i>o;o++)if(o in n&&e.call(r,n[o],o,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=F(this),n=y&&"[object String]"==f(this)?this.split(""):t,i=n.length>>>0;if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");if(!i&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var r,o=0;if(arguments.length>=2)r=arguments[1];else for(;;){if(o in n){r=n[o++];break}if(++o>=i)throw new TypeError("reduce of empty array with no initial value")}for(;i>o;o++)o in n&&(r=e.call(void 0,r,n[o],o,t));return r}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=F(this),n=y&&"[object String]"==f(this)?this.split(""):t,i=n.length>>>0;if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");if(!i&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var r,o=i-1;if(arguments.length>=2)r=arguments[1];else for(;;){if(o in n){r=n[o--];break}if(--o<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>o)return r;do o in this&&(r=e.call(void 0,r,n[o],o,t));while(o--);return r}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var n=y&&"[object String]"==f(this)?this.split(""):F(this),i=n.length>>>0;if(!i)return-1;var r=0;for(arguments.length>1&&(r=t(arguments[1])),r=r>=0?r:Math.max(0,i+r);i>r;r++)if(r in n&&n[r]===e)return r;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var n=y&&"[object String]"==f(this)?this.split(""):F(this),i=n.length>>>0;if(!i)return-1;var r=i-1;for(arguments.length>1&&(r=Math.min(r,t(arguments[1]))),r=r>=0?r:i-Math.abs(r);r>=0;r--)if(r in n&&e===n[r])return r;return-1}),!Object.keys){var S=!0,O=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],k=O.length;for(var W in{toString:null})S=!1;Object.keys=function L(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var L=[];for(var t in e)h(e,t)&&L.push(t);if(S)for(var n=0,i=k;i>n;n++){var r=O[n];h(e,r)&&L.push(r)}return L}}var D=-621987552e5,_="-000001";Date.prototype.toISOString&&-1!==new Date(D).toISOString().indexOf(_)||(Date.prototype.toISOString=function(){var e,t,n,i,r;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(i=this.getUTCFullYear(),r=this.getUTCMonth(),i+=Math.floor(r/12),r=(r%12+12)%12,e=[r+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],i=(0>i?"-":i>9999?"+":"")+("00000"+Math.abs(i)).slice(i>=0&&9999>=i?-4:-6),t=e.length;t--;)n=e[t],10>n&&(e[t]="0"+n);return i+"-"+e.slice(0,2).join("-")+"T"+e.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"});var T=!1;try{T=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(D).toJSON().indexOf(_)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(E){}T||(Date.prototype.toJSON=function(){var e,t=Object(this),n=i(t);if("number"==typeof n&&!isFinite(n))return null;if(e=t.toISOString,"function"!=typeof e)throw new TypeError("toISOString property is not callable");return e.call(t)}),Date=function(e){function t(n,i,r,o,a,s,l){var u=arguments.length;if(this instanceof e){var c=1==u&&String(n)===n?new e(t.parse(n)):u>=7?new e(n,i,r,o,a,s,l):u>=6?new e(n,i,r,o,a,s):u>=5?new e(n,i,r,o,a):u>=4?new e(n,i,r,o):u>=3?new e(n,i,r):u>=2?new e(n,i):u>=1?new e(n):new e;return c.constructor=t,c}return e.apply(this,arguments)}function n(e,t){var n=t>1?1:0;return o[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}function i(t){return Number(new e(1970,0,1,0,0,0,t))}var r=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),o=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var a in e)t[a]=e[a];return t.now=e.now,t.UTC=e.UTC,t.prototype=e.prototype,t.prototype.constructor=t,t.parse=function(t){var o=r.exec(t);if(o){var a,s=Number(o[1]),l=Number(o[2]||1)-1,u=Number(o[3]||1)-1,c=Number(o[4]||0),d=Number(o[5]||0),p=Number(o[6]||0),f=Math.floor(1e3*Number(o[7]||0)),h=Boolean(o[4]&&!o[8]),m="-"===o[9]?1:-1,g=Number(o[10]||0),w=Number(o[11]||0);return(d>0||p>0||f>0?24:25)>c&&60>d&&60>p&&1e3>f&&l>-1&&12>l&&24>g&&60>w&&u>-1&&u<n(s,l+1)-n(s,l)&&(a=60*(24*(n(s,l)+u)+c+g*m),a=1e3*(60*(a+d+w*m)+p)+f,h&&(a=i(a)),a>=-864e13&&864e13>=a)?a:0/0}return e.parse.apply(this,arguments)},t}(Date),Date.now||(Date.now=function(){return(new Date).getTime()}),Number.prototype.toFixed&&"0.000"===8e-5.toFixed(3)&&"0"!==.9.toFixed(0)&&"1.25"===1.255.toFixed(2)&&"1000000000000000128"===0xde0b6b3a7640080.toFixed(0)||!function(){function e(e,t){for(var n=-1;++n<a;)t+=e*s[n],s[n]=t%o,t=Math.floor(t/o)}function t(e){for(var t=a,n=0;--t>=0;)n+=s[t],s[t]=Math.floor(n/e),n=n%e*o}function n(){for(var e=a,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var n=String(s[e]);""===t?t=n:t+="0000000".slice(0,7-n.length)+n}return t}function i(e,t,n){return 0===t?n:t%2===1?i(e,t-1,n*e):i(e*e,t/2,n)}function r(e){for(var t=0;e>=4096;)t+=12,e/=4096;for(;e>=2;)t+=1,e/=2;return t}var o,a,s;o=1e7,a=6,s=[0,0,0,0,0,0],Number.prototype.toFixed=function(o){var a,s,l,u,c,d,p,f;if(a=Number(o),a=a!==a?0:Math.floor(a),0>a||a>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(s=Number(this),s!==s)return"NaN";if(-1e21>=s||s>=1e21)return String(s);if(l="",0>s&&(l="-",s=-s),u="0",s>1e-21)if(c=r(s*i(2,69,1))-69,d=0>c?s*i(2,-c,1):s/i(2,c,1),d*=4503599627370496,c=52-c,c>0){for(e(0,d),p=a;p>=7;)e(1e7,0),p-=7;for(e(i(10,p,1),0),p=c-1;p>=23;)t(1<<23),p-=23;t(1<<p),e(1,1),t(2),u=n()}else e(0,d),e(1<<-c,0),u=n()+"0.00000000000000000000".slice(2,2+a);return a>0?(f=u.length,u=a>=f?l+"0.0000000000000000000".slice(0,a-f+2)+u:l+u.slice(0,f-a)+"."+u.slice(f-a)):u=l+u,u}}();var P=String.prototype.split;if(2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var e=void 0===/()??/.exec("")[1];String.prototype.split=function(t,n){var i=this;if(void 0===t&&0===n)return[];if("[object RegExp]"!==Object.prototype.toString.call(t))return P.apply(this,arguments);var r,o,a,s,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),c=0,t=new RegExp(t.source,u+"g");for(i+="",e||(r=new RegExp("^"+t.source+"$(?!\\s)",u)),n=void 0===n?-1>>>0:n>>>0;(o=t.exec(i))&&(a=o.index+o[0].length,!(a>c&&(l.push(i.slice(c,o.index)),!e&&o.length>1&&o[0].replace(r,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(o[e]=void 0)}),o.length>1&&o.index<i.length&&Array.prototype.push.apply(l,o.slice(1)),s=o[0].length,c=a,l.length>=n)));)t.lastIndex===o.index&&t.lastIndex++;return c===i.length?(s||!t.test(""))&&l.push(""):l.push(i.slice(c)),l.length>n?l.slice(0,n):l}}():"0".split(void 0,0).length&&(String.prototype.split=function(e,t){return void 0===e&&0===t?[]:P.apply(this,arguments)}),"".substr&&"b"!=="0b".substr(-1)){var M=String.prototype.substr;String.prototype.substr=function(e,t){return M.call(this,0>e?(e=this.length+e)<0?0:e:e,t)}}var x="	\n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||x.trim()){x="["+x+"]";var C=new RegExp("^"+x+x+"*"),I=new RegExp(x+x+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(C,"").replace(I,"")}}var F=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),function(e){"function"==typeof define?define("es5-sham",e):"function"==typeof YUI?YUI.add("es5-sham",e):e()}(function(){function e(e){try{return e.sentinel=0,0===Object.getOwnPropertyDescriptor(e,"sentinel").value}catch(t){}}function t(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}var n,i,r,o,a,s=Function.prototype.call,l=Object.prototype,u=s.bind(l.hasOwnProperty);if((a=u(l,"__defineGetter__"))&&(n=s.bind(l.__defineGetter__),i=s.bind(l.__defineSetter__),r=s.bind(l.__lookupGetter__),o=s.bind(l.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:l)}),Object.defineProperty){var c=e({}),d="undefined"==typeof document||e(document.createElement("div"));if(!d||!c)var p=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||p){var f="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(f+e);if(p)try{return p.call(Object,e,t)}catch(n){}if(u(e,t)){var i={enumerable:!0,configurable:!0};if(a){var s=e.__proto__;e.__proto__=l;var c=r(e,t),d=o(e,t);if(e.__proto__=s,c||d)return c&&(i.get=c),d&&(i.set=d),i}return i.value=e[t],i.writable=!0,i}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var h,m=null===Object.prototype.__proto__;h=m||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function e(){}var t=document.createElement("iframe"),n=document.body||document.documentElement;t.style.display="none",n.appendChild(t),t.src="javascript:";var i=t.contentWindow.Object.prototype;return n.removeChild(t),t=null,delete i.constructor,delete i.hasOwnProperty,delete i.propertyIsEnumerable,delete i.isPrototypeOf,delete i.toLocaleString,delete i.toString,delete i.valueOf,i.__proto__=null,e.prototype=i,h=function(){return new e},new e},Object.create=function(e,t){function n(){}var i;if(null===e)i=h();else{if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null");n.prototype=e,i=new n,i.__proto__=e}return void 0!==t&&Object.defineProperties(i,t),i}}if(Object.defineProperty){var g=t({}),w="undefined"==typeof document||t(document.createElement("div"));if(!g||!w)var v=Object.defineProperty,y=Object.defineProperties}if(!Object.defineProperty||v){var b="Property description must be an object: ",S="Object.defineProperty called on non-object: ",O="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(e,t,s){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(S+e);if("object"!=typeof s&&"function"!=typeof s||null===s)throw new TypeError(b+s);if(v)try{return v.call(Object,e,t,s)}catch(c){}if(u(s,"value"))if(a&&(r(e,t)||o(e,t))){var d=e.__proto__;e.__proto__=l,delete e[t],e[t]=s.value,e.__proto__=d}else e[t]=s.value;else{if(!a)throw new TypeError(O);u(s,"get")&&n(e,t,s.get),u(s,"set")&&i(e,t,s.set)}return e}}(!Object.defineProperties||y)&&(Object.defineProperties=function(e,t){if(y)try{return y.call(Object,e,t)}catch(n){}for(var i in t)u(t,i)&&"__proto__"!=i&&Object.defineProperty(e,i,t[i]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(k){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)!==e)throw new TypeError;for(var t="";u(e,t);)t+="?";e[t]=!0;var n=u(e,t);return delete e[t],n})}),function(){var bind=function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){var i=n.concat(Array.prototype.slice.call(arguments,0));e.apply(t,i)}};window.console||(window.console={});var console=window.console;if(!console.log)if(window.log4javascript){var log=log4javascript.getDefaultLogger();console.log=bind(log.info,log),console.debug=bind(log.debug,log),console.info=bind(log.info,log),console.warn=bind(log.warn,log),console.error=bind(log.error,log)}else console.log=function(){};if(console.debug||(console.debug=console.log),console.info||(console.info=console.log),console.warn||(console.warn=console.log),console.error||(console.error=console.log),null!=window.__consoleShimTest__||eval("/*@cc_on @_jscript_version <= 9@*/")){var wrap=function(e){var t,n,i,r;if(e=Array.prototype.slice.call(arguments,0),r=e.shift(),n=e.length,n>1&&window.__consoleShimTest__!==!1)for("string"!=typeof e[0]&&(e.unshift("%o"),n+=1),i=e[0].match(/%[a-z]/g),t=i?i.length+1:1;n>t;t+=1)e[0]+=" %o";Function.apply.call(r,console,e)};console.log=bind(wrap,window,console.log),console.debug=bind(wrap,window,console.debug),console.info=bind(wrap,window,console.info),console.warn=bind(wrap,window,console.warn),console.error=bind(wrap,window,console.error)}if(console.assert||(console.assert=function(){var e=Array.prototype.slice.call(arguments,0),t=e.shift();t||(e[0]="Assertion failed: "+e[0],console.error.apply(console,e))}),console.dir||(console.dir=console.log),console.dirxml||(console.dirxml=console.log),console.exception||(console.exception=console.error),!console.time||!console.timeEnd){var timers={};console.time=function(e){timers[e]=(new Date).getTime()},console.timeEnd=function(e){var t=timers[e];t&&(console.log(e+": "+((new Date).getTime()-t)+"ms"),delete timers[e])}}console.table||(console.table=function(e,t){var n,i,r,o,a,s;if(e&&e instanceof Array&&e.length){if(!(t&&t instanceof Array)){t=[];for(s in e[0])e[0].hasOwnProperty(s)&&t.push(s)}for(n=0,i=e.length;i>n;n+=1){for(r=[],o=0,a=t.length;a>o;o+=1)r.push(e[n][t[o]]);Function.apply.call(console.log,console,r)}}}),console.clear||(console.clear=function(){}),console.trace||(console.trace=function(){}),console.group||(console.group=function(){}),console.groupCollapsed||(console.groupCollapsed=function(){}),console.groupEnd||(console.groupEnd=function(){}),console.timeStamp||(console.timeStamp=function(){}),console.profile||(console.profile=function(){}),console.profileEnd||(console.profileEnd=function(){}),console.count||(console.count=function(){})}(),define("console-shim",function(){}),function(e){define("bootstrap/transition",["jquery"],function(){return function(){+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one(e.support.transition.end,function(){n=!0});var r=function(){n||e(i).trigger(e.support.transition.end)};return setTimeout(r,t),this},e(function(){e.support.transition=t()})}(jQuery)}.apply(e,arguments)})}(this),function(e){define("bootstrap/modal",["jquery","bootstrap/transition"],function(){return function(){+function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show().scrollTop(0),i&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var r=e.Event("shown.bs.modal",{relatedTarget:t});i?n.$element.find(".modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(r)}).emulateTransitionEnd(300):n.$element.focus().trigger(r)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,i){return this.each(function(){var r=e(this),o=r.data("bs.modal"),a=e.extend({},t.DEFAULTS,r.data(),"object"==typeof n&&n);o||r.data("bs.modal",o=new t(this,a)),"string"==typeof n?o[n](i):a.show&&o.show(i)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),i=n.attr("href"),r=e(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},r.data(),n.data());n.is("a")&&t.preventDefault(),r.modal(o,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(jQuery)}.apply(e,arguments)})}(this),function(e){define("bootstrap/dropdown",["jquery","bootstrap/transition"],function(){return function(){+function(e){function t(t){e(i).remove(),e(r).each(function(){var i=n(e(this)),r={relatedTarget:this};i.hasClass("open")&&(i.trigger(t=e.Event("hide.bs.dropdown",r)),t.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",r))})}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}var i=".dropdown-backdrop",r="[data-toggle=dropdown]",o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.prototype.toggle=function(i){var r=e(this);if(!r.is(".disabled, :disabled")){var o=n(r),a=o.hasClass("open");if(t(),!a){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var s={relatedTarget:this};if(o.trigger(i=e.Event("show.bs.dropdown",s)),i.isDefaultPrevented())return;o.toggleClass("open").trigger("shown.bs.dropdown",s),r.focus()}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var i=e(this);if(t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled")){var o=n(i),a=o.hasClass("open");if(!a||a&&27==t.keyCode)return 27==t.which&&o.find(r).focus(),i.click();var s=" li:not(.divider):visible a",l=o.find("[role=menu]"+s+", [role=listbox]"+s);if(l.length){var u=l.index(l.filter(":focus"));38==t.keyCode&&u>0&&u--,40==t.keyCode&&u<l.length-1&&u++,~u||(u=0),l.eq(u).focus()}}}};var a=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new o(this)),"string"==typeof t&&i[t].call(n)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=a,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r+", [role=menu], [role=listbox]",o.prototype.keydown)}(jQuery)}.apply(e,arguments)})}(this),function(e,t){"function"==typeof define&&define.amd?define("jquery.panzoom",["jquery"],t):t("object"==typeof exports?require("jquery"):e.jQuery)}(this,function(e){function t(e,t){for(var n=e.length;--n;)if(+e[n]!==+t[n])return!1;return!0}function n(t){var n={range:!0,animate:!0};return"boolean"==typeof t?n.animate=t:e.extend(n,t),n}function i(t,n,i,r,o,a,s,l,u){this.elements="array"===e.type(t)?[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]:[t,n,i,r,o,a,s||0,l||0,u||1]}function r(e,t,n){this.elements=[e,t,n]}function o(t,n){if(!(this instanceof o))return new o(t,n);1!==t.nodeType&&e.error("Panzoom called on non-Element node"),e.contains(document,t)||e.error("Panzoom element must be attached to the document");var i=e.data(t,c);if(i)return i;this.options=n=e.extend({},o.defaults,n),this.elem=t;var r=this.$elem=e(t);this.$set=n.$set&&n.$set.length?n.$set:r,this.$doc=e(t.ownerDocument||document),this.$parent=r.parent(),this.isSVG=h.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase(),this.panning=!1,this._buildTransform(),this.isSVG||(this._transform=e.cssProps.transform.replace(f,"-$1").toLowerCase()),this._buildTransition(),this.resetDimensions();var a=e(),s=this;e.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(e,t){s[t]=n[t]||a}),this.enable(),e.data(t,c,this)}var a="over out down up move enter leave cancel".split(" "),s=e.extend({},e.event.mouseHooks),l={};if(window.PointerEvent)e.each(a,function(t,n){e.event.fixHooks[l[n]="pointer"+n]=s});else{var u=s.props;s.props=u.concat(["touches","changedTouches","targetTouches","altKey","ctrlKey","metaKey","shiftKey"]),s.filter=function(e,t){var n,i=u.length;if(!t.pageX&&t.touches&&(n=t.touches[0]))for(;i--;)e[u[i]]=n[u[i]];return e},e.each(a,function(t,n){if(2>t)l[n]="mouse"+n;else{var i="touch"+("down"===n?"start":"up"===n?"end":n);e.event.fixHooks[i]=s,l[n]=i+" mouse"+n}})}e.pointertouch=l;var c="__pz__",d=Array.prototype.slice,p=!!window.PointerEvent,f=/([A-Z])/g,h=/^http:[\w\.\/]+svg$/,m=/^inline/,g="(\\-?[\\d\\.e]+)",w="\\,?\\s*",v=new RegExp("^matrix\\("+g+w+g+w+g+w+g+w+g+w+g+"\\)$");return i.prototype={x:function(e){var t=e instanceof r,n=this.elements,o=e.elements;return t&&3===o.length?new r(n[0]*o[0]+n[1]*o[1]+n[2]*o[2],n[3]*o[0]+n[4]*o[1]+n[5]*o[2],n[6]*o[0]+n[7]*o[1]+n[8]*o[2]):o.length===n.length?new i(n[0]*o[0]+n[1]*o[3]+n[2]*o[6],n[0]*o[1]+n[1]*o[4]+n[2]*o[7],n[0]*o[2]+n[1]*o[5]+n[2]*o[8],n[3]*o[0]+n[4]*o[3]+n[5]*o[6],n[3]*o[1]+n[4]*o[4]+n[5]*o[7],n[3]*o[2]+n[4]*o[5]+n[5]*o[8],n[6]*o[0]+n[7]*o[3]+n[8]*o[6],n[6]*o[1]+n[7]*o[4]+n[8]*o[7],n[6]*o[2]+n[7]*o[5]+n[8]*o[8]):!1},inverse:function(){var e=1/this.determinant(),t=this.elements;return new i(e*(t[8]*t[4]-t[7]*t[5]),e*-(t[8]*t[1]-t[7]*t[2]),e*(t[5]*t[1]-t[4]*t[2]),e*-(t[8]*t[3]-t[6]*t[5]),e*(t[8]*t[0]-t[6]*t[2]),e*-(t[5]*t[0]-t[3]*t[2]),e*(t[7]*t[3]-t[6]*t[4]),e*-(t[7]*t[0]-t[6]*t[1]),e*(t[4]*t[0]-t[3]*t[1]))},determinant:function(){var e=this.elements;return e[0]*(e[8]*e[4]-e[7]*e[5])-e[3]*(e[8]*e[1]-e[7]*e[2])+e[6]*(e[5]*e[1]-e[4]*e[2])}},r.prototype.e=i.prototype.e=function(e){return this.elements[e]},o.rmatrix=v,o.events=e.pointertouch,o.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,increment:.3,minScale:.4,maxScale:5,rangeStep:.05,duration:200,easing:"ease-in-out",contain:!1},o.prototype={constructor:o,instance:function(){return this},enable:function(){this._initStyle(),this._bind(),this.disabled=!1},disable:function(){this.disabled=!0,this._resetStyle(),this._unbind()},isDisabled:function(){return this.disabled},destroy:function(){this.disable(),e.removeData(this.elem,c)},resetDimensions:function(){var t=this.$parent;this.container={width:t.width(),height:t.height()};var n=this.elem,i=this.$elem,r=this.dimensions=this.isSVG?{left:n.getAttribute("x")||0,top:n.getAttribute("y")||0,width:n.getAttribute("width")||i.outerWidth(),height:n.getAttribute("height")||i.outerHeight(),margin:{left:0,top:0}}:{left:e.css(n,"left",!0)||0,top:e.css(n,"top",!0)||0,width:i.outerWidth(),height:i.outerHeight(),margin:{top:e.css(n,"marginTop",!0)||0,left:e.css(n,"marginLeft",!0)||0}};r.widthBorder=e.css(n,"borderLeftWidth",!0)+e.css(n,"borderRightWidth",!0)||0,r.heightBorder=e.css(n,"borderTopWidth",!0)+e.css(n,"borderBottomWidth",!0)||0},reset:function(e){e=n(e);var t=this.setMatrix(this._origTransform,e);e.silent||this._trigger("reset",t)},resetZoom:function(e){e=n(e);var t=this.getMatrix(this._origTransform);e.dValue=t[3],this.zoom(t[0],e)},resetPan:function(e){var t=this.getMatrix(this._origTransform);this.pan(t[4],t[5],n(e))},setTransform:function(t){for(var n=this.isSVG?"attr":"style",i=this.$set,r=i.length;r--;)e[n](i[r],"transform",t)},getTransform:function(t){var n=this.$set[0];return t?this.setTransform(t):t=e[this.isSVG?"attr":"style"](n,"transform"),"none"===t||v.test(t)||this.isSVG||this.setTransform(t=e.css(n,"transform")),t||"none"},getMatrix:function(e){var t=v.exec(e||this.getTransform());return t&&t.shift(),t||[1,0,0,1,0,0]},setMatrix:function(t,n){if(!this.disabled){n||(n={}),"string"==typeof t&&(t=this.getMatrix(t));var i,r,o,a,s,l,u,c,d=+t[0],p=this.$parent,f="undefined"!=typeof n.contain?n.contain:this.options.contain;return f&&(i=this._checkDims(),r=this.container,o=(i.width*d-r.width)/2,a=(i.height*d-r.height)/2,"invert"===f?(s=i.width>r.width?i.width-r.width:0,l=i.height>r.height?i.height-r.height:0,o+=(r.width-i.width)/2,a+=(r.height-i.height)/2,u=i.left+i.margin.left,c=i.top+i.margin.top,t[4]=Math.max(Math.min(t[4],o-u),-o-u-s),t[5]=Math.max(Math.min(t[5],a-c),-a-c-l+i.heightBorder)):(l=r.height>i.height?r.height-i.height:0,"center"===p.css("textAlign")&&m.test(e.css(this.elem,"display"))?s=0:(s=r.width>i.width?r.width-i.width:0,o=a=0),t[4]=Math.min(Math.max(t[4],o-i.left),-o-i.left+s),t[5]=Math.min(Math.max(t[5],a-i.top),-a-i.top+l))),"skip"!==n.animate&&this.transition(!n.animate),n.range&&this.$zoomRange.val(d),this.setTransform("matrix("+t.join(",")+")"),n.silent||this._trigger("change",t),t
}},isPanning:function(){return this.panning},transition:function(t){for(var n=t||!this.options.transition?"none":this._transition,i=this.$set,r=i.length;r--;)e.style(i[r],"transition")!==n&&e.style(i[r],"transition",n)},pan:function(e,t,n){if(!this.options.disablePan){n||(n={});var i=n.matrix;i||(i=this.getMatrix()),n.relative&&(e+=+i[4],t+=+i[5]),i[4]=e,i[5]=t,this.setMatrix(i,n),n.silent||this._trigger("pan",i[4],i[5])}},zoom:function(t,n){"object"==typeof t?(n=t,t=null):n||(n={});var o=e.extend({},this.options,n);if(!o.disableZoom){var a=!1,s=o.matrix||this.getMatrix();"number"!=typeof t&&(t=+s[0]+o.increment*(t?-1:1),a=!0),t>o.maxScale?t=o.maxScale:t<o.minScale&&(t=o.minScale);var l=o.focal;if(l&&!o.disablePan){a=!1;var u=this._checkDims(),c=l.clientX-u.width/2,d=l.clientY-u.height/2,p=new r(c,d,1),f=new i(s),h=this.$parent.offset(),m=new i(1,0,h.left-this.$doc.scrollLeft(),0,1,h.top-this.$doc.scrollTop()),g=f.inverse().x(m.inverse().x(p)),w=t/s[0];f=f.x(new i([w,0,0,w,0,0])),p=m.x(f.x(g)),s[4]=+s[4]+(c-p.e(0)),s[5]=+s[5]+(d-p.e(1))}s[0]=t,s[3]="number"==typeof o.dValue?o.dValue:t,this.setMatrix(s,{animate:"boolean"==typeof o.animate?o.animate:a,range:!o.noSetRange}),o.silent||this._trigger("zoom",s[0],o)}},option:function(t,n){var i;if(!t)return e.extend({},this.options);if("string"==typeof t){if(1===arguments.length)return void 0!==this.options[t]?this.options[t]:null;i={},i[t]=n}else i=t;this._setOptions(i)},_setOptions:function(t){e.each(t,e.proxy(function(t,n){switch(t){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind()}switch(this.options[t]=n,t){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[t]=n;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();break;case"cursor":e.style(this.elem,"cursor",n);break;case"minScale":this.$zoomRange.attr("min",n);break;case"maxScale":this.$zoomRange.attr("max",n);break;case"rangeStep":this.$zoomRange.attr("step",n);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();case"transition":this.transition();break;case"$set":n instanceof e&&n.length&&(this.$set=n)}},this))},_initStyle:function(){this.options.disablePan||this.$elem.css("cursor",this.options.cursor);var t=this.$parent;if(t.length&&!e.nodeName(t[0],"body")){var n={overflow:"hidden"};"static"===t.css("position")&&(n.position="relative"),t.css(n)}},_resetStyle:function(){this.$elem.css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this,n=this.options,i=n.eventNamespace,r=p?"pointerdown"+i:"touchstart"+i+" mousedown"+i,a=p?"pointerup"+i:"touchend"+i+" click"+i,s={},l=this.$reset,u=this.$zoomRange;if(e.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=n["on"+this];e.isFunction(t)&&(s["panzoom"+this.toLowerCase()+i]=t)}),n.disablePan&&n.disableZoom||(s[r]=function(e){var i;("touchstart"===e.type?!(i=e.touches)||(1!==i.length||n.disablePan)&&2!==i.length:n.disablePan||1!==e.which)||(e.preventDefault(),e.stopPropagation(),t._startMove(e,i))}),this.$elem.on(s),l.length&&l.on(a,function(e){e.preventDefault(),t.reset()}),u.length&&u.attr({step:n.rangeStep===o.defaults.rangeStep&&u.attr("step")||n.rangeStep,min:n.minScale,max:n.maxScale}).prop({value:this.getMatrix()[0]}),!n.disableZoom){var c=this.$zoomIn,d=this.$zoomOut;c.length&&d.length&&(c.on(a,function(e){e.preventDefault(),t.zoom()}),d.on(a,function(e){e.preventDefault(),t.zoom(!0)})),u.length&&(s={},s[(p?"pointerdown":"mousedown")+i]=function(){t.transition(!0)},s["change"+i]=function(){t.zoom(+this.value,{noSetRange:!0})},u.on(s))}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){var e=this.options;this._transform&&(this._transition=this._transform+" "+e.duration+"ms "+e.easing)},_checkDims:function(){var e=this.dimensions;return(e.width===e.widthBorder||e.height===e.heightBorder)&&this.resetDimensions(),this.dimensions},_getDistance:function(e){var t=e[0],n=e[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-t.clientX),2)+Math.pow(Math.abs(n.clientY-t.clientY),2))},_getMiddle:function(e){var t=e[0],n=e[1];return{clientX:(n.clientX-t.clientX)/2+t.clientX,clientY:(n.clientY-t.clientY)/2+t.clientY}},_trigger:function(e){"string"==typeof e&&(e="panzoom"+e),this.$elem.triggerHandler(e,[this].concat(d.call(arguments,1)))},_startMove:function(n,i){var r,o,a,s,l,u,c,d,f=this,h=this.options,m=h.eventNamespace,g=this.getMatrix(),w=g.slice(0),v=+w[4],y=+w[5],b={matrix:g,animate:"skip"};p?(o="pointermove",a="pointerup"):"touchstart"===n.type?(o="touchmove",a="touchend"):(o="mousemove",a="mouseup"),o+=m,a+=m,this.transition(!0),this.panning=!0,this._trigger("start",n,i),i&&2===i.length?(s=this._getDistance(i),l=+g[0],u=this._getMiddle(i),r=function(e){e.preventDefault();var t=f._getMiddle(i=e.touches),n=f._getDistance(i)-s;f.zoom(n*(h.increment/100)+l,{focal:t,matrix:g}),f.pan(+g[4]+t.clientX-u.clientX,+g[5]+t.clientY-u.clientY,b),u=t}):(c=n.pageX,d=n.pageY,r=function(e){e.preventDefault(),f.pan(v+e.pageX-c,y+e.pageY-d,b)}),e(document).off(m).on(o,r).on(a,function(n){n.preventDefault(),e(this).off(m),f.panning=!1,n.type="panzoomend",f._trigger(n,g,!t(g,w))})}},e.Panzoom=o,e.fn.panzoom=function(t){var n,i,r,a;return"string"==typeof t?(a=[],i=d.call(arguments,1),this.each(function(){n=e.data(this,c),n?"_"!==t.charAt(0)&&"function"==typeof(r=n[t])&&void 0!==(r=r.apply(n,i))&&a.push(r):a.push(void 0)}),a.length?1===a.length?a[0]:a:this):this.each(function(){new o(this,t)})},o}),function(){!function(e){var t=this||(0,eval)("this"),n=t.document,i=t.navigator,r=t.jQuery,o=t.JSON;!function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(module.exports||exports):"function"==typeof define&&define.amd?define("knockout",["exports"],e):e(t.ko={})}(function(a){function s(e,t){return null===e||typeof e in c?e===t:!1}function l(e,t,n,i){u.d[e]={init:function(e){return u.a.f.set(e,m,{}),{controlsDescendantBindings:!0}},update:function(e,r,o,a,s){o=u.a.f.get(e,m),r=u.a.c(r()),a=!n!=!r;var l=!o.ob;(l||t||a!==o.Db)&&(l&&(o.ob=u.a.Ya(u.e.childNodes(e),!0)),a?(l||u.e.S(e,u.a.Ya(o.ob)),u.Ta(i?i(s,r):s,e)):u.e.Z(e),o.Db=a)}},u.g.Y[e]=!1,u.e.P[e]=!0}var u="undefined"!=typeof a?a:{};u.b=function(e,t){for(var n=e.split("."),i=u,r=0;r<n.length-1;r++)i=i[n[r]];i[n[n.length-1]]=t},u.s=function(e,t,n){e[t]=n},u.version="3.0.0",u.b("version",u.version),u.a=function(){function a(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function s(e,t){if("input"!==u.a.v(e)||!e.type||"click"!=t.toLowerCase())return!1;var n=e.type;return"checkbox"==n||"radio"==n}var l={},c={};l[i&&/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],l.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),a(l,function(e,t){if(t.length)for(var n=0,i=t.length;i>n;n++)c[t[n]]=e});var d={propertychange:!0},p=n&&function(){for(var t=3,i=n.createElement("div"),r=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",r[0];);return t>4?t:e}();return{$a:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],n:function(e,t){for(var n=0,i=e.length;i>n;n++)t(e[n])},l:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},Ua:function(e,t,n){for(var i=0,r=e.length;r>i;i++)if(t.call(n,e[i]))return e[i];return null},ia:function(e,t){var n=u.a.l(e,t);n>=0&&e.splice(n,1)},Va:function(e){e=e||[];for(var t=[],n=0,i=e.length;i>n;n++)0>u.a.l(t,e[n])&&t.push(e[n]);return t},ha:function(e,t){e=e||[];for(var n=[],i=0,r=e.length;r>i;i++)n.push(t(e[i]));return n},ga:function(e,t){e=e||[];for(var n=[],i=0,r=e.length;r>i;i++)t(e[i])&&n.push(e[i]);return n},X:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,i=t.length;i>n;n++)e.push(t[n]);return e},V:function(e,t,n){var i=u.a.l(u.a.Ha(e),t);0>i?n&&e.push(t):n||e.splice(i,1)},extend:function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},K:a,Da:function(e,t){if(!e)return e;var n,i={};for(n in e)e.hasOwnProperty(n)&&(i[n]=t(e[n],n,e));return i},wa:function(e){for(;e.firstChild;)u.removeNode(e.firstChild)},Vb:function(e){e=u.a.Q(e);for(var t=n.createElement("div"),i=0,r=e.length;r>i;i++)t.appendChild(u.L(e[i]));return t},Ya:function(e,t){for(var n=0,i=e.length,r=[];i>n;n++){var o=e[n].cloneNode(!0);r.push(t?u.L(o):o)}return r},S:function(e,t){if(u.a.wa(e),t)for(var n=0,i=t.length;i>n;n++)e.appendChild(t[n])},nb:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var i=n[0],r=i.parentNode,o=0,a=t.length;a>o;o++)r.insertBefore(t[o],i);for(o=0,a=n.length;a>o;o++)u.removeNode(n[o])}},$:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);if(1<e.length){var n=e[0],i=e[e.length-1];for(e.length=0;n!==i;)if(e.push(n),n=n.nextSibling,!n)return;e.push(i)}}return e},qb:function(e,t){7>p?e.setAttribute("selected",t):e.selected=t},la:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},ec:function(e,t){for(var n=[],i=(e||"").split(t),r=0,o=i.length;o>r;r++){var a=u.a.la(i[r]);""!==a&&n.push(a)}return n},ac:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},Gb:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},va:function(e){return u.a.Gb(e,e.ownerDocument.documentElement)},Ra:function(e){return!!u.a.Ua(e,u.a.va)},v:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},r:function(e,t,n){var i=p&&d[t];if(i||"undefined"==typeof r)if(i||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var o=function(t){n.call(e,t)},a="on"+t;e.attachEvent(a,o),u.a.C.ea(e,function(){e.detachEvent(a,o)})}else e.addEventListener(t,n,!1);else{if(s(e,t)){var l=n;n=function(e,t){var n=this.checked;t&&(this.checked=!0!==t.Ab),l.call(this,e),this.checked=n}}r(e).bind(t,n)}},da:function(e,i){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");if("undefined"!=typeof r){var o=[];s(e,i)&&o.push({Ab:e.checked}),r(e).trigger(i,o)}else if("function"==typeof n.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");o=n.createEvent(c[i]||"HTMLEvents"),o.initEvent(i,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(o)}else{if("undefined"==typeof e.fireEvent)throw Error("Browser doesn't support triggering events");s(e,i)&&(e.checked=!0!==e.checked),e.fireEvent("on"+i)}},c:function(e){return u.M(e)?e():e},Ha:function(e){return u.M(e)?e.t():e},ma:function(e,t,n){if(t){var i=/\S+/g,r=e.className.match(i)||[];u.a.n(t.match(i),function(e){u.a.V(r,e,n)}),e.className=r.join(" ")}},Ma:function(t,i){var r=u.a.c(i);(null===r||r===e)&&(r="");var o=u.e.firstChild(t);!o||3!=o.nodeType||u.e.nextSibling(o)?u.e.S(t,[n.createTextNode(r)]):o.data=r,u.a.Jb(t)},pb:function(e,t){if(e.name=t,7>=p)try{e.mergeAttributes(n.createElement("<input name='"+e.name+"'/>"),!1)}catch(i){}},Jb:function(e){p>=9&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},Hb:function(e){if(p){var t=e.style.width;e.style.width=0,e.style.width=t}},Zb:function(e,t){e=u.a.c(e),t=u.a.c(t);for(var n=[],i=e;t>=i;i++)n.push(i);return n},Q:function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},cc:6===p,dc:7===p,ja:p,ab:function(e,t){for(var n=u.a.Q(e.getElementsByTagName("input")).concat(u.a.Q(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},r=[],o=n.length-1;o>=0;o--)i(n[o])&&r.push(n[o]);return r},Wb:function(e){return"string"==typeof e&&(e=u.a.la(e))?o&&o.parse?o.parse(e):new Function("return "+e)():null},Na:function(e,t,n){if(!o||!o.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return o.stringify(u.a.c(e),t,n)},Xb:function(e,t,i){i=i||{};var r=i.params||{},o=i.includeFields||this.$a,s=e;if("object"==typeof e&&"form"===u.a.v(e))for(var s=e.action,l=o.length-1;l>=0;l--)for(var c=u.a.ab(e,o[l]),d=c.length-1;d>=0;d--)r[c[d].name]=c[d].value;t=u.a.c(t);var p=n.createElement("form");p.style.display="none",p.action=s,p.method="post";for(var f in t)e=n.createElement("input"),e.name=f,e.value=u.a.Na(u.a.c(t[f])),p.appendChild(e);a(r,function(e,t){var i=n.createElement("input");i.name=e,i.value=t,p.appendChild(i)}),n.body.appendChild(p),i.submitter?i.submitter(p):p.submit(),setTimeout(function(){p.parentNode.removeChild(p)},0)}}}(),u.b("utils",u.a),u.b("utils.arrayForEach",u.a.n),u.b("utils.arrayFirst",u.a.Ua),u.b("utils.arrayFilter",u.a.ga),u.b("utils.arrayGetDistinctValues",u.a.Va),u.b("utils.arrayIndexOf",u.a.l),u.b("utils.arrayMap",u.a.ha),u.b("utils.arrayPushAll",u.a.X),u.b("utils.arrayRemoveItem",u.a.ia),u.b("utils.extend",u.a.extend),u.b("utils.fieldsIncludedWithJsonPost",u.a.$a),u.b("utils.getFormFields",u.a.ab),u.b("utils.peekObservable",u.a.Ha),u.b("utils.postJson",u.a.Xb),u.b("utils.parseJson",u.a.Wb),u.b("utils.registerEventHandler",u.a.r),u.b("utils.stringifyJson",u.a.Na),u.b("utils.range",u.a.Zb),u.b("utils.toggleDomNodeCssClass",u.a.ma),u.b("utils.triggerEvent",u.a.da),u.b("utils.unwrapObservable",u.a.c),u.b("utils.objectForEach",u.a.K),u.b("utils.addOrRemoveItem",u.a.V),u.b("unwrap",u.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments);return e=n.shift(),function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),u.a.f=new function(){function t(t,o){var a=t[i];if(!a||"null"===a||!r[a]){if(!o)return e;a=t[i]="ko"+n++,r[a]={}}return r[a]}var n=0,i="__ko__"+(new Date).getTime(),r={};return{get:function(n,i){var r=t(n,!1);return r===e?e:r[i]},set:function(n,i,r){(r!==e||t(n,!1)!==e)&&(t(n,!0)[i]=r)},clear:function(e){var t=e[i];return t?(delete r[t],e[i]=null,!0):!1},D:function(){return n++ +i}}},u.b("utils.domData",u.a.f),u.b("utils.domData.clear",u.a.f.clear),u.a.C=new function(){function t(t,n){var r=u.a.f.get(t,i);return r===e&&n&&(r=[],u.a.f.set(t,i,r)),r}function n(e){var i=t(e,!1);if(i)for(var i=i.slice(0),o=0;o<i.length;o++)i[o](e);if(u.a.f.clear(e),"function"==typeof r&&"function"==typeof r.cleanData&&r.cleanData([e]),a[e.nodeType])for(i=e.firstChild;e=i;)i=e.nextSibling,8===e.nodeType&&n(e)}var i=u.a.f.D(),o={1:!0,8:!0,9:!0},a={1:!0,9:!0};return{ea:function(e,n){if("function"!=typeof n)throw Error("Callback must be a function");t(e,!0).push(n)},mb:function(n,r){var o=t(n,!1);o&&(u.a.ia(o,r),0==o.length&&u.a.f.set(n,i,e))},L:function(e){if(o[e.nodeType]&&(n(e),a[e.nodeType])){var t=[];u.a.X(t,e.getElementsByTagName("*"));for(var i=0,r=t.length;r>i;i++)n(t[i])}return e},removeNode:function(e){u.L(e),e.parentNode&&e.parentNode.removeChild(e)}}},u.L=u.a.C.L,u.removeNode=u.a.C.removeNode,u.b("cleanNode",u.L),u.b("removeNode",u.removeNode),u.b("utils.domNodeDisposal",u.a.C),u.b("utils.domNodeDisposal.addDisposeCallback",u.a.C.ea),u.b("utils.domNodeDisposal.removeDisposeCallback",u.a.C.mb),function(){u.a.Fa=function(e){var i;if("undefined"!=typeof r){if(r.parseHTML)i=r.parseHTML(e)||[];else if((i=r.clean([e]))&&i[0]){for(e=i[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var o=u.a.la(e).toLowerCase();for(i=n.createElement("div"),o=o.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!o.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!o.indexOf("<td")||!o.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],e="ignored<div>"+o[1]+e+o[2]+"</div>","function"==typeof t.innerShiv?i.appendChild(t.innerShiv(e)):i.innerHTML=e;o[0]--;)i=i.lastChild;i=u.a.Q(i.lastChild.childNodes)}return i},u.a.Ka=function(t,n){if(u.a.wa(t),n=u.a.c(n),null!==n&&n!==e)if("string"!=typeof n&&(n=n.toString()),"undefined"!=typeof r)r(t).html(n);else for(var i=u.a.Fa(n),o=0;o<i.length;o++)t.appendChild(i[o])}}(),u.b("utils.parseHtmlFragment",u.a.Fa),u.b("utils.setHtml",u.a.Ka),u.u=function(){function t(e,n){if(e)if(8==e.nodeType){var i=u.u.jb(e.nodeValue);null!=i&&n.push({Fb:e,Tb:i})}else if(1==e.nodeType)for(var i=0,r=e.childNodes,o=r.length;o>i;i++)t(r[i],n)}var n={};return{Ca:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return n[t]=e,"<!--[ko_memo:"+t+"]-->"},ub:function(t,i){var r=n[t];if(r===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return r.apply(null,i||[]),!0}finally{delete n[t]}},vb:function(e,n){var i=[];t(e,i);for(var r=0,o=i.length;o>r;r++){var a=i[r].Fb,s=[a];n&&u.a.X(s,n),u.u.ub(i[r].Tb,s),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},jb:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),u.b("memoization",u.u),u.b("memoization.memoize",u.u.Ca),u.b("memoization.unmemoize",u.u.ub),u.b("memoization.parseMemoText",u.u.jb),u.b("memoization.unmemoizeDomNodeAndDescendants",u.u.vb),u.xa={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return u.h({read:e,write:function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}})},notify:function(e,t){e.equalityComparer="always"==t?null:s}};var c={undefined:1,"boolean":1,number:1,string:1};u.b("extenders",u.xa),u.sb=function(e,t,n){this.target=e,this.qa=t,this.Eb=n,u.s(this,"dispose",this.B)},u.sb.prototype.B=function(){this.Qb=!0,this.Eb()},u.ca=function(){this.F={},u.a.extend(this,u.ca.fn),u.s(this,"subscribe",this.T),u.s(this,"extend",this.extend),u.s(this,"getSubscriptionsCount",this.Lb)};var d="change";u.ca.fn={T:function(e,t,n){n=n||d;var i=new u.sb(this,t?e.bind(t):e,function(){u.a.ia(this.F[n],i)}.bind(this));return this.F[n]||(this.F[n]=[]),this.F[n].push(i),i},notifySubscribers:function(e,t){if(t=t||d,this.cb(t))try{u.i.Wa();for(var n,i=this.F[t].slice(0),r=0;n=i[r];++r)n&&!0!==n.Qb&&n.qa(e)}finally{u.i.end()}},cb:function(e){return this.F[e]&&this.F[e].length},Lb:function(){var e=0;return u.a.K(this.F,function(t,n){e+=n.length}),e},extend:function(e){var t=this;return e&&u.a.K(e,function(e,n){var i=u.xa[e];"function"==typeof i&&(t=i(t,n)||t)}),t}},u.fb=function(e){return null!=e&&"function"==typeof e.T&&"function"==typeof e.notifySubscribers},u.b("subscribable",u.ca),u.b("isSubscribable",u.fb),u.i=function(){var e=[];return{Wa:function(t){e.push(t&&{qa:t,Za:[]})},end:function(){e.pop()},lb:function(t){if(!u.fb(t))throw Error("Only subscribable things can act as dependencies");if(0<e.length){var n=e[e.length-1];!n||0<=u.a.l(n.Za,t)||(n.Za.push(t),n.qa(t))}},p:function(t,n,i){try{return e.push(null),t.apply(n,i||[])}finally{e.pop()}}}}(),u.q=function(e){function t(){return 0<arguments.length?(t.equalityComparer&&t.equalityComparer(n,arguments[0])||(t.O(),n=arguments[0],t.N()),this):(u.i.lb(t),n)}var n=e;return u.ca.call(t),t.t=function(){return n},t.N=function(){t.notifySubscribers(n)},t.O=function(){t.notifySubscribers(n,"beforeChange")},u.a.extend(t,u.q.fn),u.s(t,"peek",t.t),u.s(t,"valueHasMutated",t.N),u.s(t,"valueWillMutate",t.O),t},u.q.fn={equalityComparer:s};var p=u.q.Yb="__ko_proto__";u.q.fn[p]=u.q,u.ya=function(t,n){return null===t||t===e||t[p]===e?!1:t[p]===n?!0:u.ya(t[p],n)},u.M=function(e){return u.ya(e,u.q)},u.gb=function(e){return"function"==typeof e&&e[p]===u.q||"function"==typeof e&&e[p]===u.h&&e.Nb?!0:!1},u.b("observable",u.q),u.b("isObservable",u.M),u.b("isWriteableObservable",u.gb),u.ba=function(e){if(e=e||[],"object"!=typeof e||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=u.q(e),u.a.extend(e,u.ba.fn),e.extend({trackArrayChanges:!0})},u.ba.fn={remove:function(e){for(var t=this.t(),n=[],i="function"!=typeof e||u.M(e)?function(t){return t===e}:e,r=0;r<t.length;r++){var o=t[r];i(o)&&(0===n.length&&this.O(),n.push(o),t.splice(r,1),r--)}return n.length&&this.N(),n},removeAll:function(t){if(t===e){var n=this.t(),i=n.slice(0);return this.O(),n.splice(0,n.length),this.N(),i}return t?this.remove(function(e){return 0<=u.a.l(t,e)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||u.M(e)?function(t){return t===e}:e;this.O();for(var i=t.length-1;i>=0;i--)n(t[i])&&(t[i]._destroy=!0);this.N()},destroyAll:function(t){return t===e?this.destroy(function(){return!0}):t?this.destroy(function(e){return 0<=u.a.l(t,e)}):[]},indexOf:function(e){var t=this();return u.a.l(t,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.O(),this.t()[n]=t,this.N())}},u.a.n("pop push reverse shift sort splice unshift".split(" "),function(e){u.ba.fn[e]=function(){var t=this.t();return this.O(),this.Xa(t,e,arguments),t=t[e].apply(t,arguments),this.N(),t}}),u.a.n(["slice"],function(e){u.ba.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),u.b("observableArray",u.ba);var f="arrayChange";u.xa.trackArrayChanges=function(e){function t(){if(!n){n=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==d||++r,t.apply(this,arguments)};var o=[].concat(e.t()||[]);i=null,e.T(function(t){if(t=[].concat(t||[]),e.cb(f)){var n;(!i||r>1)&&(i=u.a.ra(o,t,{sparse:!0})),n=i,n.length&&e.notifySubscribers(n,f)}o=t,i=null,r=0})}}if(!e.Xa){var n=!1,i=null,r=0,o=e.T;e.T=e.subscribe=function(e,n,i){return i===f&&t(),o.apply(this,arguments)},e.Xa=function(e,t,o){function a(e,t,n){s.push({status:e,value:t,index:n})}if(n&&!r){var s=[],l=e.length,u=o.length,c=0;switch(t){case"push":c=l;case"unshift":for(t=0;u>t;t++)a("added",o[t],c+t);break;case"pop":c=l-1;case"shift":l&&a("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>o[0]?l+o[0]:o[0]),l);for(var l=1===u?l:Math.min(t+(o[1]||0),l),u=t+u-2,c=Math.max(l,u),d=2;c>t;++t,++d)l>t&&a("deleted",e[t],t),u>t&&a("added",o[d],t);break;default:return}i=s}}}},u.h=function(t,n,i){function r(){u.a.n(b,function(e){e.B()}),b=[]}function o(){var e=s.throttleEvaluation;e&&e>=0?(clearTimeout(S),S=setTimeout(a,e)):a()}function a(){if(!p){if(v&&v()){if(!f)return y(),void(d=!0)}else f=!1;p=!0;try{var t=u.a.ha(b,function(e){return e.target});u.i.Wa(function(n){var i;0<=(i=u.a.l(t,n))?t[i]=e:b.push(n.T(o))});for(var i=n?h.call(n):h(),r=t.length-1;r>=0;r--)t[r]&&b.splice(r,1)[0].B();d=!0,s.equalityComparer&&s.equalityComparer(c,i)||(s.notifySubscribers(c,"beforeChange"),c=i,s.notifySubscribers(c))}finally{u.i.end(),p=!1}b.length||y()}}function s(){if(0<arguments.length){if("function"!=typeof m)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return m.apply(n,arguments),this}return d||a(),u.i.lb(s),c}function l(){return!d||0<b.length}var c,d=!1,p=!1,f=!1,h=t;if(h&&"object"==typeof h?(i=h,h=i.read):(i=i||{},h||(h=i.read)),"function"!=typeof h)throw Error("Pass a function that returns the value of the ko.computed");var m=i.write,g=i.disposeWhenNodeIsRemoved||i.I||null,w=i.disposeWhen||i.ua,v=w,y=r,b=[],S=null;return n||(n=i.owner),s.t=function(){return d||a(),c},s.Kb=function(){return b.length},s.Nb="function"==typeof i.write,s.B=function(){y()},s.aa=l,u.ca.call(s),u.a.extend(s,u.h.fn),u.s(s,"peek",s.t),u.s(s,"dispose",s.B),u.s(s,"isActive",s.aa),u.s(s,"getDependenciesCount",s.Kb),g&&(f=!0,g.nodeType&&(v=function(){return!u.a.va(g)||w&&w()})),!0!==i.deferEvaluation&&a(),g&&l()&&(y=function(){u.a.C.mb(g,y),r()},u.a.C.ea(g,y)),s},u.Pb=function(e){return u.ya(e,u.h)},a=u.q.Yb,u.h[a]=u.q,u.h.fn={equalityComparer:s},u.h.fn[a]=u.h,u.b("dependentObservable",u.h),u.b("computed",u.h),u.b("isComputed",u.Pb),function(){function t(r,o,a){if(a=a||new i,r=o(r),"object"!=typeof r||null===r||r===e||r instanceof Date||r instanceof String||r instanceof Number||r instanceof Boolean)return r;var s=r instanceof Array?[]:{};return a.save(r,s),n(r,function(n){var i=o(r[n]);switch(typeof i){case"boolean":case"number":case"string":case"function":s[n]=i;break;case"object":case"undefined":var l=a.get(i);s[n]=l!==e?l:t(i,o,a)}}),s}function n(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}function i(){this.keys=[],this.Qa=[]}u.tb=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(e,function(e){for(var t=0;u.M(e)&&10>t;t++)e=e();return e})},u.toJSON=function(e,t,n){return e=u.tb(e),u.a.Na(e,t,n)},i.prototype={save:function(e,t){var n=u.a.l(this.keys,e);n>=0?this.Qa[n]=t:(this.keys.push(e),this.Qa.push(t))},get:function(t){return t=u.a.l(this.keys,t),t>=0?this.Qa[t]:e}}}(),u.b("toJS",u.tb),u.b("toJSON",u.toJSON),function(){u.k={o:function(t){switch(u.a.v(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?u.a.f.get(t,u.d.options.Ea):7>=u.a.ja?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?u.k.o(t.options[t.selectedIndex]):e;default:return t.value}},na:function(t,n){switch(u.a.v(t)){case"option":switch(typeof n){case"string":u.a.f.set(t,u.d.options.Ea,e),"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__,t.value=n;break;default:u.a.f.set(t,u.d.options.Ea,n),t.__ko__hasDomDataOptionValue__=!0,t.value="number"==typeof n?n:""}break;case"select":""===n&&(n=e),(null===n||n===e)&&(t.selectedIndex=-1);for(var i=t.options.length-1;i>=0;i--)if(u.k.o(t.options[i])==n){t.selectedIndex=i;break}1<t.size||-1!==t.selectedIndex||(t.selectedIndex=0);break;default:(null===n||n===e)&&(n=""),t.value=n}}}}(),u.b("selectExtensions",u.k),u.b("selectExtensions.readValue",u.k.o),u.b("selectExtensions.writeValue",u.k.na),u.g=function(){function e(e){e=u.a.la(e),123===e.charCodeAt(0)&&(e=e.slice(1,-1));var t,n,a=[],s=e.match(i),l=0;if(s){s.push(",");for(var c,d=0;c=s[d];++d){var p=c.charCodeAt(0);if(44===p){if(0>=l){t&&a.push(n?{key:t,value:n.join("")}:{unknown:t}),t=n=l=0;continue}}else if(58===p){if(!n)continue}else if(47===p&&d&&1<c.length)(p=s[d-1].match(r))&&!o[p[0]]&&(e=e.substr(e.indexOf(c)+1),s=e.match(i),s.push(","),d=-1,c="/");else if(40===p||123===p||91===p)++l;else if(41===p||125===p||93===p)--l;else if(!t&&!n){t=34===p||39===p?c.slice(1,-1):c;continue}n?n.push(c):n=[c]}}return a}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),r=/[\])"'A-Za-z0-9_$]+$/,o={"in":1,"return":1,"typeof":1},a={};return{Y:[],U:a,Ga:e,ka:function(i,r){function o(e,i){var r,d=u.getBindingHandler(e);(d&&d.preprocess?i=d.preprocess(i,e,o):1)&&((d=a[e])&&(r=i,0<=u.a.l(t,r)?r=!1:(d=r.match(n),r=null===d?!1:d[1]?"Object("+d[1]+")"+d[2]:r),d=r),d&&l.push("'"+e+"':function(_z){"+r+"=_z}"),c&&(i="function(){return "+i+" }"),s.push("'"+e+"':"+i))}r=r||{};var s=[],l=[],c=r.valueAccessors,d="string"==typeof i?e(i):i;return u.a.n(d,function(e){o(e.key||e.unknown,e.value)}),l.length&&o("_ko_property_writers","{"+l.join(",")+"}"),s.join(",")},Sb:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},oa:function(e,t,n,i,r){e&&u.M(e)?!u.gb(e)||r&&e.t()===i||e(i):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](i)}}}(),u.b("expressionRewriting",u.g),u.b("expressionRewriting.bindingRewriteValidators",u.g.Y),u.b("expressionRewriting.parseObjectLiteral",u.g.Ga),u.b("expressionRewriting.preProcessBindings",u.g.ka),u.b("expressionRewriting._twoWayBindings",u.g.U),u.b("jsonExpressionRewriting",u.g),u.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",u.g.ka),function(){function e(e){return 8==e.nodeType&&a.test(o?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(o?e.text:e.nodeValue)}function i(n,i){for(var r=n,o=1,a=[];r=r.nextSibling;){if(t(r)&&(o--,0===o))return a;a.push(r),e(r)&&o++}if(!i)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var n=i(e,t);return n?0<n.length?n[n.length-1].nextSibling:e.nextSibling:null}var o=n&&"<!--test-->"===n.createComment("test").text,a=o?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=o?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};u.e={P:{},childNodes:function(t){return e(t)?i(t):t.childNodes},Z:function(t){if(e(t)){t=u.e.childNodes(t);for(var n=0,i=t.length;i>n;n++)u.removeNode(t[n])}else u.a.wa(t)},S:function(t,n){if(e(t)){u.e.Z(t);for(var i=t.nextSibling,r=0,o=n.length;o>r;r++)i.parentNode.insertBefore(n[r],i)}else u.a.S(t,n)},kb:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},eb:function(t,n,i){i?e(t)?t.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?t.insertBefore(n,i.nextSibling):t.appendChild(n):u.e.kb(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=r(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Mb:e,bc:function(e){return(e=(o?e.text:e.nodeValue).match(a))?e[1]:null},ib:function(n){if(l[u.a.v(n)]){var i=n.firstChild;if(i)do if(1===i.nodeType){var o;o=i.firstChild;var a=null;if(o)do if(a)a.push(o);else if(e(o)){var s=r(o,!0);s?o=s:a=[o]}else t(o)&&(a=[o]);while(o=o.nextSibling);if(o=a)for(a=i.nextSibling,s=0;s<o.length;s++)a?n.insertBefore(o[s],a):n.appendChild(o[s])}while(i=i.nextSibling)}}}}(),u.b("virtualElements",u.e),u.b("virtualElements.allowedBindings",u.e.P),u.b("virtualElements.emptyNode",u.e.Z),u.b("virtualElements.insertAfter",u.e.eb),u.b("virtualElements.prepend",u.e.kb),u.b("virtualElements.setDomNodeChildren",u.e.S),function(){u.H=function(){this.zb={}},u.a.extend(u.H.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind");case 8:return u.e.Mb(e);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e):null},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t);return n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return u.e.bc(e);default:return null}},parseBindingsString:function(e,t,n,i){try{var r,o=this.zb,a=e+(i&&i.valueAccessors||"");if(!(r=o[a])){var s,l="with($context){with($data||{}){return{"+u.g.ka(e,i)+"}}}";s=new Function("$context","$element",l),r=o[a]=s}return r(t,n)}catch(c){throw c.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+c.message,c}}}),u.H.instance=new u.H}(),u.b("bindingProvider",u.H),function(){function n(e){return function(){return e}}function i(e){return e()}function r(e){return u.a.Da(u.i.p(e),function(t,n){return function(){return e()[n]}})}function o(e,t){return r(this.getBindings.bind(this,e,t))}function a(e,t,n){var i,r=u.e.firstChild(t),o=u.H.instance,a=o.preprocessNode;if(a){for(;i=r;)r=u.e.nextSibling(i),a.call(o,i);r=u.e.firstChild(t)}for(;i=r;)r=u.e.nextSibling(i),s(e,i,n)}function s(e,t,n){var i=!0,r=1===t.nodeType;r&&u.e.ib(t),(r&&n||u.H.instance.nodeHasBindings(t))&&(i=c(t,null,e,n).shouldBindDescendants),i&&!p[u.a.v(t)]&&a(e,t,!r)
}function l(e){var t=[],n={},i=[];return u.a.K(e,function r(o){if(!n[o]){var a=u.getBindingHandler(o);a&&(a.after&&(i.push(o),u.a.n(a.after,function(t){if(e[t]){if(-1!==u.a.l(i,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));r(t)}}),i.pop()),t.push({key:o,bb:a})),n[o]=!0}}),t}function c(t,n,r,a){var s=u.a.f.get(t,f);if(!n){if(s)throw Error("You cannot apply bindings multiple times to the same element.");u.a.f.set(t,f,!0)}!s&&a&&u.rb(t,r);var c;if(n&&"function"!=typeof n)c=n;else{var d=u.H.instance,p=d.getBindingAccessors||o;if(n||r.A){var h=u.h(function(){return(c=n?n(r,t):p.call(d,t,r))&&r.A&&r.A(),c},null,{I:t});c&&h.aa()||(h=null)}else c=u.i.p(p,d,[t,r])}var m;if(c){var g=h?function(e){return function(){return i(h()[e])}}:function(e){return c[e]},w=function(){return u.a.Da(h?h():c,i)};w.get=function(e){return c[e]&&i(g(e))},w.has=function(e){return e in c},a=l(c),u.a.n(a,function(n){var i=n.bb.init,o=n.bb.update,a=n.key;if(8===t.nodeType&&!u.e.P[a])throw Error("The binding '"+a+"' cannot be used with virtual elements");try{"function"==typeof i&&u.i.p(function(){var n=i(t,g(a),w,r.$data,r);if(n&&n.controlsDescendantBindings){if(m!==e)throw Error("Multiple bindings ("+m+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");m=a}}),"function"==typeof o&&u.h(function(){o(t,g(a),w,r.$data,r)},null,{I:t})}catch(s){throw s.message='Unable to process binding "'+a+": "+c[a]+'"\nMessage: '+s.message,s}})}return{shouldBindDescendants:m===e}}function d(e){return e&&e instanceof u.G?e:new u.G(e)}u.d={};var p={script:!0};u.getBindingHandler=function(e){return u.d[e]},u.G=function(t,n,i,r){var o,a=this,s="function"==typeof t,l=u.h(function(){var e=s?t():t;return n?(n.A&&n.A(),u.a.extend(a,n),l&&(a.A=l)):(a.$parents=[],a.$root=e,a.ko=u),a.$rawData=t,a.$data=e,i&&(a[i]=e),r&&r(a,n,e),a.$data},null,{ua:function(){return o&&!u.a.Ra(o)},I:!0});l.aa()&&(a.A=l,l.equalityComparer=null,o=[],l.wb=function(t){o.push(t),u.a.C.ea(t,function(t){u.a.ia(o,t),o.length||(l.B(),a.A=l=e)})})},u.G.prototype.createChildContext=function(e,t,n){return new u.G(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},u.G.prototype.extend=function(e){return new u.G(this.$rawData,this,null,function(t){u.a.extend(t,"function"==typeof e?e():e)})};var f=u.a.f.D(),h=u.a.f.D();u.rb=function(e,t){return 2!=arguments.length?u.a.f.get(e,h):(u.a.f.set(e,h,t),void(t.A&&t.A.wb(e)))},u.pa=function(e,t,n){return 1===e.nodeType&&u.e.ib(e),c(e,t,d(n),!0)},u.xb=function(e,t,i){return i=d(i),u.pa(e,"function"==typeof t?r(t.bind(null,i,e)):u.a.Da(t,n),i)},u.Ta=function(e,t){1!==t.nodeType&&8!==t.nodeType||a(d(e),t,!0)},u.Sa=function(e,n){if(n&&1!==n.nodeType&&8!==n.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");n=n||t.document.body,s(d(e),n,!0)},u.ta=function(t){switch(t.nodeType){case 1:case 8:var n=u.rb(t);if(n)return n;if(t.parentNode)return u.ta(t.parentNode)}return e},u.Cb=function(t){return(t=u.ta(t))?t.$data:e},u.b("bindingHandlers",u.d),u.b("applyBindings",u.Sa),u.b("applyBindingsToDescendants",u.Ta),u.b("applyBindingAccessorsToNode",u.pa),u.b("applyBindingsToNode",u.xb),u.b("contextFor",u.ta),u.b("dataFor",u.Cb)}();var h={"class":"className","for":"htmlFor"};u.d.attr={update:function(t,n){var i=u.a.c(n())||{};u.a.K(i,function(n,i){i=u.a.c(i);var r=!1===i||null===i||i===e;r&&t.removeAttribute(n),8>=u.a.ja&&n in h?(n=h[n],r?t.removeAttribute(n):t[n]=i):r||t.setAttribute(n,i.toString()),"name"===n&&u.a.pb(t,r?"":i.toString())})}},function(){u.d.checked={after:["value","attr"],init:function(t,n,i){function r(){return i.has("checkedValue")?u.a.c(i.get("checkedValue")):t.value}function o(){var e=t.checked,o=p?r():e;if(f&&(!l||e)){var a=u.i.p(n);c?d!==o?(e&&(u.a.V(a,o,!0),u.a.V(a,d,!1)),d=o):u.a.V(a,o,e):u.g.oa(a,i,"checked",o,!0)}}function a(){var e=u.a.c(n());t.checked=c?0<=u.a.l(e,r()):s?e:r()===e}var s="checkbox"==t.type,l="radio"==t.type;if(s||l){var c=s&&u.a.c(n())instanceof Array,d=c?r():e,p=l||c,f=!1;l&&!t.name&&u.d.uniqueName.init(t,function(){return!0}),u.h(o,null,{I:t}),u.a.r(t,"click",o),u.h(a,null,{I:t}),f=!0}}},u.g.U.checked=!0,u.d.checkedValue={update:function(e,t){e.value=u.a.c(t())}}}(),u.d.css={update:function(e,t){var n=u.a.c(t());"object"==typeof n?u.a.K(n,function(t,n){n=u.a.c(n),u.a.ma(e,t,n)}):(n=String(n||""),u.a.ma(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,u.a.ma(e,n,!0))}},u.d.enable={update:function(e,t){var n=u.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},u.d.disable={update:function(e,t){u.d.enable.update(e,function(){return!u.a.c(t())})}},u.d.event={init:function(e,t,n,i,r){var o=t()||{};u.a.K(o,function(o){"string"==typeof o&&u.a.r(e,o,function(e){var a,s=t()[o];if(s){try{var l=u.a.Q(arguments);i=r.$data,l.unshift(i),a=s.apply(i,l)}finally{!0!==a&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(o+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},u.d.foreach={hb:function(e){return function(){var t=e(),n=u.a.Ha(t);return n&&"number"!=typeof n.length?(u.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:u.J.Aa}):{foreach:t,templateEngine:u.J.Aa}}},init:function(e,t){return u.d.template.init(e,u.d.foreach.hb(t))},update:function(e,t,n,i,r){return u.d.template.update(e,u.d.foreach.hb(t),n,i,r)}},u.g.Y.foreach=!1,u.e.P.foreach=!0,u.d.hasfocus={init:function(e,t,n){function i(i){e.__ko_hasfocusUpdating=!0;var r=e.ownerDocument;if("activeElement"in r){var o;try{o=r.activeElement}catch(a){o=r.body}i=o===e}r=t(),u.g.oa(r,n,"hasfocus",i,!0),e.__ko_hasfocusLastValue=i,e.__ko_hasfocusUpdating=!1}var r=i.bind(null,!0),o=i.bind(null,!1);u.a.r(e,"focus",r),u.a.r(e,"focusin",r),u.a.r(e,"blur",o),u.a.r(e,"focusout",o)},update:function(e,t){var n=!!u.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),u.i.p(u.a.da,null,[e,n?"focusin":"focusout"]))}},u.g.U.hasfocus=!0,u.d.hasFocus=u.d.hasfocus,u.g.U.hasFocus=!0,u.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){u.a.Ka(e,t())}};var m=u.a.f.D();l("if"),l("ifnot",!1,!0),l("with",!0,!1,function(e,t){return e.createChildContext(t)}),u.d.options={init:function(e){if("select"!==u.a.v(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(t,i,r){function o(){return u.a.ga(t.options,function(e){return e.selected})}function a(e,t,n){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:n}function s(e,n){if(c.length){var i=0<=u.a.l(c,u.k.o(n[0]));u.a.qb(n[0],i),h&&!i&&u.i.p(u.a.da,null,[t,"change"])}}var l=0!=t.length&&t.multiple?t.scrollTop:null;i=u.a.c(i());var c,d=r.get("optionsIncludeDestroyed"),p={};if(c=t.multiple?u.a.ha(o(),u.k.o):0<=t.selectedIndex?[u.k.o(t.options[t.selectedIndex])]:[],i){"undefined"==typeof i.length&&(i=[i]);var f=u.a.ga(i,function(t){return d||t===e||null===t||!u.a.c(t._destroy)});r.has("optionsCaption")&&(i=u.a.c(r.get("optionsCaption")),null!==i&&i!==e&&f.unshift(p))}else i=[];var h=!1;i=s,r.has("optionsAfterRender")&&(i=function(t,n){s(0,n),u.i.p(r.get("optionsAfterRender"),null,[n[0],t!==p?t:e])}),u.a.Ja(t,f,function(t,i,o){return o.length&&(c=o[0].selected?[u.k.o(o[0])]:[],h=!0),i=n.createElement("option"),t===p?(u.a.Ma(i,r.get("optionsCaption")),u.k.na(i,e)):(o=a(t,r.get("optionsValue"),t),u.k.na(i,u.a.c(o)),t=a(t,r.get("optionsText"),o),u.a.Ma(i,t)),[i]},null,i),(t.multiple?c.length&&o().length<c.length:c.length&&0<=t.selectedIndex?u.k.o(t.options[t.selectedIndex])!==c[0]:c.length||0<=t.selectedIndex)&&u.i.p(u.a.da,null,[t,"change"]),u.a.Hb(t),l&&20<Math.abs(l-t.scrollTop)&&(t.scrollTop=l)}},u.d.options.Ea=u.a.f.D(),u.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){u.a.r(e,"change",function(){var i=t(),r=[];u.a.n(e.getElementsByTagName("option"),function(e){e.selected&&r.push(u.k.o(e))}),u.g.oa(i,n,"selectedOptions",r)})},update:function(e,t){if("select"!=u.a.v(e))throw Error("values binding applies only to SELECT elements");var n=u.a.c(t());n&&"number"==typeof n.length&&u.a.n(e.getElementsByTagName("option"),function(e){var t=0<=u.a.l(n,u.k.o(e));u.a.qb(e,t)})}},u.g.U.selectedOptions=!0,u.d.style={update:function(e,t){var n=u.a.c(t()||{});u.a.K(n,function(t,n){n=u.a.c(n),e.style[t]=n||""})}},u.d.submit={init:function(e,t,n,i,r){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");u.a.r(e,"submit",function(n){var i,o=t();try{i=o.call(r.$data,e)}finally{!0!==i&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},u.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){u.a.Ma(e,t())}},u.e.P.text=!0,u.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++u.d.uniqueName.Bb;u.a.pb(e,n)}}},u.d.uniqueName.Bb=0,u.d.value={after:["options","foreach"],init:function(e,t,n){function i(){a=!1;var i=t(),r=u.k.o(e);u.g.oa(i,n,"value",r)}var r=["change"],o=n.get("valueUpdate"),a=!1;o&&("string"==typeof o&&(o=[o]),u.a.X(r,o),r=u.a.Va(r)),!u.a.ja||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=u.a.l(r,"propertychange")||(u.a.r(e,"propertychange",function(){a=!0}),u.a.r(e,"blur",function(){a&&i()})),u.a.n(r,function(t){var n=i;u.a.ac(t,"after")&&(n=function(){setTimeout(i,0)},t=t.substring(5)),u.a.r(e,t,n)})},update:function(e,t){var n="select"===u.a.v(e),i=u.a.c(t()),r=u.k.o(e);i!==r&&(r=function(){u.k.na(e,i)},r(),n&&(i!==u.k.o(e)?u.i.p(u.a.da,null,[e,"change"]):setTimeout(r,0)))}},u.g.U.value=!0,u.d.visible={update:function(e,t){var n=u.a.c(t()),i="none"!=e.style.display;n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},function(e){u.d[e]={init:function(t,n,i,r,o){return u.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},i,r,o)}}}("click"),u.w=function(){},u.w.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},u.w.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},u.w.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||n;var i=t.getElementById(e);if(!i)throw Error("Cannot find template with ID "+e);return new u.m.j(i)}if(1==e.nodeType||8==e.nodeType)return new u.m.W(e);throw Error("Unknown template type: "+e)},u.w.prototype.renderTemplate=function(e,t,n,i){return e=this.makeTemplateSource(e,i),this.renderTemplateSource(e,t,n)},u.w.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,t).data("isRewritten")},u.w.prototype.rewriteTemplate=function(e,t,n){e=this.makeTemplateSource(e,n),t=t(e.text()),e.text(t),e.data("isRewritten",!0)},u.b("templateEngine",u.w),u.Oa=function(){function e(e,t,n,i){e=u.g.Ga(e);for(var r=u.g.Y,o=0;o<e.length;o++){var a=e[o].key;if(r.hasOwnProperty(a)){var s=r[a];if("function"==typeof s){if(a=s(e[o].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+u.g.ka(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Ib:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return u.Oa.Ub(e,t)},n)},Ub:function(i,r){return i.replace(t,function(t,n,i,o,a){return e(a,n,i,r)}).replace(n,function(t,n){return e(n,"<!-- ko -->","#comment",r)})},yb:function(e,t){return u.u.Ca(function(n,i){var r=n.nextSibling;r&&r.nodeName.toLowerCase()===t&&u.pa(r,e,i)})}}}(),u.b("__tr_ambtns",u.Oa.yb),function(){u.m={},u.m.j=function(e){this.j=e},u.m.j.prototype.text=function(){var e=u.a.v(this.j),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.j[e];var t=arguments[0];"innerHTML"===e?u.a.Ka(this.j,t):this.j[e]=t};var t=u.a.f.D()+"_";u.m.j.prototype.data=function(e){return 1===arguments.length?u.a.f.get(this.j,t+e):void u.a.f.set(this.j,t+e,arguments[1])};var n=u.a.f.D();u.m.W=function(e){this.j=e},u.m.W.prototype=new u.m.j,u.m.W.prototype.text=function(){if(0==arguments.length){var t=u.a.f.get(this.j,n)||{};return t.Pa===e&&t.sa&&(t.Pa=t.sa.innerHTML),t.Pa}u.a.f.set(this.j,n,{Pa:arguments[0]})},u.m.j.prototype.nodes=function(){return 0==arguments.length?(u.a.f.get(this.j,n)||{}).sa:void u.a.f.set(this.j,n,{sa:arguments[0]})},u.b("templateSources",u.m),u.b("templateSources.domElement",u.m.j),u.b("templateSources.anonymousTemplate",u.m.W)}(),function(){function t(e,t,n){var i;for(t=u.e.nextSibling(t);e&&(i=e)!==t;)e=u.e.nextSibling(i),n(i,e)}function n(e,n){if(e.length){var i=e[0],r=e[e.length-1],o=i.parentNode,a=u.H.instance,s=a.preprocessNode;if(s){if(t(i,r,function(e,t){var n=e.previousSibling,o=s.call(a,e);o&&(e===i&&(i=o[0]||t),e===r&&(r=o[o.length-1]||n))}),e.length=0,!i)return;i===r?e.push(i):(e.push(i,r),u.a.$(e,o))}t(i,r,function(e){1!==e.nodeType&&8!==e.nodeType||u.Sa(n,e)}),t(i,r,function(e){1!==e.nodeType&&8!==e.nodeType||u.u.vb(e,[n])}),u.a.$(e,o)}}function i(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,t,r,a,s){s=s||{};var l=e&&i(e),l=l&&l.ownerDocument,c=s.templateEngine||o;if(u.Oa.Ib(r,c,l),r=c.renderTemplate(r,a,s,l),"number"!=typeof r.length||0<r.length&&"number"!=typeof r[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(l=!1,t){case"replaceChildren":u.e.S(e,r),l=!0;break;case"replaceNode":u.a.nb(e,r),l=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}return l&&(n(r,a),s.afterRender&&u.i.p(s.afterRender,null,[r,a.$data])),r}var o;u.La=function(t){if(t!=e&&!(t instanceof u.w))throw Error("templateEngine must inherit from ko.templateEngine");o=t},u.Ia=function(t,n,a,s,l){if(a=a||{},(a.templateEngine||o)==e)throw Error("Set a template engine before calling renderTemplate");if(l=l||"replaceChildren",s){var c=i(s);return u.h(function(){var e=n&&n instanceof u.G?n:new u.G(u.a.c(n)),o="function"==typeof t?t(e.$data,e):t,e=r(s,l,o,e,a);"replaceNode"==l&&(s=e,c=i(s))},null,{ua:function(){return!c||!u.a.va(c)},I:c&&"replaceNode"==l?c.parentNode:c})}return u.u.Ca(function(e){u.Ia(t,n,a,e,"replaceNode")})},u.$b=function(t,i,o,a,s){function l(e,t){n(t,d),o.afterRender&&o.afterRender(t,e)}function c(e,n){d=s.createChildContext(e,o.as,function(e){e.$index=n});var i="function"==typeof t?t(e,d):t;return r(null,"ignoreTargetNode",i,d,o)}var d;return u.h(function(){var t=u.a.c(i)||[];"undefined"==typeof t.length&&(t=[t]),t=u.a.ga(t,function(t){return o.includeDestroyed||t===e||null===t||!u.a.c(t._destroy)}),u.i.p(u.a.Ja,null,[a,t,c,o,l])},null,{I:a})};var a=u.a.f.D();u.d.template={init:function(e,t){var n=u.a.c(t());return"string"==typeof n||n.name?u.e.Z(e):(n=u.e.childNodes(e),n=u.a.Vb(n),new u.m.W(e).nodes(n)),{controlsDescendantBindings:!0}},update:function(t,n,i,r,o){n=u.a.c(n()),i={},r=!0;var s,l=null;"string"!=typeof n&&(i=n,n=u.a.c(i.name),"if"in i&&(r=u.a.c(i["if"])),r&&"ifnot"in i&&(r=!u.a.c(i.ifnot)),s=u.a.c(i.data)),"foreach"in i?l=u.$b(n||t,r&&i.foreach||[],i,t,o):r?(o="data"in i?o.createChildContext(s,i.as):o,l=u.Ia(n||t,o,i,t)):u.e.Z(t),o=l,(s=u.a.f.get(t,a))&&"function"==typeof s.B&&s.B(),u.a.f.set(t,a,o&&o.aa()?o:e)}},u.g.Y.template=function(e){return e=u.g.Ga(e),1==e.length&&e[0].unknown||u.g.Sb(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},u.e.P.template=!0}(),u.b("setTemplateEngine",u.La),u.b("renderTemplate",u.Ia),u.a.ra=function(){function e(e,t,n,i,r){var o,a,s,l,u,c=Math.min,d=Math.max,p=[],f=e.length,h=t.length,m=h-f||1,g=f+h+1;for(o=0;f>=o;o++)for(l=s,p.push(s=[]),u=c(h,o+m),a=d(0,o-1);u>=a;a++)s[a]=a?o?e[o-1]===t[a-1]?l[a-1]:c(l[a]||g,s[a-1]||g)+1:a+1:o+1;for(c=[],d=[],m=[],o=f,a=h;o||a;)h=p[o][a]-1,a&&h===p[o][a-1]?d.push(c[c.length]={status:n,value:t[--a],index:a}):o&&h===p[o-1][a]?m.push(c[c.length]={status:i,value:e[--o],index:o}):(--a,--o,r.sparse||c.push({status:"retained",value:t[a]}));if(d.length&&m.length){e=10*f;var w;for(t=n=0;(r.dontLimitMoves||e>t)&&(w=d[n]);n++){for(i=0;p=m[i];i++)if(w.value===p.value){w.moved=p.index,p.moved=w.index,m.splice(i,1),t=i=0;break}t+=i}}return c.reverse()}return function(t,n,i){return i="boolean"==typeof i?{dontLimitMoves:i}:i||{},t=t||[],n=n||[],t.length<=n.length?e(t,n,"added","deleted",i):e(n,t,"deleted","added",i)}}(),u.b("utils.compareArrays",u.a.ra),function(){function t(t,n,i,r,o){var a=[],s=u.h(function(){var e=n(i,o,u.a.$(a,t))||[];0<a.length&&(u.a.nb(a,e),r&&u.i.p(r,null,[i,e,o])),a.splice(0,a.length),u.a.X(a,e)},null,{I:t,ua:function(){return!u.a.Ra(a)}});return{R:a,h:s.aa()?s:e}}var n=u.a.f.D();u.a.Ja=function(i,r,o,a,s){function l(e,t){b=p[t],w!==t&&(k[e]=b),b.za(w++),u.a.$(b.R,i),m.push(b),y.push(b)}function c(e,t){if(e)for(var n=0,i=t.length;i>n;n++)t[n]&&u.a.n(t[n].R,function(i){e(i,n,t[n].fa)})}r=r||[],a=a||{};var d=u.a.f.get(i,n)===e,p=u.a.f.get(i,n)||[],f=u.a.ha(p,function(e){return e.fa}),h=u.a.ra(f,r,a.dontLimitMoves),m=[],g=0,w=0,v=[],y=[];r=[];for(var b,S,O,k=[],f=[],W=0;S=h[W];W++)switch(O=S.moved,S.status){case"deleted":O===e&&(b=p[g],b.h&&b.h.B(),v.push.apply(v,u.a.$(b.R,i)),a.beforeRemove&&(r[W]=b,y.push(b))),g++;break;case"retained":l(W,g++);break;case"added":O!==e?l(W,O):(b={fa:S.value,za:u.q(w++)},m.push(b),y.push(b),d||(f[W]=b))}c(a.beforeMove,k),u.a.n(v,a.beforeRemove?u.L:u.removeNode);for(var D,W=0,d=u.e.firstChild(i);b=y[W];W++){for(b.R||u.a.extend(b,t(i,o,b.fa,s,b.za)),g=0;h=b.R[g];d=h.nextSibling,D=h,g++)h!==d&&u.e.eb(i,h,D);!b.Ob&&s&&(s(b.fa,b.R,b.za),b.Ob=!0)}c(a.beforeRemove,r),c(a.afterMove,k),c(a.afterAdd,f),u.a.f.set(i,n,m)}}(),u.b("utils.setDomNodeChildrenFromArrayMapping",u.a.Ja),u.J=function(){this.allowTemplateRewriting=!1},u.J.prototype=new u.w,u.J.prototype.renderTemplateSource=function(e){var t=(9>u.a.ja?0:e.nodes)?e.nodes():null;return t?u.a.Q(t.cloneNode(!0).childNodes):(e=e.text(),u.a.Fa(e))},u.J.Aa=new u.J,u.La(u.J.Aa),u.b("nativeTemplateEngine",u.J),function(){u.Ba=function(){var e=this.Rb=function(){if("undefined"==typeof r||!r.tmpl)return 0;try{if(0<=r.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,i,o){if(o=o||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var a=t.data("precompiled");return a||(a=t.text()||"",a=r.template(null,"{{ko_with $item.koBindingContext}}"+a+"{{/ko_with}}"),t.data("precompiled",a)),t=[i.$data],i=r.extend({koBindingContext:i},o.templateOptions),i=r.tmpl(a,t,i),i.appendTo(n.createElement("div")),r.fragments={},i},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){n.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},e>0&&(r.tmpl.tag.ko_code={open:"__.push($1 || '');"},r.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},u.Ba.prototype=new u.w;var e=new u.Ba;0<e.Rb&&u.La(e),u.b("jqueryTmplTemplateEngine",u.Ba)}()})}()}(),function(e){function t(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function n(e,t){function n(){lt.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}var i=!0;return l(function(){return i&&(n(),i=!1),t.apply(this,arguments)},t)}function i(e,t){return function(n){return d(e.call(this,n),t)}}function r(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function o(){}function a(e){W(e),l(this,e)}function s(e){var t=w(e),n=t.year||0,i=t.quarter||0,r=t.month||0,o=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*u+6e4*l+36e5*s,this._days=+a+7*o,this._months=+r+3*i+12*n,this._data={},this._bubble()}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function u(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&Ot.hasOwnProperty(t)&&(n[t]=e[t]);return n}function c(e){return 0>e?Math.ceil(e):Math.floor(e)}function d(e,t,n){for(var i=""+Math.abs(e),r=e>=0;i.length<t;)i="0"+i;return(r?n?"+":"":"-")+i}function p(e,t,n,i){var r=t._milliseconds,o=t._days,a=t._months;i=null==i?!0:i,r&&e._d.setTime(+e._d+r*n),o&&it(e,"Date",nt(e,"Date")+o*n),a&&tt(e,nt(e,"Month")+a*n),i&&lt.updateOffset(e,o||a)}function f(e){return"[object Array]"===Object.prototype.toString.call(e)}function h(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function m(e,t,n){var i,r=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(i=0;r>i;i++)(n&&e[i]!==t[i]||!n&&y(e[i])!==y(t[i]))&&a++;return a+o}function g(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=Zt[e]||Kt[t]||t}return e}function w(e){var t,n,i={};for(n in e)e.hasOwnProperty(n)&&(t=g(n),t&&(i[t]=e[n]));return i}function v(t){var n,i;if(0===t.indexOf("week"))n=7,i="day";else{if(0!==t.indexOf("month"))return;n=12,i="month"}lt[t]=function(r,o){var a,s,l=lt.fn._lang[t],u=[];if("number"==typeof r&&(o=r,r=e),s=function(e){var t=lt().utc().set(i,e);return l.call(lt.fn._lang,t,r||"")},null!=o)return s(o);for(a=0;n>a;a++)u.push(s(a));return u}}function y(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function b(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function S(e,t,n){return K(lt([e,11,31+t-n]),t,n).week}function O(e){return k(e)?366:365}function k(e){return e%4===0&&e%100!==0||e%400===0}function W(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[mt]<0||e._a[mt]>11?mt:e._a[gt]<1||e._a[gt]>b(e._a[ht],e._a[mt])?gt:e._a[wt]<0||e._a[wt]>23?wt:e._a[vt]<0||e._a[vt]>59?vt:e._a[yt]<0||e._a[yt]>59?yt:e._a[bt]<0||e._a[bt]>999?bt:-1,e._pf._overflowDayOfYear&&(ht>t||t>gt)&&(t=gt),e._pf.overflow=t)}function D(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function _(e){return e?e.toLowerCase().replace("_","-"):e}function T(e,t){return t._isUTC?lt(e).zone(t._offset||0):lt(e).local()}function E(e,t){return t.abbr=e,St[e]||(St[e]=new o),St[e].set(t),St[e]}function P(e){delete St[e]}function M(e){var t,n,i,r,o=0,a=function(e){if(!St[e]&&kt)try{require("./lang/"+e)}catch(t){}return St[e]};if(!e)return lt.fn._lang;if(!f(e)){if(n=a(e))return n;e=[e]}for(;o<e.length;){for(r=_(e[o]).split("-"),t=r.length,i=_(e[o+1]),i=i?i.split("-"):null;t>0;){if(n=a(r.slice(0,t).join("-")))return n;if(i&&i.length>=t&&m(r,i,!0)>=t-1)break;t--}o++}return lt.fn._lang}function x(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function C(e){var t,n,i=e.match(Tt);for(t=0,n=i.length;n>t;t++)i[t]=nn[i[t]]?nn[i[t]]:x(i[t]);return function(r){var o="";for(t=0;n>t;t++)o+=i[t]instanceof Function?i[t].call(r,e):i[t];return o}}function I(e,t){return e.isValid()?(t=F(t,e.lang()),Qt[t]||(Qt[t]=C(t)),Qt[t](e)):e.lang().invalidDate()}function F(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(Et.lastIndex=0;i>=0&&Et.test(e);)e=e.replace(Et,n),Et.lastIndex=0,i-=1;return e}function L(e,t){var n,i=t._strict;switch(e){case"Q":return Rt;case"DDDD":return Ut;case"YYYY":case"GGGG":case"gggg":return i?qt:xt;case"Y":case"G":case"g":return Ht;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?Yt:Ct;case"S":if(i)return Rt;case"SS":if(i)return jt;case"SSS":if(i)return Ut;case"DDD":return Mt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ft;case"a":case"A":return M(t._l)._meridiemParse;case"X":return Nt;case"Z":case"ZZ":return Lt;case"T":return Vt;case"SSSS":return It;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?jt:Pt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Pt;case"Do":return At;default:return n=new RegExp(Y(q(e.replace("\\","")),"i"))}}function V(e){e=e||"";var t=e.match(Lt)||[],n=t[t.length-1]||[],i=(n+"").match(Jt)||["-",0,0],r=+(60*i[1])+y(i[2]);return"+"===i[0]?-r:r}function N(e,t,n){var i,r=n._a;switch(e){case"Q":null!=t&&(r[mt]=3*(y(t)-1));break;case"M":case"MM":null!=t&&(r[mt]=y(t)-1);break;case"MMM":case"MMMM":i=M(n._l).monthsParse(t),null!=i?r[mt]=i:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(r[gt]=y(t));break;case"Do":null!=t&&(r[gt]=y(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=y(t));break;case"YY":r[ht]=lt.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":r[ht]=y(t);break;case"a":case"A":n._isPm=M(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":r[wt]=y(t);break;case"m":case"mm":r[vt]=y(t);break;case"s":case"ss":r[yt]=y(t);break;case"S":case"SS":case"SSS":case"SSSS":r[bt]=y(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=V(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=t)}}function A(e){var t,n,i,r,o,a,s,l,u,c,d=[];if(!e._d){for(i=j(e),e._w&&null==e._a[gt]&&null==e._a[mt]&&(o=function(t){var n=parseInt(t,10);return t?t.length<3?n>68?1900+n:2e3+n:n:null==e._a[ht]?lt().weekYear():e._a[ht]},a=e._w,null!=a.GG||null!=a.W||null!=a.E?s=Q(o(a.GG),a.W||1,a.E,4,1):(l=M(e._l),u=null!=a.d?J(a.d,l):null!=a.e?parseInt(a.e,10)+l._week.dow:0,c=parseInt(a.w,10)||1,null!=a.d&&u<l._week.dow&&c++,s=Q(o(a.gg),c,u,l._week.doy,l._week.dow)),e._a[ht]=s.year,e._dayOfYear=s.dayOfYear),e._dayOfYear&&(r=null==e._a[ht]?i[ht]:e._a[ht],e._dayOfYear>O(r)&&(e._pf._overflowDayOfYear=!0),n=$(r,0,e._dayOfYear),e._a[mt]=n.getUTCMonth(),e._a[gt]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=d[t]=i[t];for(;7>t;t++)e._a[t]=d[t]=null==e._a[t]?2===t?1:0:e._a[t];d[wt]+=y((e._tzm||0)/60),d[vt]+=y((e._tzm||0)%60),e._d=(e._useUTC?$:B).apply(null,d)}}function R(e){var t;e._d||(t=w(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],A(e))}function j(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function U(e){e._a=[],e._pf.empty=!0;var t,n,i,r,o,a=M(e._l),s=""+e._i,l=s.length,u=0;for(i=F(e._f,a).match(Tt)||[],t=0;t<i.length;t++)r=i[t],n=(s.match(L(r,e))||[])[0],n&&(o=s.substr(0,s.indexOf(n)),o.length>0&&e._pf.unusedInput.push(o),s=s.slice(s.indexOf(n)+n.length),u+=n.length),nn[r]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(r),N(r,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(r);e._pf.charsLeftOver=l-u,s.length>0&&e._pf.unusedInput.push(s),e._isPm&&e._a[wt]<12&&(e._a[wt]+=12),e._isPm===!1&&12===e._a[wt]&&(e._a[wt]=0),A(e),W(e)}function q(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r})}function Y(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function H(e){var n,i,r,o,a;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(o=0;o<e._f.length;o++)a=0,n=l({},e),n._pf=t(),n._f=e._f[o],U(n),D(n)&&(a+=n._pf.charsLeftOver,a+=10*n._pf.unusedTokens.length,n._pf.score=a,(null==r||r>a)&&(r=a,i=n));l(e,i||n)}function z(e){var t,n,i=e._i,r=zt.exec(i);if(r){for(e._pf.iso=!0,t=0,n=Bt.length;n>t;t++)if(Bt[t][1].exec(i)){e._f=Bt[t][0]+(r[6]||" ");break}for(t=0,n=$t.length;n>t;t++)if($t[t][1].exec(i)){e._f+=$t[t][0];break}i.match(Lt)&&(e._f+="Z"),U(e)}else lt.createFromInputFallback(e)}function G(t){var n=t._i,i=Wt.exec(n);n===e?t._d=new Date:i?t._d=new Date(+i[1]):"string"==typeof n?z(t):f(n)?(t._a=n.slice(0),A(t)):h(n)?t._d=new Date(+n):"object"==typeof n?R(t):"number"==typeof n?t._d=new Date(n):lt.createFromInputFallback(t)}function B(e,t,n,i,r,o,a){var s=new Date(e,t,n,i,r,o,a);return 1970>e&&s.setFullYear(e),s}function $(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function J(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function X(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function Z(e,t,n){var i=ft(Math.abs(e)/1e3),r=ft(i/60),o=ft(r/60),a=ft(o/24),s=ft(a/365),l=45>i&&["s",i]||1===r&&["m"]||45>r&&["mm",r]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",ft(a/30)]||1===s&&["y"]||["yy",s];return l[2]=t,l[3]=e>0,l[4]=n,X.apply({},l)}function K(e,t,n){var i,r=n-t,o=n-e.day();return o>r&&(o-=7),r-7>o&&(o+=7),i=lt(e).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function Q(e,t,n,i,r){var o,a,s=$(e,0,1).getUTCDay();return n=null!=n?n:r,o=r-s+(s>i?7:0)-(r>s?7:0),a=7*(t-1)+(n-r)+o+1,{year:a>0?e:e-1,dayOfYear:a>0?a:O(e-1)+a}}function et(t){var n=t._i,i=t._f;return null===n||i===e&&""===n?lt.invalid({nullInput:!0}):("string"==typeof n&&(t._i=n=M().preparse(n)),lt.isMoment(n)?(t=u(n),t._d=new Date(+n._d)):i?f(i)?H(t):U(t):G(t),new a(t))}function tt(e,t){var n;return"string"==typeof t&&(t=e.lang().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),b(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function nt(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function it(e,t,n){return"Month"===t?tt(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function rt(e,t){return function(n){return null!=n?(it(this,e,n),lt.updateOffset(this,t),this):nt(this,e)}}function ot(e){lt.duration.fn[e]=function(){return this._data[e]}}function at(e,t){lt.duration.fn["as"+e]=function(){return+this/t}}function st(e){"undefined"==typeof ender&&(ut=pt.moment,pt.moment=e?n("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",lt):lt)}for(var lt,ut,ct,dt="2.6.0",pt="undefined"!=typeof global?global:this,ft=Math.round,ht=0,mt=1,gt=2,wt=3,vt=4,yt=5,bt=6,St={},Ot={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},kt="undefined"!=typeof module&&module.exports,Wt=/^\/?Date\((\-?\d+)/i,Dt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,_t=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Tt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Et=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Pt=/\d\d?/,Mt=/\d{1,3}/,xt=/\d{1,4}/,Ct=/[+\-]?\d{1,6}/,It=/\d+/,Ft=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Lt=/Z|[\+\-]\d\d:?\d\d/gi,Vt=/T/i,Nt=/[\+\-]?\d+(\.\d{1,3})?/,At=/\d{1,2}/,Rt=/\d/,jt=/\d\d/,Ut=/\d{3}/,qt=/\d{4}/,Yt=/[+-]?\d{6}/,Ht=/[+-]?\d+/,zt=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Gt="YYYY-MM-DDTHH:mm:ssZ",Bt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],$t=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Jt=/([\+\-]|\d\d)/gi,Xt=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),Zt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Kt={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Qt={},en="DDD w W M D d".split(" "),tn="M D H h m s w W".split(" "),nn={M:function(){return this.month()+1
},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return d(this.year()%100,2)},YYYY:function(){return d(this.year(),4)},YYYYY:function(){return d(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+d(Math.abs(e),6)},gg:function(){return d(this.weekYear()%100,2)},gggg:function(){return d(this.weekYear(),4)},ggggg:function(){return d(this.weekYear(),5)},GG:function(){return d(this.isoWeekYear()%100,2)},GGGG:function(){return d(this.isoWeekYear(),4)},GGGGG:function(){return d(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return y(this.milliseconds()/100)},SS:function(){return d(y(this.milliseconds()/10),2)},SSS:function(){return d(this.milliseconds(),3)},SSSS:function(){return d(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+d(y(e/60),2)+":"+d(y(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+d(y(e/60),2)+d(y(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},rn=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];en.length;)ct=en.pop(),nn[ct+"o"]=r(nn[ct],ct);for(;tn.length;)ct=tn.pop(),nn[ct+ct]=i(nn[ct],2);for(nn.DDDD=i(nn.DDD,3),l(o.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=lt.utc([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=lt([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return K(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),lt=function(n,i,r,o){var a;return"boolean"==typeof r&&(o=r,r=e),a={},a._isAMomentObject=!0,a._i=n,a._f=i,a._l=r,a._strict=o,a._isUTC=!1,a._pf=t(),et(a)},lt.suppressDeprecationWarnings=!1,lt.createFromInputFallback=n("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),lt.utc=function(n,i,r,o){var a;return"boolean"==typeof r&&(o=r,r=e),a={},a._isAMomentObject=!0,a._useUTC=!0,a._isUTC=!0,a._l=r,a._i=n,a._f=i,a._strict=o,a._pf=t(),et(a).utc()},lt.unix=function(e){return lt(1e3*e)},lt.duration=function(e,t){var n,i,r,o=e,a=null;return lt.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(a=Dt.exec(e))?(n="-"===a[1]?-1:1,o={y:0,d:y(a[gt])*n,h:y(a[wt])*n,m:y(a[vt])*n,s:y(a[yt])*n,ms:y(a[bt])*n}):(a=_t.exec(e))&&(n="-"===a[1]?-1:1,r=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n},o={y:r(a[2]),M:r(a[3]),d:r(a[4]),h:r(a[5]),m:r(a[6]),s:r(a[7]),w:r(a[8])}),i=new s(o),lt.isDuration(e)&&e.hasOwnProperty("_lang")&&(i._lang=e._lang),i},lt.version=dt,lt.defaultFormat=Gt,lt.momentProperties=Ot,lt.updateOffset=function(){},lt.lang=function(e,t){var n;return e?(t?E(_(e),t):null===t?(P(e),e="en"):St[e]||M(e),n=lt.duration.fn._lang=lt.fn._lang=M(e),n._abbr):lt.fn._lang._abbr},lt.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),M(e)},lt.isMoment=function(e){return e instanceof a||null!=e&&e.hasOwnProperty("_isAMomentObject")},lt.isDuration=function(e){return e instanceof s},ct=rn.length-1;ct>=0;--ct)v(rn[ct]);lt.normalizeUnits=function(e){return g(e)},lt.invalid=function(e){var t=lt.utc(0/0);return null!=e?l(t._pf,e):t._pf.userInvalidated=!0,t},lt.parseZone=function(){return lt.apply(null,arguments).parseZone()},lt.parseTwoDigitYear=function(e){return y(e)+(y(e)>68?1900:2e3)},l(lt.fn=a.prototype,{clone:function(){return lt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=lt(this).utc();return 0<e.year()&&e.year()<=9999?I(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):I(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return D(this)},isDSTShifted:function(){return this._a?this.isValid()&&m(this._a,(this._isUTC?lt.utc(this._a):lt(this._a)).toArray())>0:!1},parsingFlags:function(){return l({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=I(this,e||lt.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?lt.duration(+t,e):lt.duration(e,t),p(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?lt.duration(+t,e):lt.duration(e,t),p(this,n,-1),this},diff:function(e,t,n){var i,r,o=T(e,this),a=6e4*(this.zone()-o.zone());return t=g(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-lt(this).startOf("month")-(o-lt(o).startOf("month")))/i,r-=6e4*(this.zone()-lt(this).startOf("month").zone()-(o.zone()-lt(o).startOf("month").zone()))/i,"year"===t&&(r/=12)):(i=this-o,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-a)/864e5:"week"===t?(i-a)/6048e5:i),n?r:c(r)},from:function(e,t){return lt.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(lt(),e)},calendar:function(){var e=T(lt(),this).startOf("day"),t=this.diff(e,"days",!0),n=-6>t?"sameElse":-1>t?"lastWeek":0>t?"lastDay":1>t?"sameDay":2>t?"nextDay":7>t?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){return k(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=J(e,this.lang()),this.add({d:e-t})):t},month:rt("Month",!0),startOf:function(e){switch(e=g(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=g(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+lt(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+lt(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+T(e,this).startOf(t)},min:function(e){return e=lt.apply(null,arguments),this>e?this:e},max:function(e){return e=lt.apply(null,arguments),e>this?this:e},zone:function(e,t){var n=this._offset||0;return null==e?this._isUTC?n:this._d.getTimezoneOffset():("string"==typeof e&&(e=V(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,n!==e&&(!t||this._changeInProgress?p(this,lt.duration(n-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,lt.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?lt(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return b(this.year(),this.month())},dayOfYear:function(e){var t=ft((lt(this).startOf("day")-lt(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=K(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=K(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=K(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return S(this.year(),1,4)},weeksInYear:function(){var e=this._lang._week;return S(this.year(),e.dow,e.doy)},get:function(e){return e=g(e),this[e]()},set:function(e,t){return e=g(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=M(t),this)}}),lt.fn.millisecond=lt.fn.milliseconds=rt("Milliseconds",!1),lt.fn.second=lt.fn.seconds=rt("Seconds",!1),lt.fn.minute=lt.fn.minutes=rt("Minutes",!1),lt.fn.hour=lt.fn.hours=rt("Hours",!0),lt.fn.date=rt("Date",!0),lt.fn.dates=n("dates accessor is deprecated. Use date instead.",rt("Date",!0)),lt.fn.year=rt("FullYear",!0),lt.fn.years=n("years accessor is deprecated. Use year instead.",rt("FullYear",!0)),lt.fn.days=lt.fn.day,lt.fn.months=lt.fn.month,lt.fn.weeks=lt.fn.week,lt.fn.isoWeeks=lt.fn.isoWeek,lt.fn.quarters=lt.fn.quarter,lt.fn.toJSON=lt.fn.toISOString,l(lt.duration.fn=s.prototype,{_bubble:function(){var e,t,n,i,r=this._milliseconds,o=this._days,a=this._months,s=this._data;s.milliseconds=r%1e3,e=c(r/1e3),s.seconds=e%60,t=c(e/60),s.minutes=t%60,n=c(t/60),s.hours=n%24,o+=c(n/24),s.days=o%30,a+=c(o/30),s.months=a%12,i=c(a/12),s.years=i},weeks:function(){return c(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*y(this._months/12)},humanize:function(e){var t=+this,n=Z(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=lt.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=lt.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=g(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=g(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:lt.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),r=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(i||r||o?"T":"")+(i?i+"H":"")+(r?r+"M":"")+(o?o+"S":""):"P0D"}});for(ct in Xt)Xt.hasOwnProperty(ct)&&(at(ct,Xt[ct]),ot(ct.toLowerCase()));at("Weeks",6048e5),lt.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},lt.lang("en",{ordinal:function(e){var t=e%10,n=1===y(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),kt?module.exports=lt:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(pt.moment=ut),lt}),st(!0)):st()}.call(this),define("helpers/modal-helper",["jquery","bootstrap/modal"],function(e){var t={};return t.gnrtDom=function(t,n,i){var r=document.createElement("div");return e(r).addClass("form-group").append(e("<label></label>").addClass("control-label col-md-3").html(t),e("<div></div>").addClass("col-md-6").append(n),e("<div></div>").addClass("col-md-3").append(e("<span></span>").html(i||"").addClass("help-block"))),r},t.closeModalWindow=function(){e("#modal-standard-block").modal("hide")},t.openModalWindow=function(n,i,r){var o=e("#modal-standard-block");o.find(".modal-body").html(i),o.find("#modal-standard-form").off("submit").on("submit",function(){return r(),!1}),o.find(".modal-close").off("click").on("click",t.closeModalWindow),o.find(".modal-title").html(n),o.modal("show")},t.closeModalWideWindow=function(){e("#modal-wide-block").modal("hide")},t.openModalWideWindow=function(n,i,r){var o=e("#modal-wide-block");o.find(".modal-body").html(n),o.find(".modal-ok").off("click").on("click",function(){return i(),!1}),o.find(".modal-title").html(r),o.find(".modal-close").off("click").on("click",t.closeModalWideWindow),o.modal("show")},t.openModalPanzoomWindow=function(t){var n=e("#modal-panzoom-block");n.find("img").attr("src",t),n.find(".btn-modal-close").off("click").on("click",function(){n.modal("hide")}),n.find(".panzoom-reset").click(),n.modal("show")},t}),function(e){"function"==typeof define&&define.amd?define("jquery.ui.widget",["jquery"],e):e(jQuery)}(function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(o){}r(t)},e.widget=function(t,n,i){var r,o,a,s,l={},u=t.split(".")[0];t=t.split(".")[1],r=u+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[u]=e[u]||{},o=e[u][t],a=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:u,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(n){for(var r,o,a=i.call(arguments,1),s=0,l=a.length;l>s;s++)for(r in a[s])o=a[s][r],a[s].hasOwnProperty(r)&&o!==t&&(n[r]=e.isPlainObject(o)?e.isPlainObject(n[r])?e.widget.extend({},n[r],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,r){var o=r.prototype.widgetFullName||n;e.fn[n]=function(a){var s="string"==typeof a,l=i.call(arguments,1),u=this;return a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,this.each(s?function(){var i,r=e.data(this,o);return r?e.isFunction(r[a])&&"_"!==a.charAt(0)?(i=r[a].apply(r,l),i!==r&&i!==t?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+a+"'")}:function(){var t=e.data(this,o);t?t.option(a||{})._init():e.data(this,o,new r(a,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var r,o,a,s=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(s={},r=n.split("."),n=r.shift(),r.length){for(o=s[n]=e.widget.extend({},this.options[n]),a=0;a<r.length-1;a++)o[r[a]]=o[r[a]]||{},o=o[r[a]];if(n=r.pop(),1===arguments.length)return o[n]===t?null:o[n];o[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];s[n]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,a){function s(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),u=l[1]+o.eventNamespace,c=l[2];c?r.delegate(c,u,s):n.bind(u,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var a,s=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}),function(e){"function"==typeof define&&define.amd?define("jquery.fileupload",["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,n){return t=this.messages[t]||t.toString(),n&&e.each(n,function(e,n){t=t.replace("{"+e+"}",n)}),t},formData:function(e){return e.serializeArray()},add:function(t,n){return t.isDefaultPrevented()?!1:void((n.autoUpload||n.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&n.process().done(function(){n.submit()}))},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var i=e-this.timestamp;return(!this.bitrate||!n||i>n)&&(this.bitrate=(t-this.loaded)*(1e3/i)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_initProgressObject:function(t){var n={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,n):t._progress=n},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,n){if(t.lengthComputable){var i,r=Date.now?Date.now():(new Date).getTime();if(n._time&&n.progressInterval&&r-n._time<n.progressInterval&&t.loaded!==t.total)return;n._time=r,i=Math.floor(t.loaded/t.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0),this._progress.loaded+=i-n._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,n.bitrateInterval),n._progress.loaded=n.loaded=i,n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(r,i,n.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),n),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var n=this,i=t.xhr?t.xhr():e.ajaxSettings.xhr();i.upload&&(e(i.upload).bind("progress",function(e){var i=e.originalEvent;e.lengthComputable=i.lengthComputable,e.loaded=i.loaded,e.total=i.total,n._onProgress(e,t)}),t.xhr=function(){return i})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var n,i=this,r=t.files[0],o=t.multipart||!e.support.xhrFileUpload,a="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),o&&!t.blob&&this._isInstanceOf("File",r)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"'),o?e.support.xhrFormDataFileUpload&&(t.postMessage?(n=this._getFormData(t),t.blob?n.push({name:a,value:t.blob}):e.each(t.files,function(i,r){n.push({name:"array"===e.type(t.paramName)&&t.paramName[i]||a,value:r})})):(i._isInstanceOf("FormData",t.formData)?n=t.formData:(n=new FormData,e.each(this._getFormData(t),function(e,t){n.append(t.name,t.value)})),t.blob?n.append(a,t.blob,r.name):e.each(t.files,function(r,o){(i._isInstanceOf("File",o)||i._isInstanceOf("Blob",o))&&n.append("array"===e.type(t.paramName)&&t.paramName[r]||a,o,o.uploadName||o.name)})),t.data=n):(t.contentType=r.type||"application/octet-stream",t.data=t.blob||r),t.blob=null},_initIframeSettings:function(t){var n=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&n&&n!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var n=e(t.fileInput),i=t.paramName;return i?e.isArray(i)||(i=[i]):(i=[],n.each(function(){for(var t=e(this),n=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(n),r-=1}),i.length||(i=[n.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,i){var r=e.Deferred(),o=r.promise();return n=n||this.options.context||o,t===!0?r.resolveWith(n,i):t===!1&&r.rejectWith(n,i),o.abort=r.promise,this._enhancePromise(o)},_addConvenienceMethods:function(t,n){var i=this,r=function(t){return e.Deferred().resolveWith(i,t).promise()};n.process=function(t,o){return(t||o)&&(n._processQueue=this._processQueue=(this._processQueue||r([this])).pipe(function(){return n.errorThrown?e.Deferred().rejectWith(i,[n]).promise():r(arguments)}).pipe(t,o)),this._processQueue||r([this])},n.submit=function(){return"pending"!==this.state()&&(n.jqXHR=this.jqXHR=i._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&i._onSend(t,this)),this.jqXHR||i._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",i._trigger("fail",null,this),i._getXHRPromise(!1))},n.state=function(){return this.jqXHR?i._getDeferredState(this.jqXHR):this._processQueue?i._getDeferredState(this._processQueue):void 0},n.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===i._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),i=n&&n.length>1&&parseInt(n[1],10);return i&&i+1},_chunkedUpload:function(t,n){t.uploadedBytes=t.uploadedBytes||0;var i,r,o=this,a=t.files[0],s=a.size,l=t.uploadedBytes,u=t.maxChunkSize||s,c=this._blobSlice,d=e.Deferred(),p=d.promise();return this._isXHRUpload(t)&&c&&(l||s>u)&&!t.data?n?!0:l>=s?(a.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",a.error])):(r=function(){var n=e.extend({},t),p=n._progress.loaded;n.blob=c.call(a,l,l+u,a.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+l+"-"+(l+n.chunkSize-1)+"/"+s,o._initXHRData(n),o._initProgressListener(n),i=(o._trigger("chunksend",null,n)!==!1&&e.ajax(n)||o._getXHRPromise(!1,n.context)).done(function(i,a,u){l=o._getUploadedBytes(u)||l+n.chunkSize,p+n.chunkSize-n._progress.loaded&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-n.uploadedBytes,total:l-n.uploadedBytes}),n),t.uploadedBytes=n.uploadedBytes=l,n.result=i,n.textStatus=a,n.jqXHR=u,o._trigger("chunkdone",null,n),o._trigger("chunkalways",null,n),s>l?r():d.resolveWith(n.context,[i,a,u])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,o._trigger("chunkfail",null,n),o._trigger("chunkalways",null,n),d.rejectWith(n.context,[e,t,i])})},this._enhancePromise(p),p.abort=function(){return i.abort()},r(),p):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,n,i,r){var o=r._progress.total,a=r._response;r._progress.loaded<o&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o,total:o}),r),a.result=r.result=t,a.textStatus=r.textStatus=n,a.jqXHR=r.jqXHR=i,this._trigger("done",null,r)
},_onFail:function(e,t,n,i){var r=i._response;i.recalculateProgress&&(this._progress.loaded-=i._progress.loaded,this._progress.total-=i._progress.total),r.jqXHR=i.jqXHR=e,r.textStatus=i.textStatus=t,r.errorThrown=i.errorThrown=n,this._trigger("fail",null,i)},_onAlways:function(e,t,n,i){this._trigger("always",null,i)},_onSend:function(t,n){n.submit||this._addConvenienceMethods(t,n);var i,r,o,a,s=this,l=s._getAJAXSettings(n),u=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,i=i||((r||s._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&s._getXHRPromise(!1,l.context,r)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,n){s._onDone(e,t,n,l)}).fail(function(e,t,n){s._onFail(e,t,n,l)}).always(function(e,t,n){if(s._onAlways(e,t,n,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var i=s._slots.shift();i;){if("pending"===s._getDeferredState(i)){i.resolve();break}i=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),a=o.pipe(u)):(this._sequence=this._sequence.pipe(u,u),a=this._sequence),a.abort=function(){return r=[void 0,"abort","abort"],i?i.abort():(o&&o.rejectWith(l.context,r),u())},this._enhancePromise(a)):u()},_onAdd:function(t,n){var i,r,o,a,s=this,l=!0,u=e.extend({},this.options,n),c=n.files,d=c.length,p=u.limitMultiFileUploads,f=u.limitMultiFileUploadSize,h=u.limitMultiFileUploadSizeOverhead,m=0,g=this._getParamName(u),w=0;if(!f||d&&void 0!==c[0].size||(f=void 0),(u.singleFileUploads||p||f)&&this._isXHRUpload(u))if(u.singleFileUploads||f||!p)if(!u.singleFileUploads&&f)for(o=[],i=[],a=0;d>a;a+=1)m+=c[a].size+h,(a+1===d||m+c[a+1].size+h>f||p&&a+1-w>=p)&&(o.push(c.slice(w,a+1)),r=g.slice(w,a+1),r.length||(r=g),i.push(r),w=a+1,m=0);else i=g;else for(o=[],i=[],a=0;d>a;a+=p)o.push(c.slice(a,a+p)),r=g.slice(a,a+p),r.length||(r=g),i.push(r);else o=[c],i=[g];return n.originalFiles=c,e.each(o||c,function(r,a){var u=e.extend({},n);return u.files=o?a:[a],u.paramName=i[r],s._initResponseObject(u),s._initProgressObject(u),s._addConvenienceMethods(t,u),l=s._trigger("add",e.Event("add",{delegatedEvent:t}),u)}),l},_replaceFileInput:function(t){var n=t.clone(!0);e("<form></form>").append(n)[0].reset(),t.after(n).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,i){return i===t[0]?n[0]:i}),t[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,n){var i,r=this,o=e.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])};return n=n||"",t.isFile?t._file?(t._file.relativePath=n,o.resolve(t._file)):t.file(function(e){e.relativePath=n,o.resolve(e)},a):t.isDirectory?(i=t.createReader(),i.readEntries(function(e){r._handleFileTreeEntries(e,n+t.name+"/").done(function(e){o.resolve(e)}).fail(a)},a)):o.resolve([]),o.promise()},_handleFileTreeEntries:function(t,n){var i=this;return e.when.apply(e,e.map(t,function(e){return i._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n,i,r=t.prop("webkitEntries")||t.prop("entries");if(r&&r.length)return this._handleFileTreeEntries(r);if(n=e.makeArray(t.prop("files")),n.length)void 0===n[0].name&&n[0].fileName&&e.each(n,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(i=t.prop("value"),!i)return e.Deferred().resolve([]).promise();n=[{name:i.replace(/^.*\\/,"")}]}return e.Deferred().resolve(n).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=this,i={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(r){i.files=r,n.options.replaceFileInput&&n._replaceFileInput(i.fileInput),n._trigger("change",e.Event("change",{delegatedEvent:t}),i)!==!1&&n._onAdd(t,i)})},_onPaste:function(t){var n=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,i={files:[]};n&&n.length&&(e.each(n,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&i.files.push(n)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),i)!==!1&&this._onAdd(t,i))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=this,i=t.dataTransfer,r={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){r.files=i,n._trigger("drop",e.Event("drop",{delegatedEvent:t}),r)!==!1&&n._onAdd(t,r)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=t.dataTransfer;n&&-1!==e.inArray("Files",n.types)&&this._trigger("dragover",e.Event("dragover",{delegatedEvent:t}))!==!1&&(t.preventDefault(),n.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,n){var i=-1!==e.inArray(t,this._specialOptions);i&&this._destroyEventHandlers(),this._super(t,n),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),n=t.pop();return t.shift(),new RegExp(t.join("/"),n)},_isRegExpOption:function(t,n){return"url"!==t&&"string"===e.type(n)&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var t=this,n=this.options,i=e(this.element[0].cloneNode(!1));e.each(i.data(),function(e,r){var o="data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();i.attr(o)&&(t._isRegExpOption(e,r)&&(r=t._getRegExp(r)),n[e]=r)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n,i,r=this,o=e.Deferred(),a=o.promise();return a.abort=function(){return i=!0,n?n.abort():(o.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){if(!i){if(!e.length)return void o.reject();t.files=e,n=r._onSend(null,t).then(function(e,t,n){o.resolve(e,t,n)},function(e,t,n){o.reject(e,t,n)})}}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),define("helpers/file-helper",["jquery","jquery.fileupload"],function(){var e={};return e.initRegExpFileUpload=function(e,t,n){e.fileupload({url:t,autoUpload:!1,dataType:"json",xhrFields:{withCredentials:!0},add:function(e,t){n(t)}})},e.downloadURL=function(e){var t="hiddenDownloader",n=document.getElementById(t);null===n&&(n=document.createElement("iframe"),n.id=t,n.style.display="none",document.body.appendChild(n)),n.src=e},e}),function(e){define("jquery.slimscroll",["jquery"],function(){return function(){!function(e){jQuery.fn.extend({slimScroll:function(n){var i={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},r=e.extend(i,n);return this.each(function(){function i(t){if(c){var t=t||window.event,n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3);var i=t.target||t.srcTarget||t.srcElement;e(i).closest("."+r.wrapperClass).is(S.parent())&&o(n,!0),t.preventDefault&&!b&&t.preventDefault(),b||(t.returnValue=!1)}}function o(e,t,n){b=!1;var i=e,o=S.outerHeight()-_.outerHeight();if(t&&(i=parseInt(_.css("top"))+e*parseInt(r.wheelStep)/100*_.outerHeight(),i=Math.min(Math.max(i,0),o),i=e>0?Math.ceil(i):Math.floor(i),_.css({top:i+"px"})),g=parseInt(_.css("top"))/(S.outerHeight()-_.outerHeight()),i=g*(S[0].scrollHeight-S.outerHeight()),n){i=e;var a=i/S[0].scrollHeight*S.outerHeight();a=Math.min(Math.max(a,0),o),_.css({top:a+"px"})}S.scrollTop(i),S.trigger("slimscrolling",~~i),l(),u()}function a(){window.addEventListener?(this.addEventListener("DOMMouseScroll",i,!1),this.addEventListener("mousewheel",i,!1),this.addEventListener("MozMousePixelScroll",i,!1)):document.attachEvent("onmousewheel",i)}function s(){m=Math.max(S.outerHeight()/S[0].scrollHeight*S.outerHeight(),y),_.css({height:m+"px"});var e=m==S.outerHeight()?"none":"block";_.css({display:e})}function l(){if(s(),clearTimeout(f),g==~~g){if(b=r.allowPageScroll,w!=g){var e=0==~~g?"top":"bottom";S.trigger("slimscroll",e)}}else b=!1;return w=g,m>=S.outerHeight()?void(b=!0):(_.stop(!0,!0).fadeIn("fast"),void(r.railVisible&&D.stop(!0,!0).fadeIn("fast")))}function u(){r.alwaysVisible||(f=setTimeout(function(){r.disableFadeOut&&c||d||p||(_.fadeOut("slow"),D.fadeOut("slow"))},1e3))}var c,d,p,f,h,m,g,w,v="<div></div>",y=30,b=!1,S=e(this);if(S.parent().hasClass(r.wrapperClass)){var O=S.scrollTop();if(_=S.parent().find("."+r.barClass),D=S.parent().find("."+r.railClass),s(),e.isPlainObject(n)){if("height"in n&&"auto"==n.height){S.parent().css("height","auto"),S.css("height","auto");var k=S.parent().parent().height();S.parent().css("height",k),S.css("height",k)}if("scrollTo"in n)O=parseInt(r.scrollTo);else if("scrollBy"in n)O+=parseInt(r.scrollBy);else if("destroy"in n)return _.remove(),D.remove(),void S.unwrap();o(O,!1,!0)}}else{r.height="auto"==r.height?S.parent().height():r.height;var W=e(v).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});S.css({overflow:"hidden",width:r.width,height:r.height});var D=e(v).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),_=e(v).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),T="right"==r.position?{right:r.distance}:{left:r.distance};D.css(T),_.css(T),S.wrap(W),S.parent().append(_),S.parent().append(D),r.railDraggable&&_.bind("mousedown",function(n){var i=e(document);return p=!0,t=parseFloat(_.css("top")),pageY=n.pageY,i.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,_.css("top",currTop),o(0,_.position().top,!1)}),i.bind("mouseup.slimscroll",function(){p=!1,u(),i.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),D.hover(function(){l()},function(){u()}),_.hover(function(){d=!0},function(){d=!1}),S.hover(function(){c=!0,l(),u()},function(){c=!1,u()}),S.bind("touchstart",function(e){e.originalEvent.touches.length&&(h=e.originalEvent.touches[0].pageY)}),S.bind("touchmove",function(e){if(b||e.originalEvent.preventDefault(),e.originalEvent.touches.length){var t=(h-e.originalEvent.touches[0].pageY)/r.touchScrollStep;o(t,!0),h=e.originalEvent.touches[0].pageY}}),s(),"bottom"===r.start?(_.css({top:S.outerHeight()-_.outerHeight()}),o(0,!0)):"top"!==r.start&&(o(e(r.start).position().top,null,!0),r.alwaysVisible||_.hide()),a()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery)}.apply(e,arguments)})}(this),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):this.Picker=e(jQuery)}(function(e){function t(i,r,a,s){function l(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",v.component.nodes(f.open),m.box),m.wrap),m.frame),m.holder)}function u(){g.data(r,v).addClass(m.input).val(g.data("value")?v.get("select",h.format):i.value).on("focus."+f.id+" click."+f.id,p),h.editable||g.on("keydown."+f.id,function(e){var t=e.keyCode,n=/^(8|46)$/.test(t);return 27==t?(v.close(),!1):void((32==t||n||!f.open&&v.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?v.clear().close():v.open()))}),n(i,{haspopup:!0,expanded:!1,readonly:!1,owns:i.id+"_root"+(v._hidden?" "+v._hidden.id:"")})}function c(){v.$root.on({focusin:function(e){v.$root.removeClass(m.focused),n(v.$root[0],"selected",!1),e.stopPropagation()},"mousedown click":function(t){var n=t.target;n!=v.$root.children()[0]&&(t.stopPropagation(),"mousedown"!=t.type||e(n).is(":input")||"OPTION"==n.nodeName||(t.preventDefault(),i.focus()))}}).on("click","[data-pick], [data-nav], [data-clear]",function(){var n=e(this),r=n.data(),o=n.hasClass(m.navDisabled)||n.hasClass(m.disabled),a=document.activeElement;a=a&&(a.type||a.href)&&a,(o||a&&!e.contains(v.$root[0],a))&&i.focus(),r.nav&&!o?v.set("highlight",v.component.item.highlight,{nav:r.nav}):t._.isInteger(r.pick)&&!o?v.set("select",r.pick).close(!0):r.clear&&v.clear().close(!0)}),n(v.$root[0],"hidden",!0)}function d(){var t=["string"==typeof h.hiddenPrefix?h.hiddenPrefix:"","string"==typeof h.hiddenSuffix?h.hiddenSuffix:"_submit"];v._hidden=e('<input type=hidden name="'+t[0]+i.name+t[1]+'"id="'+t[0]+i.id+t[1]+'"'+(g.data("value")||i.value?' value="'+v.get("select",h.formatSubmit)+'"':"")+">")[0],g.on("change."+f.id,function(){v._hidden.value=i.value?v.get("select",h.formatSubmit):""}).after(v._hidden)}function p(e){e.stopPropagation(),"focus"==e.type&&(v.$root.addClass(m.focused),n(v.$root[0],"selected",!0)),v.open()}if(!i)return t;var f={id:i.id||"P"+Math.abs(~~(Math.random()*new Date))},h=a?e.extend(!0,{},a.defaults,s):s||{},m=e.extend({},t.klasses(),h.klass),g=e(i),w=function(){return this.start()},v=w.prototype={constructor:w,$node:g,start:function(){return f&&f.start?v:(f.methods={},f.start=!0,f.open=!1,f.type=i.type,i.autofocus=i==document.activeElement,i.type="text",i.readOnly=!h.editable,i.id=i.id||f.id,v.component=new a(v,h),v.$root=e(t._.node("div",l(),m.picker,'id="'+i.id+'_root"')),c(),h.formatSubmit&&d(),u(),h.container?e(h.container).append(v.$root):g.after(v.$root),v.on({start:v.component.onStart,render:v.component.onRender,stop:v.component.onStop,open:v.component.onOpen,close:v.component.onClose,set:v.component.onSet}).on({start:h.onStart,render:h.onRender,stop:h.onStop,open:h.onOpen,close:h.onClose,set:h.onSet}),i.autofocus&&v.open(),v.trigger("start").trigger("render"))},render:function(e){return e?v.$root.html(l()):v.$root.find("."+m.box).html(v.component.nodes(f.open)),v.trigger("render")},stop:function(){return f.start?(v.close(),v._hidden&&v._hidden.parentNode.removeChild(v._hidden),v.$root.remove(),g.removeClass(m.input).removeData(r),setTimeout(function(){g.off("."+f.id)},0),i.type=f.type,i.readOnly=!1,v.trigger("stop"),f.methods={},f.start=!1,v):v},open:function(r){return f.open?v:(g.addClass(m.active),n(i,"expanded",!0),v.$root.addClass(m.opened),n(v.$root[0],"hidden",!1),r!==!1&&(f.open=!0,g.trigger("focus"),o.on("click."+f.id+" focusin."+f.id,function(e){var t=e.target;t!=i&&t!=document&&3!=e.which&&v.close(t===v.$root.children()[0])}).on("keydown."+f.id,function(n){var r=n.keyCode,o=v.component.key[r],a=n.target;27==r?v.close(!0):a!=i||!o&&13!=r?e.contains(v.$root[0],a)&&13==r&&(n.preventDefault(),a.click()):(n.preventDefault(),o?t._.trigger(v.component.key.go,v,[t._.trigger(o)]):v.$root.find("."+m.highlighted).hasClass(m.disabled)||v.set("select",v.component.item.highlight).close())})),v.trigger("open"))},close:function(e){return e&&(g.off("focus."+f.id).trigger("focus"),setTimeout(function(){g.on("focus."+f.id,p)},0)),g.removeClass(m.active),n(i,"expanded",!1),v.$root.removeClass(m.opened+" "+m.focused),n(v.$root[0],"hidden",!0),n(v.$root[0],"selected",!1),f.open?(f.open=!1,o.off("."+f.id),v.trigger("close")):v},clear:function(){return v.set("clear")},set:function(t,n,i){var r,o,a=e.isPlainObject(t),s=a?t:{};if(i=a&&e.isPlainObject(n)?n:i||{},t){a||(s[t]=n);for(r in s)o=s[r],r in v.component.item&&v.component.set(r,o,i),("select"==r||"clear"==r)&&g.val("clear"==r?"":v.get(r,h.format)).trigger("change");v.render()}return i.muted?v:v.trigger("set",s)},get:function(e,n){return e=e||"value",null!=f[e]?f[e]:"value"==e?i.value:e in v.component.item?"string"==typeof n?t._.trigger(v.component.formats.toString,v.component,[n,v.component.get(e)]):v.component.get(e):void 0},on:function(t,n){var i,r,o=e.isPlainObject(t),a=o?t:{};if(t){o||(a[t]=n);for(i in a)r=a[i],f.methods[i]=f.methods[i]||[],f.methods[i].push(r)}return v},off:function(){var e,t,n=arguments;for(e=0,namesCount=n.length;namesCount>e;e+=1)t=n[e],t in f.methods&&delete f.methods[t];return v},trigger:function(e,n){var i=f.methods[e];return i&&i.map(function(e){t._.trigger(e,v,[n])}),v}};return new w}function n(t,n,r){if(e.isPlainObject(n))for(var o in n)i(t,o,n[o]);else i(t,n,r)}function i(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function r(t,n){e.isPlainObject(t)||(t={attribute:n}),n="";for(var i in t){var r=("role"==i?"":"aria-")+i,o=t[i];n+=null==o?"":r+'="'+t[i]+'"'}return n}var o=e(document);return t.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},t._={group:function(e){for(var n,i="",r=t._.trigger(e.min,e);r<=t._.trigger(e.max,e,[r]);r+=e.i)n=t._.trigger(e.item,e,[r]),i+=t._.node(e.node,n[0],n[1],n[2]);return i},node:function(t,n,i,r){return n?(n=e.isArray(n)?n.join(""):n,i=i?' class="'+i+'"':"",r=r?" "+r:"","<"+t+i+r+">"+n+"</"+t+">"):""},lead:function(e){return(10>e?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1===0},ariaAttr:r},t.extend=function(n,i){e.fn[n]=function(r,o){var a=this.data(n);return"picker"==r?a:a&&"string"==typeof r?(t._.trigger(a[r],a,[o]),this):this.each(function(){var o=e(this);o.data(n)||new t(this,n,i,r)})},e.fn[n].defaults=i.defaults},t}),function(e){"function"==typeof define&&define.amd?define("picker.date",["picker","jquery"],e):e(Picker,jQuery)}(function(e,t){function n(e,t){var n=this,i=e.$node[0].value,r=e.$node.data("value"),o=r||i,a=r?t.formatSubmit:t.format,s=function(){return"rtl"===getComputedStyle(e.$root[0]).direction};n.settings=t,n.$node=e.$node,n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},n.item={},n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return e[0]===!0?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now"),o?n.set("select",o,{format:a,fromValue:!!i}):n.set("select",null).set("highlight",n.item.now),n.key={40:7,38:-7,39:function(){return s()?-1:1},37:function(){return s()?1:-1},go:function(e){var t=n.item.highlight,i=new Date(t.year,t.month,t.date+e);n.set("highlight",[i.getFullYear(),i.getMonth(),i.getDate()],{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){var n=this.value;n&&(e.set("highlight",[e.get("view").year,n,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus"))}),e.$root.find("."+t.klass.selectYear).on("change",function(){var n=this.value;n&&(e.set("highlight",[n,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus"))})}).on("open",function(){e.$root.find("button, select").attr("disabled",!1)}).on("close",function(){e.$root.find("button, select").attr("disabled",!0)})}var i=7,r=6,o=e._;n.prototype.set=function(e,t,n){var i=this,r=i.item;return null===t?(r[e]=t,i):(r["enable"==e?"disable":"flip"==e?"enable":e]=i.queue[e].split(" ").map(function(r){return t=i[r](e,t,n)}).pop(),"select"==e?i.set("highlight",r.select,n):"highlight"==e?i.set("view",r.highlight,n):e.match(/^(flip|min|max|disable|enable)$/)&&(r.select&&i.disabled(r.select)&&i.set("select",r.select,n),r.highlight&&i.disabled(r.highlight)&&i.set("highlight",r.highlight,n)),i)},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,n,i){var r,a=this;return n=void 0===n?e:n,n==-1/0||1/0==n?r=n:t.isPlainObject(n)&&o.isInteger(n.pick)?n=n.obj:t.isArray(n)?(n=new Date(n[0],n[1],n[2]),n=o.isDate(n)?n:a.create().obj):n=o.isInteger(n)||o.isDate(n)?a.normalize(new Date(n),i):a.now(e,n,i),{year:r||n.getFullYear(),month:r||n.getMonth(),date:r||n.getDate(),day:r||n.getDay(),obj:r||n,pick:r||n.getTime()}},n.prototype.createRange=function(e,n){var i=this,r=function(e){return e===!0||t.isArray(e)||o.isDate(e)?i.create(e):e};return o.isInteger(e)||(e=r(e)),o.isInteger(n)||(n=r(n)),o.isInteger(e)&&t.isPlainObject(n)?e=[n.year,n.month,n.date+e]:o.isInteger(n)&&t.isPlainObject(e)&&(n=[e.year,e.month,e.date+n]),{from:r(e),to:r(n)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t,n){return t=new Date,n&&n.rel&&t.setDate(t.getDate()+n.rel),this.normalize(t,n)},n.prototype.navigate=function(e,n,i){var r,o,a,s,l=t.isArray(n),u=t.isPlainObject(n),c=this.item.view;if(l||u){for(u?(o=n.year,a=n.month,s=n.date):(o=+n[0],a=+n[1],s=+n[2]),i&&i.nav&&c&&c.month!==a&&(o=c.year,a=c.month),r=new Date(o,a+(i&&i.nav?i.nav:0),1),o=r.getFullYear(),a=r.getMonth();new Date(o,a,s).getMonth()!==a;)s-=1;n=[o,a,s]}return n},n.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},n.prototype.measure=function(e,t){var n=this;return t?o.isInteger(t)&&(t=n.now(e,t,{rel:t})):t="min"==e?-1/0:1/0,t},n.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},n.prototype.validate=function(e,n,i){var r,a,s,l,u=this,c=n,d=i&&i.interval?i.interval:1,p=-1===u.item.enable,f=u.item.min,h=u.item.max,m=p&&u.item.disable.filter(function(e){if(t.isArray(e)){var i=u.create(e).pick;i<n.pick?r=!0:i>n.pick&&(a=!0)}return o.isInteger(e)}).length;if((!i||!i.nav)&&(!p&&u.disabled(n)||p&&u.disabled(n)&&(m||r||a)||!p&&(n.pick<=f.pick||n.pick>=h.pick)))for(p&&!m&&(!a&&d>0||!r&&0>d)&&(d*=-1);u.disabled(n)&&(Math.abs(d)>1&&(n.month<c.month||n.month>c.month)&&(n=c,d=d>0?1:-1),n.pick<=f.pick?(s=!0,d=1,n=u.create([f.year,f.month,f.date-1])):n.pick>=h.pick&&(l=!0,d=-1,n=u.create([h.year,h.month,h.date+1])),!s||!l);)n=u.create([n.year,n.month,n.date+d]);return n},n.prototype.disabled=function(e){var n=this,i=n.item.disable.filter(function(i){return o.isInteger(i)?e.day===(n.settings.firstDay?i:i-1)%7:t.isArray(i)||o.isDate(i)?e.pick===n.create(i).pick:t.isPlainObject(i)?n.withinRange(i,e):void 0});return i=i.length&&!i.filter(function(e){return t.isArray(e)&&"inverted"==e[3]||t.isPlainObject(e)&&e.inverted}).length,-1===n.item.enable?!i:i||e.pick<n.item.min.pick||e.pick>n.item.max.pick},n.prototype.parse=function(e,n,i){var r,a=this,s={};return!n||o.isInteger(n)||t.isArray(n)||o.isDate(n)||t.isPlainObject(n)&&o.isInteger(n.pick)?n:(i&&i.format||(i=i||{},i.format=a.settings.format),r="string"!=typeof n||i.fromValue?0:1,a.formats.toArray(i.format).map(function(e){var t=a.formats[e],i=t?o.trigger(t,a,[n,s]):e.replace(/^!/,"").length;t&&(s[e]=n.substr(0,i)),n=n.substr(i)}),[s.yyyy||s.yy,+(s.mm||s.m)-r,s.dd||s.d])},n.prototype.formats=function(){function e(e,t,n){var i=e.match(/\w+/)[0];return n.mm||n.m||(n.m=t.indexOf(i)),i.length}function t(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?o.digits(e):t.date},dd:function(e,t){return e?2:o.lead(t.date)},ddd:function(e,n){return e?t(e):this.settings.weekdaysShort[n.day]},dddd:function(e,n){return e?t(e):this.settings.weekdaysFull[n.day]},m:function(e,t){return e?o.digits(e):t.month+1},mm:function(e,t){return e?2:o.lead(t.month+1)},mmm:function(t,n){var i=this.settings.monthsShort;return t?e(t,i,n):i[n.month]},mmmm:function(t,n){var i=this.settings.monthsFull;return t?e(t,i,n):i[n.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return o.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}}}(),n.prototype.isDateExact=function(e,n){var i=this;return o.isInteger(e)&&o.isInteger(n)||"boolean"==typeof e&&"boolean"==typeof n?e===n:(o.isDate(e)||t.isArray(e))&&(o.isDate(n)||t.isArray(n))?i.create(e).pick===i.create(n).pick:t.isPlainObject(e)&&t.isPlainObject(n)?i.isDateExact(e.from,n.from)&&i.isDateExact(e.to,n.to):!1},n.prototype.isDateOverlap=function(e,n){var i=this;return o.isInteger(e)&&(o.isDate(n)||t.isArray(n))?e===i.create(n).day+1:o.isInteger(n)&&(o.isDate(e)||t.isArray(e))?n===i.create(e).day+1:t.isPlainObject(e)&&t.isPlainObject(n)?i.overlapRanges(e,n):!1},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,n){var i=this,r=i.item.disable.slice(0);return"flip"==n?i.flipEnable():n===!1?(i.flipEnable(1),r=[]):n===!0?(i.flipEnable(-1),r=[]):n.map(function(e){for(var n,a=0;a<r.length;a+=1)if(i.isDateExact(e,r[a])){n=!0;break}n||(o.isInteger(e)||o.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&r.push(e)}),r},n.prototype.activate=function(e,n){var i=this,r=i.item.disable,a=r.length;return"flip"==n?i.flipEnable():n===!0?(i.flipEnable(1),r=[]):n===!1?(i.flipEnable(-1),r=[]):n.map(function(e){var n,s,l,u;for(l=0;a>l;l+=1){if(s=r[l],i.isDateExact(s,e)){n=r[l]=null,u=!0;break}if(i.isDateOverlap(s,e)){t.isPlainObject(e)?(e.inverted=!0,n=e):t.isArray(e)?(n=e,n[3]||n.push("inverted")):o.isDate(e)&&(n=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(n)for(l=0;a>l;l+=1)if(i.isDateExact(r[l],e)){r[l]=null;break}if(u)for(l=0;a>l;l+=1)if(i.isDateOverlap(r[l],e)){r[l]=null;break}n&&r.push(n)}),r.filter(function(e){return null!=e})},n.prototype.nodes=function(e){var t=this,n=t.settings,a=t.item,s=a.now,l=a.select,u=a.highlight,c=a.view,d=a.disable,p=a.min,f=a.max,h=function(e){return n.firstDay&&e.push(e.shift()),o.node("thead",o.node("tr",o.group({min:0,max:i-1,i:1,node:"th",item:function(t){return[e[t],n.klass.weekdays]}})))}((n.showWeekdaysFull?n.weekdaysFull:n.weekdaysShort).slice(0)),m=function(e){return o.node("div"," ",n.klass["nav"+(e?"Next":"Prev")]+(e&&c.year>=f.year&&c.month>=f.month||!e&&c.year<=p.year&&c.month<=p.month?" "+n.klass.navDisabled:""),"data-nav="+(e||-1))},g=function(t){return n.selectMonths?o.node("select",o.group({min:0,max:11,i:1,node:"option",item:function(e){return[t[e],0,"value="+e+(c.month==e?" selected":"")+(c.year==p.year&&e<p.month||c.year==f.year&&e>f.month?" disabled":"")]}}),n.klass.selectMonth,e?"":"disabled"):o.node("div",t[c.month],n.klass.month)},w=function(){var t=c.year,i=n.selectYears===!0?5:~~(n.selectYears/2);if(i){var r=p.year,a=f.year,s=t-i,l=t+i;if(r>s&&(l+=r-s,s=r),l>a){var u=s-r,d=l-a;s-=u>d?d:u,l=a}return o.node("select",o.group({min:s,max:l,i:1,node:"option",item:function(e){return[e,0,"value="+e+(t==e?" selected":"")]}}),n.klass.selectYear,e?"":"disabled")}return o.node("div",t,n.klass.year)};return o.node("div",m()+m(1)+g(n.showMonthsShort?n.monthsShort:n.monthsFull)+w(),n.klass.header)+o.node("table",h+o.node("tbody",o.group({min:0,max:r-1,i:1,node:"tr",item:function(e){var r=n.firstDay&&0===t.create([c.year,c.month,1]).day?-7:0;return[o.group({min:i*e-c.day+r+1,max:function(){return this.min+i-1},i:1,node:"td",item:function(e){e=t.create([c.year,c.month,e+(n.firstDay?1:0)]);var i=l&&l.pick==e.pick,r=u&&u.pick==e.pick,a=d&&t.disabled(e)||e.pick<p.pick||e.pick>f.pick;return[o.node("div",e.date,function(t){return t.push(c.month==e.month?n.klass.infocus:n.klass.outfocus),s.pick==e.pick&&t.push(n.klass.now),i&&t.push(n.klass.selected),r&&t.push(n.klass.highlighted),a&&t.push(n.klass.disabled),t.join(" ")}([n.klass.day]),"data-pick="+e.pick+" "+o.ariaAttr({role:"button",controls:t.$node[0].id,checked:i&&t.$node.val()===o.trigger(t.formats.toString,t,[n.format,e])?!0:null,activedescendant:r?!0:null,disabled:a?!0:null}))]}})]}})),n.klass.table)+o.node("div",o.node("button",n.today,n.klass.buttonToday,"type=button data-pick="+s.pick+(e?"":" disabled"))+o.node("button",n.clear,n.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")),n.klass.footer)},n.defaults=function(e){return{monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today"}}}(e.klasses().picker+"__"),e.extend("pickadate",n)}),define("bindings/all-bindings",["require","exports","module","jquery","knockout","moment","helpers/modal-helper","helpers/file-helper","jquery.slimscroll","bootstrap/modal","bootstrap/dropdown","picker.date"],function(e){function t(t,n,i,a,s){var l,u=0,c=0,d=0,p=0,f=!1,h=t.getContext("2d");h.strokeStyle="#000",h.lineWidth=.5,r(t).on("mousedown",function(e){u=e.pageX-r(this).offset().left,c=e.pageY-r(this).offset().top,l="tool-arrow"===o.unwrap(a),f=!0}).on("mouseup",function(o){f===!0&&(d=o.pageX-r(this).offset().left,p=o.pageY-r(this).offset().top,h.clearRect(0,0,t.width,t.height),f=!1,e(["models/svg-elem","constants/svg-elem-type-constants"],function(t,o){var a=Math.abs(r(s).position().top);console.log(a);var f=new t({Color:"#000",Tpe:o.line.id,Opts:JSON.stringify({StartX:u,StartY:c+a,LastX:d,LastY:p+a,IsArrow:l})});i.push(f),console.log(i),e(["helpers/log-helper"],function(e){e.drawLineCntx(n,u,c,d,p,l)})}))}).on("mouseleave",function(){f===!0&&(h.clearRect(0,0,t.width,t.height),f=!1)}).on("mousemove",function(n){f===!0&&(d=n.pageX-r(this).offset().left,p=n.pageY-r(this).offset().top,h.clearRect(0,0,t.width,t.height),e(["helpers/log-helper"],function(e){e.drawLineCntx(h,u,c,d,p,l)
}))})}function n(t,n,i,o){r(t).off("click").on("click",function(a){var s=parseFloat(a.pageX-r(t).offset().left),l=parseFloat(a.pageY-r(t).offset().top);e(["helpers/log-helper"],function(a){var u=document.createElement("span");r(u).addClass("log-las-text-creator log-las-podl").css({top:l-9,left:s}).html("enter text...");var c=document.createElement("span");r(c).prop({contenteditable:!0}).addClass("log-las-text-creator").css({top:l-9,left:s}).on("keypress",function(t){var d=t.keyCode||t.which;if(13===d){t.preventDefault();var p=r(c).html();r(u).remove(),r(c).remove(),e(["models/svg-elem","constants/svg-elem-type-constants"],function(e,t){var u=Math.abs(r(o).position().top),c=new e({Color:"#000",Tpe:t.text.id,Opts:JSON.stringify({StartX:s,StartY:l+u,TextContent:p})});console.log(c),i.push(c),a.drawTextCntx(n,p,s,l)})}}).on("keyup",function(e){var t=r(c).html();0===t.length?r(u).show():r(u).hide();var n=e.keyCode||e.which;27===n&&(r(u).remove(),r(c).remove())}).on("focusout",function(){r(u).remove(),r(c).remove()}),r(t).append(u,c),r(c).focus()})})}function i(t,n,i){var r=Math.abs(i.position().top);e(["helpers/log-helper"],function(e){n.forEach(function(n){var i=o.unwrap(n.opts);switch(n.tpe){case"line":e.drawLineCntx(t,i.StartX,i.StartY-r,i.LastX,i.LastY-r,i.IsArrow);break;case"text":e.drawTextCntx(t,i.TextContent,i.StartX,i.StartY-r);break;default:throw new Error("NoSuchTypeForLogFigure")}})})}var r=e("jquery"),o=e("knockout"),a=e("moment"),s=e("helpers/modal-helper"),l=e("helpers/file-helper");e("jquery.slimscroll"),e("bootstrap/modal"),e("bootstrap/dropdown"),e("picker.date"),o.bindingHandlers.hidden={update:function(e,t){o.bindingHandlers.visible.update(e,function(){return!o.unwrap(t())})}},o.bindingHandlers.slideVisible={init:function(e,t){var n=o.unwrap(t()),i=r(e);n?i.show():i.hide()},update:function(e,t,n){var i=o.unwrap(t()),a=r(e),s=n(),l=s.duration||500,u="none"!==e.style.display;i&&!u?a.show(l):!i&&u&&a.hide(l)}},o.bindingHandlers.slideHidden={init:function(e,t){o.bindingHandlers.slideVisible.init(e,function(){return!o.unwrap(t())})},update:function(e,t,n){o.bindingHandlers.slideVisible.update(e,function(){return!o.unwrap(t())},n)}},o.bindingHandlers.selected={init:function(e,t){r(e).blur(function(){var e=t();o.isWriteableObservable(e)&&e(!1)})},update:function(e,t){var n=o.utils.unwrapObservable(t());n&&r(e).select()}},o.bindingHandlers.placeholder={init:function(e,t){var n=o.utils.unwrapObservable(t()),i=r(e);i.attr("placeholder",n)}},o.bindingHandlers.date={update:function(e,t){o.unwrap(t())&&(e.innerHTML=a(new Date(o.unwrap(t()))).format("YYYY-MM-DD"))}},o.bindingHandlers.unix={update:function(e,t){o.unwrap(t())&&(e.innerHTML=a(1e3*o.unwrap(t())).format("YYYY-MM-DD"))}},o.bindingHandlers.unixTime={update:function(e,t){o.unwrap(t())&&(e.innerHTML=a(1e3*o.unwrap(t())).format("YYYY-MM-DD HH:mm:ss"))}},o.bindingHandlers.prec={update:function(e,t){var n=t(),i=o.unwrap(n.value);if(r.isNumeric(i)===!1)return void(e.innerHTML="");var a=o.unwrap(n.coef);if(a&&(i*=a),0===i)e.innerHTML=0;else if(1>i){for(var s=0;1>i;)s-=1,i*=10;e.innerHTML=String(Math.round(100*i)/100)+"x10<sup>"+s+"</sup>"}else e.innerHTML=String(Math.round(100*i)/100)}},o.bindingHandlers.scroller={init:function(e){function t(){var t=n.height(),i=n.width();if(r.isNumeric(t)){t=+t,i=+i;var o,a,s=992,l=32,u=50,c=210;i>=s?(o=t-l-u,a=c):(o="auto",a=i),r(e).parent().height(o),r(e).height(o),r(e).parent().width(a),r(e).width(a)}}r(e).slimScroll({railVisible:!0,alwaysVisible:!0,color:"#fcfcfc",position:"right",allowPageScroll:!0});var n=r(window);n.resize(t),t()}},o.bindingHandlers.datepicker={init:function(e,t,n){var i=t();if(o.isObservable(i)){var a=n.get("datepickerOptions")||{},s=r(e).pickadate(a),l=s.pickadate("picker"),u=o.unwrap(i);if(u){u=1e3*u;var c=60*new Date(u).getTimezoneOffset()*1e3;u-=c,l.set("select",u)}l.on({set:function(e){if(e.hasOwnProperty("select")){var t=e.select;if(t){var n=60*new Date(t).getTimezoneOffset();i(t/1e3-n)}}else e.hasOwnProperty("clear")&&i(null)},close:function(){s.blur()}})}},update:function(e,t){var n=t();if(o.isObservable(n)){var i=o.unwrap(n);if(!i){var a=r(e).pickadate("picker");a.set("clear")}}}},o.bindingHandlers.drpdwn={init:function(e){r(e).dropdown()}},o.bindingHandlers.logLas={init:function(e,a){var s=e.getElementsByClassName("log-las-draw")[0];if(!s)throw new Error("no element");var l=e.getElementsByClassName("log-las-base")[0];if(!l)throw new Error("no element");var u=e.getElementsByClassName("log-las-text")[0];if(!u)throw new Error("no element");var c=e.getElementsByClassName("log-las-img")[0];if(!c)throw new Error("no element");var d=a();c.onload=function(){var e=l.getContext("2d");e.clearRect(0,0,l.width,l.height);var a=480,p=r(c);p.parent().off("scroll").on("scroll",function(){e.clearRect(0,0,l.width,l.height),i(e,o.unwrap(d.imgFigures),p)});var f=c.clientHeight;f>a&&(f=a),l.height=f,s.height=f,r(u).css({height:f}),i(e,o.unwrap(d.imgFigures),p),t(s,e,d.imgFigures,d.checkedLogTool,c),n(u,e,d.imgFigures,c)},c.src=d.imgSrc},update:function(e,t){var n=e.getElementsByClassName("log-las-draw")[0];if(!n)throw new Error("no element");var i=e.getElementsByClassName("log-las-base")[0];if(!i)throw new Error("no element");var a=e.getElementsByClassName("log-las-text")[0];if(!a)throw new Error("no element");var s=e.getElementsByClassName("log-las-img")[0];if(!s)throw new Error("no element");var l=t(),u=o.unwrap(l.checkedLogTool);r(n).hide(),r(a).hide();var c=r(i).css("top");switch(u){case"tool-line":r(n).css({top:c}).show();break;case"tool-arrow":r(n).css({top:c}).show();break;case"tool-text":r(a).css({top:c}).show()}}},o.bindingHandlers.panzoomImg={init:function(e,t){var n=o.unwrap(t().src);r(e).on("click",function(e){e.preventDefault(),s.openModalPanzoomWindow(n)})}},o.bindingHandlers.filoader={init:function(e,t){var n=t();l.initRegExpFileUpload(r(e),n.url,n.addCallback)}},o.bindingHandlers.modalWindow={init:function(e,t){var n=t();r(e).on("hidden.bs.modal",function(){n.fileMgrHiddenCallback()})},update:function(e,t){var n=t();r(e).modal(o.unwrap(n.isOpenFileMgr)?"show":"hide")}}}),define("helpers/map-helper",["d3"],function(e){function t(t,n){var i={},r=e.behavior.drag().on("dragstart",function(){e.event.sourceEvent.stopPropagation();var t=e.select(this).select(function(){return this.parentNode}).select("image"),n={left:+t.attr("x"),right:+t.attr("x")+ +t.attr("width"),top:+t.attr("y"),bottom:+t.attr("y")+ +t.attr("height")};i=n}).on("drag",function(){var n=Math.max(Math.min(e.event.x,i.right-t),i.left+t),r=Math.max(Math.min(e.event.y,i.bottom-t),i.top+t);e.select(this).attr("cx",n).attr("cy",r)}).on("dragend",function(){var t=e.select(this);n(+t.attr("cx")-i.left,+t.attr("cy")-i.top)});return r}var n={};return n.drawWellMarker=function(n,i,r,o,a,s){o.append("circle").attr("cx",n).attr("cy",i).attr("r",a).attr("class",r).on("click",function(){e.event.defaultPrevented}).call(t(a,s))},n}),define("helpers/app-helper",["require","exports","module"],function(e,t,n){t.toInt=function(e){return parseInt(e)},t.toFloatDec=function(e,n){return t.toInt(e*Math.pow(10,n))/Math.pow(10,n)},t.isNumeric=function(e){return e-parseFloat(e)>=0},t.isFunction=function(e){return"function"==typeof e},t.twoDimArrayToString=function(e){for(var t=0,n=e.length;n>t;t+=1)e[t]instanceof Array&&(e[t]=e[t].join(","));return e.join(" ")},t.stringToTwoDimArray=function(e){function t(e){return e.map(function(e){return+e})}for(var n=e.split(" "),i=[],r=0,o=n.length;o>r;r+=1)i.push(t(n[r].split(",")));return i},t.getArea=function(e){var t=e.length;if(3>t)return 0;e.push([e[0][0],e[0][1]]);for(var n=0,i=0;t>i;i+=1)n+=e[i][0]*e[i+1][1]-e[i][1]*e[i+1][0];return Math.abs(n/2)},t.getYearList=function(e,t){for(var n=[],i=e;t>=i;i+=1)n.unshift(i);return n},t.getElementByPropertyValue=function(e,t,n){var i=null;return t&&e.forEach(function(e){e[t]===n&&(i=e)}),i},t.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e},n.exports=t}),define("helpers/svg-pie-helper",["require","exports","module","d3"],function(e,t,n){var i=e("d3");t.drawPie=function(e,t){var n=120,r=120,o=Math.min(n,r)/2,a=t.map(function(e){return e.color}),s=i.scale.ordinal().range(a),l=i.svg.arc().outerRadius(o-10).innerRadius(0),u=i.layout.pie().sort(null).value(function(e){return e.val}),c=i.select(e).append("svg").attr("viewBox","0, 0, "+n+", "+r).append("g").attr("transform","translate("+n/2+","+r/2+")");t.forEach(function(e){e.val=+e.val});var d=c.selectAll(".arc").data(u(t)).enter().append("g").attr("class","arc");d.append("path").attr("d",l).style("fill",function(e){return s(e.data.lbl)}),d.append("text").attr("transform",function(e){return"translate("+l.centroid(e)+")"}).attr("dy",".35em").style("text-anchor","middle").attr("class","pie-text").text(function(e){return e.data.lbl})},n.exports=t}),define("bindings/svg-bindings",["require","exports","module","jquery","knockout","d3","helpers/map-helper","helpers/app-helper","helpers/svg-pie-helper"],function(e){function t(e,t){e.append("path").attr("class","svg-graph-path").attr("stroke",t.prmStroke).attr("d",t.prmPath).attr("visible",t.prmVisible).style("visibility",t.prmVisible?"visible":"hidden")}function n(e,t){e.koSvgWidth(i(t).parent().width())}var i=e("jquery"),r=e("knockout"),o=e("d3"),a=e("helpers/map-helper"),s=e("helpers/app-helper"),l=e("helpers/svg-pie-helper");r.bindingHandlers.graphAxis={update:function(e,t){var n=r.unwrap(t());n&&o.select(e).call(n)}},r.bindingHandlers.graphPaths={update:function(e,n){var i=r.unwrap(n());if(i){var a=o.select(e);a.text(""),i.forEach(t.bind(null,a))}}},r.bindingHandlers.svgZoomBehavior={init:function(e,t){console.log("svgZoomBehavior bindind has executed");var n=r.unwrap(t());n&&o.select(e).call(n)}},r.bindingHandlers.mapBinding={init:function(e,t){var n=t();o.select(e).append("image").attr("xlink:href",n.imgUrl).attr("width",n.imgWidthVg).attr("height",n.imgHeightVg)},update:function(e,t){var n=t(),i=r.unwrap(n.idOfSlcMapTool),l=n.vwmWellMarkerToAdd,u=n.imgWidthPx,c=n.imgHeightPx,d=n.imgWidthVg,p=n.imgHeightVg,f=n.widthCoefVgToPx,h=n.heightCoefVgToPx,m=r.unwrap(n.listOfVwmWellMarker),g=r.unwrap(n.wellMarkerRadius),w=o.select(e),v=w.select("image");if(v.on("click",function(){if(console.log(i),"marker"!==i)return void console.log("no marker");var e=o.mouse(this),t={x:e[0]*(u/d),y:e[1]*(c/p)};console.log("realMarkerPos",t),l.coords([s.toFloatDec(t.x,1),s.toFloatDec(t.y,1)])}),w.selectAll("circle").remove(),m.forEach(function(e){var t=r.unwrap(e.mdlWellMarker.coords);a.drawWellMarker(t[0]*f,t[1]*h,r.unwrap(e.isSlc)?"well-marker_selected":r.unwrap(e.mdlWellMarker.markerStyle),w,g,function(t,n){e.mdlWellMarker.coords([s.toFloatDec(t/f,1),s.toFloatDec(n/h,1)])})}),r.unwrap(l.coords)){console.log("wellmarkertoadd",l);var y=r.unwrap(l.coords);a.drawWellMarker(y[0]*f,y[1]*h,l.markerStyle,w,g,function(e,t){l.coords([s.toFloatDec(e/f,1),s.toFloatDec(t/h,1)])})}}},r.bindingHandlers.svgResponsive={init:function(e,t){var r=t();i(window).resize(n.bind(null,r,e)),r.tmpIsVisibleMenu.subscribe(n.bind(null,r,e)),n(r,e)}},r.bindingHandlers.svgPie={update:function(e,t){var n=t(),o=r.unwrap(n.pieData),a=document.createElement("div");l.drawPie(a,o),e.appendChild(a);var s=i(a).width();i(a).height(s)}}}),define("helpers/knockout-lazy",["knockout"],function(e){function t(t,n,i){var r=e.computed({read:function(){return r.loaded()||t.call(i),n()},write:function(e){r.loaded(!0),n(e)},deferEvaluation:!0});return r.loaded=e.observable(),r.refresh=function(){r.loaded(!1)},r}e.lazyObservable=function(n,i){var r=e.observable();return t(n,r,i)},e.lazyObservableArray=function(n,i){var r=e.observableArray(),o=t(n,r,i);return e.utils.arrayForEach(["remove","removeAll","destroy","destroyAll","indexOf","replace","pop","push","reverse","shift","sort","splice","unshift","slice"],function(e){o[e]=function(){r[e].apply(r,arguments)}}),o}}),define("helpers/lang-helper",[],function(){var e={wfm:"WFM",wellfilemanager:"well file manager",name:"name",description:"description",email:"email",password:"password",passwordconfirmation:"password confirmation",passwordconfirmationandpasswordarenotequal:"password confirmation and password are not equal",steps:"steps",required:"required",cancel:"cancel",tocancel:"cancel",saved:"saved",saving:"saving",tosave:"save",toadd:"add",adding:"add",viewing:"view",toview:"view",editing:"edit",toedit:"edit",deletion:"deletion",todelete:"delete",selection:"selection",toselect:"select",using:"use",touse:"use",registration:"registration",toregister:"register",loading:"loading",toload:"load",rememberme:"remember me",remembermeinthisbrowser:"remember me in this browser",error:"error",unknownerror:"unknown error",wrongcredentials:"incorrect email or password",emailisnotconfirmed:"email is not confirmed",confirmationtoken:"confirmation token",emailconfirmation:"email confirmation",emailisalreadytaken:"email is already taken",emailconfirmationfailedtosend:"confirmation email failed to send. Please try register again later.",validationerrors:"validation errors",wrongemailformat:"wrong email format",emailconfirmationisunsuccessful:"email confirmation is unsuccessful",checktoconfirmationtoken:"registration step 2: please check your email to get confirmation code.",confirmregistrationsuccessful:"email confirmation is successful. Please login to enter to your cabinet.",success:"success",signin:"sign in",logout:"log out",companylist:"companies",companyname:"company name",companydescription:"company description",companyinfo:"company info",companyusers:"company users",toregisteracompany:"register a company",logo:"logo",minlength:"min length",maxlength:"max length",admin:"admin",or:"or",test:"test",demo:"demo",demowfmcaution:"please don&#x27;t load secret or important data. All loaded data can be removed at any time.",termsandconditions:"terms and conditions",usercannotregisterfewcompanies:"user can not register few companies",pagenotfound:"page not found",aboutwfm:"about",contacts:"contacts",pricing:"pricing",home:"home",workspace:"workspace",processing:"processing",toaddwidget:"add widget",productionhistory:"production history",summary:"summary",sketch:"sketch",settings:"settings",layout:"layout",todeletelayout:"delete layout",tocreatelayout:"create new layout",confirmtodelete:"are you sure you want to delete",development:"development",documentation:"documentation",attachfile:"attach a file",cropimage:"crop an image",tocreaterecord:"create new record",filterbydate:"filter by date",filterbyjobtype:"filter by job type",sortbydate:"sort by date",nowellhistorylist:"no well history",jobtype:"job type",timeperiod:"period",toaddjobtypetolist:"add job type to list",underconstruction:"under construction",todeletewell:"delete well",todeleteregion:"delete region",todeletefield:"delete field",todeletegroup:"delete group",todeletecompany:"delete company",well:"well",dashboard:"dashboard",group:"group",region:"region",field:"field",filemanager:"file manager",volume:"volume",date:"date",hour:"hour",hours:"hours",minute:"minute",minutes:"minutes",second:"second",seconds:"seconds",tocreatetest:"create new test",approve:"approve",decline:"decline",valid:"valid",invalid:"invalid",comment:"comment",toaddhour:"add hour",total:"total",volumeofwellalreadyexists:"Volume with this file is already exists",filespecofhistoryofwellalreadyexists:"This file is already attached to this well history",nodalanalysisofwellalreadyexists:"Nodal analysis with this file is already exists",integrityofwellalreadyexists:"Integrity with this file is already exists",toselectmapofwield:"select map",createmapofwieldfromfile:"add map",noselectedmapofwield:"no maps",isvisnameofmapofwield:"name",isvisimgofmapofwield:"map",maptoolruler:"ruler",maptoolmarker:"marker",maptoolarea:"area",maptoolscale:"scale",maptoolwellmarker:"well marker",isviswellactivity:"well activity"},t={};return t.translate=function(t){t=t.toLowerCase();var n=t.search(/[\w]/g),i=t.search(/[^\w]+$/g);-1===n&&(n=0),-1===i&&(i=t.length);var r=t.substring(n,i),o=e[r];return o?t.replace(r,o):t},t.translateRow=function(e){for(var n=e.split(" "),i=[],r=0;r<n.length;r+=1)i.push(t.translate(n[r])||n[r]);return i.join(" ")},t}),define("helpers/loader-helper",["require","exports","module","jquery"],function(e,t,n){var i=e("jquery"),r=[],o=function(e){r.length>0&&e.show()};t.toggleLoadingState=function(e,t){var n=i("#loader-main");if(e)0===r.length&&n.is(":visible")===!1&&window.setTimeout(o.bind(null,n),500),r.push(t);else{var a=r.indexOf(t);a>-1&&r.splice(a,1),0===r.length&&n.is(":visible")===!0&&n.hide()}},n.exports=t}),define("helpers/ajax-request",["require","exports","module","jquery","helpers/lang-helper","helpers/loader-helper"],function(e,t,n){var i=e("jquery"),r=e("helpers/lang-helper"),o=e("helpers/loader-helper"),a=function(e){o.toggleLoadingState(!1,e)},s=function(e,t,n){switch(e.status){case 401:break;case 404:alert("Data is not found");break;case 422:break;case 400:var o=e.responseJSON;if(console.log(o),"validationErrors"===o.errId){var a="Validation errors:";return i.each(o.modelState,function(e,t){a+="\n"+(r.translate(e)||e)+": ",i.each(t,function(e,t){a+=r.translateRow(t)+"; "})}),void alert(a)}console.log(o),alert(t+": "+e.responseText+" ("+n+")");break;default:alert(t+": "+e.responseText+" ("+n+")"),console.log(e)}};t=function(e,t,n){var r={cache:!1,type:e,xhrFields:{withCredentials:!0}};n&&(r.contentType="application/json; charset=utf-8",i.isFunction(n.toPlainJson)?r.data=JSON.stringify(n.toPlainJson()):i.isArray(n)?r.data=JSON.stringify(n):(console.log("not ko object and not array"),console.log(n),console.log(JSON.stringify(n)),r.data=JSON.stringify(n)));var l=(new Date).getTime();return o.toggleLoadingState(!0,l),i.ajax(t,r).fail(s).always(a.bind(null,l))},n.exports=t}),define("services/auth",["helpers/ajax-request"],function(e){function t(){return"//wfm-report.herokuapp.com/api/account/info"}function n(){return"//wfm-report.herokuapp.com/api/account/logoff"}var i={};return i.getUserProfile=function(){return e("GET",t())},i.accountLogOff=function(){return e("GET",n())},i}),define("services/company-user",["helpers/ajax-request"],function(e){function t(){return"//wfm-report.herokuapp.com/api/companyuser"}var n={getCompanyUserList:function(){return e("GET",t())}};return n}),define("services/datacontext",["jquery","helpers/ajax-request"],function(e,t){function n(t){return"//wfm-report.herokuapp.com/api/well/"+(t?"?"+e.param(t):"")}function i(t){return"//wfm-report.herokuapp.com/api/wellhistory/"+(t?"?"+e.param(t):"")}function r(t){return"//wfm-report.herokuapp.com/api/wellfieldmaparea/"+(t?"?"+e.param(t):"")}function o(t){return"//wfm-report.herokuapp.com/api/userprofile/"+(t?"?"+e.param(t):"")}function a(t){return"//wfm-report.herokuapp.com/api/productiondata/"+(t?"?"+e.param(t):"")}function s(t){return"//wfm-report.herokuapp.com/api/forecastevolution/"+(t?"?"+e.param(t):"")}function l(e,t){return"//wfm-report.herokuapp.com/api/companies/"+e+"/job-types"+(t?"/"+t:"")}function u(e){return t("POST",n(),e)}function c(e){return t("DELETE",n({id:e.Id}))}function d(e){return t("GET",a(e))}function p(e){return t("DELETE",a({well_id:e}))}function f(){var e=["bbl","Mbbl","MMbbl","scf","Mcf","MMcf","in3","m3","L","galUS","galUK"],t=["d","hr","min","sec"],n=[{Id:0,Name:"WaterCut",Format:"%",Group:"watercut",IsVisible:!0,IsCalc:!1,AssId:null,NumeratorList:["%"],CurveColor:[121,160,193]},{Id:1,Name:"OilRate",Format:"bbl/d",Group:"rate",IsVisible:!0,IsCalc:!1,AssId:null,NumeratorList:e,DenominatorList:t,CurveColor:[255,204,0]},{Id:2,Name:"WaterRate",Format:"bbl/d",Group:"rate",IsVisible:!0,IsCalc:!1,AssId:10,NumeratorList:e,DenominatorList:t,CurveColor:[20,67,106]},{Id:3,Name:"GasRate",Format:"scf/d",Group:"rate",IsVisible:!0,IsCalc:!1,AssId:null,NumeratorList:e,DenominatorList:t,CurveColor:[131,43,51]},{Id:4,Name:"LiquidRate",Format:"bbl/d",Group:"rate",IsVisible:!0,IsCalc:!1,AssId:11,NumeratorList:e,DenominatorList:t,CurveColor:[3,146,0]},{Id:5,Name:"OilCum",Format:"bbl",Group:"cumulative",IsVisible:!0,IsCalc:!1,AssId:13,NumeratorList:e,CurveColor:[255,136,0]},{Id:6,Name:"GasCum",Format:"scf",Group:"cumulative",IsVisible:!0,IsCalc:!1,AssId:15,NumeratorList:e,CurveColor:[220,20,60]},{Id:7,Name:"WaterCum",Format:"bbl",Group:"cumulative",IsVisible:!0,IsCalc:!1,AssId:14,NumeratorList:e,CurveColor:[64,108,145]},{Id:8,Name:"GOR",Format:"scf/bbl",Group:"gor",IsVisible:!0,IsCalc:!1,AssId:12,NumeratorList:e,DenominatorList:e,CurveColor:[146,0,10]},{Id:9,Name:"LiquidCum",Format:"bbl",Group:"cumulative",IsVisible:!0,IsCalc:!1,AssId:16,NumeratorList:e,CurveColor:[36,101,35]},{Id:10,Name:"CalcWaterRate",Format:"bbl/d",Title:"= LiquidRate * WaterCut(%)",Group:"rate",IsVisible:!1,IsCalc:!0,NumeratorList:e,DenominatorList:t,CurveColor:[20,67,106]},{Id:11,Name:"CalcLiquidRate",Format:"bbl/d",Title:"= WaterRate + OilRate",Group:"rate",IsVisible:!1,IsCalc:!0,NumeratorList:e,DenominatorList:t,CurveColor:[3,146,0]},{Id:12,Name:"CalcGOR",Format:"scf/bbl",Title:"= (GasRate * 1000) / OilRate",Group:"gor",IsVisible:!1,IsCalc:!0,NumeratorList:e,DenominatorList:e,CurveColor:[146,0,10]},{Id:13,Name:"CalcOilCum",Format:"bbl",Title:"= OilRate * ProdDays + PREVIOUS(CalcOilCum)",Group:"cumulative",IsVisible:!1,IsCalc:!0,NumeratorList:e,CurveColor:[255,136,0]},{Id:14,Name:"CalcWaterCum",Format:"bbl",Title:"= WaterRate * ProdDays + PREVIOUS(CalcWaterCum)",Group:"cumulative",IsVisible:!1,IsCalc:!0,NumeratorList:e,CurveColor:[64,108,145]},{Id:15,Name:"CalcGasCum",Format:"scf",Title:"= GasRate * ProdDays + PREVIOUS(CalcGasCum)",Group:"cumulative",IsVisible:!1,IsCalc:!0,NumeratorList:e,CurveColor:[220,20,60]},{Id:16,Name:"CalcLiquidCum",Format:"bbl",Title:"= CalcLiquidRate * ProdDays + PREVIOUS(CalcLiquidRate)",Group:"cumulative",IsVisible:!1,IsCalc:!0,NumeratorList:e,CurveColor:[36,101,35]}];return n}function h(e){return t("GET",i(e))}function m(e){return t("POST",i(),e)}function g(e){return t("PUT",i({id:e.id}),e)}function w(e){return t("DELETE",i({id:e}))}function v(e){return t("GET",r(e))}function y(e){return t("POST",r(),e)}function b(e){return t("PUT",r({id:e.Id}),e)}function S(e){return t("DELETE",r({id:e.Id}))}function O(e){return new T.userProfile(e)}function k(){return t("GET",o())}function W(e){return t("PUT",o({id:e.userId}),e)}function D(e){return t("GET",s({well_id:e}))}function _(e){return t("POST",s(),e)}var T={postWell:u,deleteWell:c,getProductionData:d,deleteWellProductionData:p,getColumnAttributesLocal:f,getWellHistoryList:h,postWellHistory:m,putWellHistory:g,deleteWellHistory:w,getWellFieldMapAreas:v,saveNewWellFieldMapArea:y,saveChangedWellFieldMapArea:b,deleteWellFieldMapArea:S,createUserProfile:O,getUserProfile:k,putUserProfile:W,getForecastEvolution:D,postForecastEvolution:_};return T.getJobTypeList=function(e){return t("GET",l(e))},T.postCompanyJobType=function(e,n){return t("POST",l(e),n)},T}),define("services/section-pattern",["helpers/ajax-request"],function(e){var t=function(){return"//wfm-report.herokuapp.com/api/section-patterns"},n={get:function(){return e("GET",t())}};return n}),define("constants/stage-constants",["require","exports","module"],function(e,t,n){t={upro:{id:"upro",single:"user-profile",plural:"user-profiles",ptrn:{}},company:{id:"company",single:"company",plural:"companies",ptrn:{summary:"company-summary"}},wegion:{id:"wegion",single:"well-region",plural:"well-regions",ptrn:{summary:"wegion-summary"}},wield:{id:"wield",single:"well-field",plural:"well-fields",ptrn:{summary:"wield-summary",map:"wield-map",stat:"wield-stat"}},wroup:{id:"wroup",single:"well-group",plural:"well-groups",ptrn:{summary:"wroup-summary"}},well:{id:"well",single:"well",plural:"wells",ptrn:{summary:"well-summary",map:"well-map",perfomance:"well-perfomance",sketch:"well-sketch",volume:"well-volume",history:"well-history",monitoring:"well-monitoring",integrity:"well-integrity",log:"well-log",test:"well-test",nodalAnalysis:"well-nodalanalysis"}}},n.exports=t}),define("services/widgout",["helpers/ajax-request","constants/stage-constants"],function(e,t){var n=[{name:"1 (one column)",widgockDtoList:[{orderNumber:1,columnCount:12}]},{name:"1-1 (two columns)",widgockDtoList:[{orderNumber:1,columnCount:6},{orderNumber:2,columnCount:6}]},{name:"1-1-1 (three columns)",widgockDtoList:[{orderNumber:1,columnCount:4},{orderNumber:2,columnCount:4},{orderNumber:3,columnCount:4}]},{name:"1-2 (two columns)",widgockDtoList:[{orderNumber:1,columnCount:4},{orderNumber:2,columnCount:8}]},{name:"2-1 (two columns)",widgockDtoList:[{orderNumber:1,columnCount:8},{orderNumber:2,columnCount:4}]},{name:"1-1-1-1 (four columns)",widgockDtoList:[{orderNumber:1,columnCount:3},{orderNumber:2,columnCount:3},{orderNumber:3,columnCount:3},{orderNumber:4,columnCount:3}]},{name:"1-1-2 (three columns)",widgockDtoList:[{orderNumber:1,columnCount:3},{orderNumber:2,columnCount:3},{orderNumber:3,columnCount:6}]},{name:"1-2-1 (three columns)",widgockDtoList:[{orderNumber:1,columnCount:3},{orderNumber:2,columnCount:6},{orderNumber:3,columnCount:3}]},{name:"2-1-1 (three columns)",widgockDtoList:[{orderNumber:1,columnCount:6},{orderNumber:2,columnCount:3},{orderNumber:3,columnCount:3}]},{name:"3-1 (two columns)",widgockDtoList:[{orderNumber:1,columnCount:9},{orderNumber:2,columnCount:3}]},{name:"1-3 (two columns)",widgockDtoList:[{orderNumber:1,columnCount:3},{orderNumber:2,columnCount:9}]}],i=function(e,n,i){if(!t[e])throw new ReferenceError("No such key for stage constants: "+e);return"//wfm-report.herokuapp.com/api/"+t[e].plural+"/"+n+"/widget-layouts"+(i?"/"+i:"")},r={get:function(t,n,r){return e("GET",i(t,n,r))},post:function(t,n,r){return e("POST",i(t,n),r)},put:function(t,n,r,o){return e("PUT",i(t,n,r),o)},remove:function(t,n,r){return e("DELETE",i(t,n,r))},getWidgoutTemplates:function(){return n}};return r}),define("helpers/string-helper",[],function(){var e={};return e.endsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.trimLeft=function(e){return e.replace(/^\s+/,"")},e.trimRight=function(e){return e.replace(/\s+$/,"")},e.capitalizeFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.isGuidValid=function(e){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)},e}),define("helpers/history-helper",["helpers/string-helper","constants/stage-constants"],function(e,t){var n={getNavigationArr:function(e){var n;switch(e.stageKey){case t.upro.id:n=[t.company.plural];break;case t.company.id:n=[t.company.plural,e.getIdOfCompany()];break;case t.wegion.id:n=[t.company.plural,e.getIdOfCompany(),t.wegion.plural,e.id];break;case t.wield.id:n=[t.company.plural,e.getIdOfCompany(),t.wegion.plural,e.getWellRegion().id,t.wield.plural,e.id];break;case t.wroup.id:n=[t.company.plural,e.getIdOfCompany(),t.wegion.plural,e.getWellField().getWellRegion().id,t.wield.plural,e.getWellField().id,t.wroup.plural,e.id];break;case t.well.id:n=[t.company.plural,e.getIdOfCompany(),t.wegion.plural,e.getWellGroup().getWellField().getWellRegion().id,t.wield.plural,e.getWellGroup().getWellField().id,t.wroup.plural,e.getWellGroup().id,t.well.plural,e.id];break;default:throw new Error("No child stage")}return n}},i=[{url:"/companies"},{url:"/companies/{companyId:guid}"},{url:"/companies/{companyId:guid}/sections/{companySectionId}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/sections/{wegionSectionId}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/well-fields/{wieldId:int}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/well-fields/{wieldId:int}/sections/{wieldSectionId}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/well-fields/{wieldId:int}/well-groups/{wroupId:int}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/well-fields/{wieldId:int}/well-groups/{wroupId:int}/sections/{wroupSectionId}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/well-fields/{wieldId:int}/well-groups/{wroupId:int}/wells/{wellId:int}"},{url:"/companies/{companyId:guid}/well-regions/{wegionId:int}/well-fields/{wieldId:int}/well-groups/{wroupId:int}/wells/{wellId:int}/sections/{wellSectionId}"},{url:"/account/logon"},{url:"/account/register"}];return n.getInitialData=function(t){var n={},r=t.split("/");r=r.filter(function(e){return e.length>0});var o;if(i.every(function(e){var t=e.url.split("/");if(t=t.filter(function(e){return e.length>0}),t.length!==r.length)return!0;for(var n=!0,i=0;i<t.length;i+=1)"{"!==t[i][0]&&t[i]!==r[i]&&(n=!1);return n?(o=e,!1):!0}),!o)return n;var a=o.url.split("/").filter(function(e){return e.length>0});return a.forEach(function(t,i){if("{"===t[0]){var o=t.replace(/[{}]/g,"").split(":"),a=o[0],s=o[1],l=!0;if(s)switch(s){case"guid":l=e.isGuidValid(r[i]);break;case"int":l=r[i]%1===0,l&&(r[i]=parseInt(r[i]));break;default:l=!1}l&&(n[a]=r[i])}}),console.log("url data for selection: ",n),n},n.pushState=function(e){history.pushState&&history.pushState({},"","#"+e)},n}),define("helpers/cookie-helper",["helpers/string-helper"],function(e){var t={};return t.getCookies=function(){var t=document.cookie,n=0,i={};return document.cookie.match(/^\s*\$Version=(?:"1"|1);\s*(.*)/)&&(t=RegExp.$1,n=1),0===n?t.split(/[,;]/).map(function(t){var n=t.split(/=/,2),r=decodeURIComponent(e.trimLeft(n[0])),o=n.length>1?decodeURIComponent(e.trimRight(n[1])):null;i[r]=o}):t.match(/(?:^|\s+)([!#$%&'*+\-.0-9A-Z^`a-z|~]+)=([!#$%&'*+\-.0-9A-Z^`a-z|~]*|"(?:[\x20-\x7E\x80\xFF]|\\[\x00-\x7F])*")(?=\s*[,;]|$)/g).map(function(e,t){var n=e,r='"'===t.charAt(0)?t.substr(1,-1).replace(/\\(.)/g,"$1"):t;i[n]=r}),i},t.getCookie=function(e){return t.getCookies()[e]},t.createCookie=function(e,t,n){var i="";if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),i="; expires="+r.toGMTString()}document.cookie=e+"="+t+i+"; path=/"},t.removeCookie=function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"},t}),define("viewmodels/file-spec",["knockout"],function(e){var t=function(t,n){this.mdlFileSpec=t,this.fileFilterName=n,this.isVisible=e.computed({read:this.calcIsVisible,deferEvaluation:!0,owner:this}),this.isEditView=e.observable(!1),this.hasInputFocus=e.observable(!1)};return t.prototype.calcIsVisible=function(){var t=e.unwrap(this.fileFilterName);if(!t)return!0;var n=e.unwrap(this.mdlFileSpec.namePlusExtension).toLowerCase();return n.indexOf(t.toLowerCase())>=0},t.prototype.download=function(){this.mdlFileSpec.download()},t}),define("viewmodels/section-of-stage",["knockout","viewmodels/file-spec"],function(e,t){var n=function(t,n){this.mdlSection=t,this.unz=t.sectionPatternId,this.listOfVwmFileSpec=e.computed({read:this.buildListOfVwmFileSpec,deferEvaluation:!0,owner:this}),this.fileSortOrder=e.observable(-1),this.fileSortProp=e.observable("createdUnixTime"),this.fileFilterName=e.observable(""),this.sortedListOfVwmFileSpec=e.computed({read:this.buildSortedListOfVwmFileSpec,deferEvaluation:!0,owner:this}).trackHasItems(),this.oneVisibleSlcVwmFileSpec=e.computed({read:this.calcOneVisibleSlcVwmFileSpec,deferEvaluation:!0,owner:this}),this.isVisibleSlcAnyFile=e.computed({read:this.calcIsVisibleSlcAnyFile,deferEvaluation:!0,owner:this}),this.isSlcVwmSectionWrk=e.computed({read:function(){return e.unwrap(n.slcVwmSectionWrk)===this},deferEvaluation:!0,owner:this}),this.isSlcVwmSectionFmg=e.computed({read:function(){return e.unwrap(n.slcVwmSectionFmg)===this},deferEvaluation:!0,owner:this}),this.nameForEdit=e.observable("")};return n.prototype.buildListOfVwmFileSpec=function(){var n=e.unwrap(this.mdlSection.listOfFileSpec);return n.map(function(e){return new t(e,this.fileFilterName)},this)},n.prototype.buildSortedListOfVwmFileSpec=function(){var t=e.unwrap(this.fileSortProp);if(t){var n=e.unwrap(this.fileSortOrder),i=e.unwrap(this.listOfVwmFileSpec),r=i.map(function(n,i){var r=e.unwrap(n.mdlFileSpec[t]);return"name"===t&&(r=r.toLowerCase()),{index:i,value:r}
}),o=r.sort(function(e,t){return e.value>t.value?n:-n});return o.map(function(e){return i[e.index]})}},n.prototype.sortByName=function(){this.fileSortProp("name"),this.fileSortOrder(1)},n.prototype.sortBySize=function(){this.fileSortProp("length"),this.fileSortOrder(1)},n.prototype.sortByCreated=function(){this.fileSortProp("createdUnixTime"),this.fileSortOrder(-1)},n.prototype.calcOneVisibleSlcVwmFileSpec=function(){var t=e.unwrap(this.listOfVwmFileSpec),n=t.filter(function(t){return e.unwrap(t.isVisible)&&e.unwrap(t.mdlFileSpec.isSelected)});return 1===n.length?n[0]:void 0},n.prototype.calcIsVisibleSlcAnyFile=function(){var t=e.unwrap(this.listOfVwmFileSpec),n=t.filter(function(t){return e.unwrap(t.isVisible)&&e.unwrap(t.mdlFileSpec.isSelected)});return n.length>0},n.prototype.removeSlcVwmFileSpecs=function(){var t=e.unwrap(this.listOfVwmFileSpec),n=t.filter(function(t){return e.unwrap(t.isVisible)&&e.unwrap(t.mdlFileSpec.isSelected)}),i=n.map(function(e){return e.mdlFileSpec});this.mdlSection.removeSlcFileSpecs(i)},n.prototype.editVwmFileSpec=function(){var t=e.unwrap(this.oneVisibleSlcVwmFileSpec);t&&(this.nameForEdit(e.unwrap(t.mdlFileSpec.name)),t.isEditView(!0),t.hasInputFocus(!0))},n.prototype.saveVwmFileSpec=function(t,n){if("keydown"===n.type&&27===n.keyCode||"blur"===n.type)return t.isEditView(!1),!1;if("keydown"===n.type&&(13===n.keyCode||9===n.keyCode)){var i=n.currentTarget.value;if(console.log("newName",i),i){var r=t.mdlFileSpec;i!==e.unwrap(r.name)&&(console.log("saved file spec"),r.name(i),this.mdlSection.saveFileSpec(r))}return t.isEditView(!1),!1}return!0},n}),define("base-viewmodels/widget-base",["knockout","constants/stage-constants"],function(e,t){var n=function(t){this.mdlWidget=t,this.isVisSettingPanel=e.observable(!1)};return n.prototype.saveVwmWidget=function(){this.mdlWidget.putWidget(this.hideVisSettingPanel.bind(this))},n.prototype.hideVisSettingPanel=function(){this.isVisSettingPanel(!1)},n.prototype.showVisSettingPanel=function(){this.isVisSettingPanel(!0)},n.prototype.afterRenderWidget=function(){var e=this.mdlWidget.mdlStageContext;switch(this.mdlWidget.idOfSectionPattern){case t.wield.ptrn.map:e.loadMapsOfWield();break;case t.well.ptrn.map:e.getWellGroup().getWellField().loadMapsOfWield();break;case t.well.ptrn.sketch:e.sketchOfWell.load();break;case t.well.ptrn.perfomance:e.getWellGroup().loadListOfWfmParameterOfWroup(),e.perfomanceOfWell.forecastEvolution.getDict(),e.perfomanceOfWell.getHstProductionDataSet();break;case t.well.ptrn.monitoring:e.getWellGroup().loadListOfWfmParameterOfWroup(this.widgetVwmMonitoringOfWell.loadFilteredListOfMonitoringRecord.bind(this.widgetVwmMonitoringOfWell));break;case t.well.ptrn.history:e.loadWellHistoryList()}e=null},n}),define("viewmodels/widget-default-summary",["knockout","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n){var i=function(e){n.call(this,e)};return t.inherits(i,n),i}),define("models/column-attribute",["jquery","knockout"],function(e,t){var n=function(n){var i=this;n=n||{},i.Id=n.Id,i.Name=n.Name,i.Format=t.observable(n.Format),i.numeratorList=n.NumeratorList,i.NumeratorList=n.NumeratorList,i.denominatorList=n.DenominatorList,i.DenominatorList=n.DenominatorList,i.Title=n.Title||"",i.Group=n.Group||null,i.IsVisible=t.observable(n.IsVisible||!1),i.IsCalc=t.observable(n.IsCalc||!1),i.AssId=n.AssId,i.curveColor=n.CurveColor,i.GraphCurveId=t.observable();var r=function(){i.IsVisible()===!0?e(".class"+i.Name).removeClass("hidden"):e(".class"+i.Name).addClass("hidden")};i.IsVisible.subscribe(r),i.turnCheck=function(){i.IsVisible(!i.IsVisible())},i.convertUom=function(e){i.Format(e)},i.toPlainJson=function(){return t.toJS(i)}};return n}),define("constants/graph-constants",["require","exports","module"],function(e,t,n){t={width:1200,ratio:1/3,margin:{top:10,right:30,bottom:20,left:60}},n.exports=t}),define("viewmodels/svg-block",["require","exports","module","knockout","d3","helpers/app-helper"],function(e,t,n){var i=e("knockout"),r=e("d3"),o=e("helpers/app-helper"),a=1.2;t=function(e,t,n){this.ratio=e,this.sizePx={width:i.observable(),height:i.computed({read:this.calcSizePxHeight,deferEvaluation:!0,owner:this})},this.vboxOutSize={width:t,height:t*this.ratio},this.scaleX=i.computed({read:this.getScaleX,deferEvaluation:!0,owner:this}),this.scaleY=i.computed({read:this.getScaleY,deferEvaluation:!0,owner:this}),this.scaleX.subscribe(this.updateZoomScale,this),this.scaleY.subscribe(this.updateZoomScale,this),this.zoomTransform=n,this.zoomTransformAttr=i.computed({read:this.calcZoomTransformAttr,deferEvaluation:!0,owner:this}),this.baseZoomBhvr=r.behavior.zoom().scaleExtent([1e-4,1e4]).on("zoom",this.onZoom.bind(this)),this.zoomTransform.subscribe(this.buildZoomBehavior,this),this.zoomTransform.valueHasMutated()},t.prototype.setZoomTransform=function(e,t){this.zoomTransform({scale:e||1,translate:t||[0,0]})},t.prototype.updateZoomScale=function(){var e=i.unwrap(this.scaleX),t=i.unwrap(this.scaleY);e&&t&&this.baseZoomBhvr.x(e).y(t)},t.prototype.buildZoomBehavior=function(){var e=i.unwrap(this.zoomTransform),t={scale:this.baseZoomBhvr.scale(),translate:this.baseZoomBhvr.translate()};t.scale!==e.scale&&t.translate!==e.translate&&this.baseZoomBhvr.scale(e.scale).translate(e.translate)},t.prototype.zoomInOut=function(e,t,n){var r,o=i.unwrap(this.zoomTransform),s=o.scale;r=1===n?s*a:s/a,r=Math.round(1e3*r)/1e3;var l={width:e*r,height:t*r},u={width:e*s,height:t*s},c=(l.width-u.width)/2,d=(l.height-u.height)/2,p=o.translate[0]-c,f=o.translate[1]-d;this.setZoomTransform(r,[p,f])},t.prototype.calcSizePxHeight=function(){var e=i.unwrap(this.sizePx.width);return o.isNumeric(e)?e*this.ratio:void 0},t.prototype.onZoom=function(){this.setZoomTransform(r.event.scale,r.event.translate)},t.prototype.calcZoomTransformAttr=function(){var e=i.unwrap(this.zoomTransform);return"translate("+e.translate.join(",")+") scale("+e.scale+")"},n.exports=t}),define("viewmodels/svg-graph",["require","exports","module","knockout","d3","constants/graph-constants","helpers/app-helper","viewmodels/svg-block"],function(e,t,n){var i=e("knockout"),r=e("d3"),o=e("constants/graph-constants"),a=e("helpers/app-helper"),s=e("viewmodels/svg-block");t=function(e,t,n){s.call(this,o.ratio,o.width,i.observable({scale:1,translate:[0,0]})),this.timeBorder=e,this.valueBorder=t,this.vboxMargin=o.margin,this.vboxSize={width:this.vboxOutSize.width-this.vboxMargin.left-this.vboxMargin.right,height:this.vboxOutSize.height-this.vboxMargin.top-this.vboxMargin.bottom},this.baseTransform="translate("+this.vboxMargin.left+", "+this.vboxMargin.top+")",this.axisXTransform="translate(0,"+this.vboxSize.height+")",this.axis={x:i.computed({read:this.getAxisX,deferEvaluation:!0,owner:this}),y:i.computed({read:this.getAxisY,deferEvaluation:!0,owner:this})},this.paths=n},a.inherits(t,s),t.prototype.getAxisX=function(){var e=i.unwrap(this.zoomTransform);if(e){var t=i.unwrap(this.scaleX);if(t)return r.svg.axis().scale(t).tickSize(-this.vboxSize.height)}},t.prototype.getAxisY=function(){var e=i.unwrap(this.zoomTransform);if(e){var t=i.unwrap(this.scaleY);if(t)return r.svg.axis().scale(t).orient("left").tickSize(-this.vboxSize.width).tickFormat(r.format(".3s"))}},t.prototype.getScaleX=function(){var e=i.unwrap(this.timeBorder);return a.isNumeric(e[0])&&a.isNumeric(e[1])?r.time.scale().domain([new Date(1e3*e[0]),new Date(1e3*e[1])]).range([0,this.vboxSize.width]):void 0},t.prototype.getScaleY=function(){var e=i.unwrap(this.valueBorder);return a.isNumeric(e[0])&&a.isNumeric(e[1])?r.scale.linear().domain(e).range([this.vboxSize.height,0]):void 0},t.prototype.zoomIn=function(){t.superClass_.zoomInOut.call(this,this.vboxSize.width,this.vboxSize.height,1)},t.prototype.zoomOut=function(){t.superClass_.zoomInOut.call(this,this.vboxSize.width,this.vboxSize.height,-1)},n.exports=t}),define("viewmodels/wfm-parameter-of-wroup",["knockout"],function(e){var t=function(t){this.mdlWfmParameterOfWroup=t,this.isVisible=e.observable(!0)};return t}),define("viewmodels/perfomance-of-well",["jquery","knockout","helpers/modal-helper","moment","models/column-attribute","viewmodels/svg-graph","d3","viewmodels/wfm-parameter-of-wroup"],function(e,t,n,i,r,o,a,s){function l(e){var t=new Date(24*(parseFloat(e)-25569)*3600*1e3);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}function u(t,o,a,s){function u(t){var n=e(t.currentTarget).val();if(!n)return e(P[t.data.elemColumnIndex].matchFormatElem).html("").hide(),void e(P[t.data.elemColumnIndex].matchFormatElemDenominator).html("").hide();var i=e.grep(a,function(e){return e.Name===n})[0],r="";if(e.each(i.NumeratorList,function(e,t){r+='<option value="'+t+'">'+t+"</option>"}),e(P[t.data.elemColumnIndex].matchFormatElem).html(r).show(),i.DenominatorList){var o="";e.each(i.DenominatorList,function(e,t){o+='<option value="'+t+'">'+t+"</option>"}),e(P[t.data.elemColumnIndex].matchFormatElemDenominator).html(o).show()}else e(P[t.data.elemColumnIndex].matchFormatElemDenominator).html("").hide()}console.log("column attributes without calc: ",a);var c=document.createElement("div");e(c).css({overflow:"auto"});var d=document.createElement("tbody"),p=document.createElement("tfoot"),f=document.createElement("table");e(f).addClass("table-fragment").append(p,d),c.appendChild(f);for(var h=0,m=".txt"===o,g=0,w=t.length;w>g;g++){var v=document.createElement("tr"),y=t[g].length;h=Math.max(h,y);for(var b=0;y>b;b++){var S=document.createElement("td"),O=t[g][b];null!==O&&""!==O&&(0===b&&m===!1&&parseInt(O,10)%1===0&&(O=i(l(parseInt(O,10))).format("YYYY-MM-DD")),S.appendChild(document.createTextNode(O))),v.appendChild(S)}d.appendChild(v)}var k={Name:"ProdDays",NumeratorList:["days"]};a.push(k);var W={Name:"Date",NumeratorList:["auto"]};m===!0&&(W.NumeratorList=["d-MMM-yy","dd-MMM-yy","yyyy-MM-dd","M/d/yyyy","dd-MM-yyyy","MM-dd-yyyy"]),a.push(W);for(var D="<option></option>",_=0;_<a.length;_++)D+='<option val="'+a[_].Name+'">'+a[_].Name+"</option>";var T=document.createElement("tr");p.appendChild(T);var E=document.createElement("tr");p.appendChild(E);for(var P=[],M=0;h>M;M++){var x=document.createElement("td"),C=document.createElement("select");e(C).addClass("input-sm").html(D),x.appendChild(C),T.appendChild(x);var I=document.createElement("td"),F=document.createElement("select");e(F).addClass("input-sm").hide(),I.appendChild(F),E.appendChild(I);var L=document.createElement("select");e(L).addClass("input-sm").hide(),I.appendChild(L),P.push({matchNameElem:C,matchFormatElem:F,matchFormatElemDenominator:L})}for(var V=0;V<P.length;V+=1)e(P[V].matchNameElem).on("change",{elemColumnIndex:V},u);e(d).find("tr").on("click",function(){e(this).siblings().removeClass("selected-row"),e(this).addClass("selected-row")});var N=function(){var t=e(d).find("tr.selected-row");if(0===t.length)return void alert("Please select a row, where data begins");var i=t.prevAll().length,o=!1,a=e.map(P,function(t,n){var i=e(t.matchNameElem).val();if(i){"Date"===i&&(o=!0);var a=new r({Id:n,Name:i,Format:e(t.matchFormatElem).val()+(e(t.matchFormatElemDenominator).val()?"/"+e(t.matchFormatElemDenominator).val():"")});return a.toPlainJson()}});return o===!1?void alert("Please choose a column for Date"):(s(a,i),void n.closeModalWideWindow())};n.openModalWideWindow(c,N,"Please select values for columns")}var c=function(n,i,r,a,l,u,c,d){function p(){var e=t.unwrap(f.WPDDateStartYear),n=t.unwrap(f.WPDDateEndYear),i=t.unwrap(f.selectedPrfTableYear);e&&n&&(!i||e>i||i>n)&&f.selectedPrfTableYear(e)}var f=this;this.getVwmWell=function(){return i},this.mdlWell=n,this.mdlPerfomanceOfWell=n.perfomanceOfWell,this.isVisibleForecastData=d,this.selectedPrfTableYear=t.observable(),this.selectPrfTableYear=function(e){f.selectedPrfTableYear(e)},this.monthList=[1,2,3,4,5,6,7,8,9,10,11,12],this.WPDDateStartYear=r,this.WPDDateEndYear=a,this.WPDDateStartMonth=l,this.WPDDateEndMonth=u,this.WPDDateStartYear.subscribe(p),this.WPDDateEndYear.subscribe(p),this.selectedAttrGroupId=c,this.selectedAttrGroup=t.computed({read:function(){var n=t.unwrap(f.mdlPerfomanceOfWell.getWellObj().getRootMdl().wfmParamSquadList),i=e.grep(n,function(e){return e.id===t.unwrap(f.selectedAttrGroupId)});return i.length>0?i[0]:void 0},deferEvaluation:!0}),this.selectAttrGroupId=function(e){f.selectedAttrGroupId(e)},this.listOfVwmWfmParameterOfWroup=t.computed({read:function(){var e=t.unwrap(this.mdlWell.getWellGroup().listOfWfmParameterOfWroup);return e.map(function(e){return new s(e)})},deferEvaluation:!0,owner:this}),this.listOfSlcVwmWfmParameterOfWroup=t.computed({read:function(){var n=[],i=t.unwrap(f.selectedAttrGroup);if(i){var r=t.unwrap(f.listOfVwmWfmParameterOfWroup),o=t.unwrap(i.wfmParameterList),a=o.map(function(e){return e.id});n=r.filter(function(t){return e.inArray(t.mdlWfmParameterOfWroup.wfmParameterId,a)>=0})}return n},deferEvaluation:!0}),this.filteredByDateProductionDataSet=t.computed({read:this.calcFilteredByDatePD,deferEvaluation:!0,owner:this}),this.filteredByDateProductionDataSetTimeBorder=t.computed({read:this.calcTimeBorder,deferEvaluation:!0,owner:this}),this.filteredByDateProductionDataSetValueBorder=t.computed({read:this.calcValueBorder,deferEvaluation:!0,owner:this}),this.perfomancePaths=t.computed({read:this.generatePerfomancePaths,deferEvaluation:!0,owner:this}),this.prfmGraph=new o(f.filteredByDateProductionDataSetTimeBorder,f.filteredByDateProductionDataSetValueBorder,f.perfomancePaths),this.joinedYearList=t.computed({read:function(){return t.unwrap(f.isVisibleForecastData)?t.unwrap(f.mdlPerfomanceOfWell.forecastYearList).concat(t.unwrap(f.mdlPerfomanceOfWell.histYearList)):t.unwrap(f.mdlPerfomanceOfWell.histYearList)},deferEvaluation:!0,owner:this}),f.removeWellProductionData=function(){confirm("Are you sure you want to delete all production data from well?")&&f.mdlPerfomanceOfWell.deleteWellProductionData()}};return c.prototype.importPerfomanceData=function(){function e(){i.okError("");var e=t.unwrap(r.getVwmWell().slcVwmSectionFmg);if(!e)throw new Error("No selected section");var o=t.unwrap(e.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});if(1!==o.length)return void i.okError("need to select one file");var a=o[0];r.mdlPerfomanceOfWell.getPerfomanceFragment(n,e.mdlSection.id,a.id,0,10,function(o){var s=t.unwrap(r.mdlPerfomanceOfWell.prdColumnAttributeList);console.log("clean columns: ",s),s=s.filter(function(e){return t.unwrap(e.IsCalc)===!1});var l=s.map(function(e){return t.toJS(e)});i.hide(),u(o,a.extension,l,function(t,i){console.log(t,i),r.mdlPerfomanceOfWell.postPerfomanceData(n,e.mdlSection.id,a.id,i,t,function(){r.mdlPerfomanceOfWell.isLoadedHstProductionData(!1),r.mdlPerfomanceOfWell.getHstProductionDataSet()},function(e){if(422===e.status){var t=e.responseJSON;require(["helpers/lang-helper"],function(e){var n=e.translate(t.errId)||t.errId;alert(n)})}})})})}var n=this.mdlWell.stageKey;this.getVwmWell().unzOfSlcVwmSectionFmg(n+"-perfomance");var i=this.getVwmWell().fmgrModal,r=this;i.okCallback(e),i.okDescription("Please select a file to import"),i.show()},c.prototype.generatePerfomancePaths=function(){var n=[],i=t.unwrap(this.prfmGraph.zoomTransform);if(i){var r=t.unwrap(this.listOfSlcVwmWfmParameterOfWroup),o=t.unwrap(this.prfmGraph.scaleX),s=t.unwrap(this.prfmGraph.scaleY);if(o&&s){var l=t.unwrap(this.filteredByDateProductionDataSet);r.forEach(function(i){var r=i.mdlWfmParameterOfWroup.wfmParameterId,u=a.svg.line().interpolate("monotone").x(function(e){return o(new Date(1e3*e.unixTime))}).y(function(n){return s(e.isNumeric(t.unwrap(n[r]))?t.unwrap(n[r])*t.unwrap(t.unwrap(i.mdlWfmParameterOfWroup.wfmParameter).uomCoef):null)});n.push({prmPath:u(l),prmStroke:t.unwrap(i.mdlWfmParameterOfWroup.color),prmVisible:t.unwrap(i.isVisible)})})}}return n},c.prototype.calcValueBorder=function(){var n,i,r=t.unwrap(this.listOfSlcVwmWfmParameterOfWroup),o=t.unwrap(this.filteredByDateProductionDataSet);return e.each(o,function(o,a){e.each(r,function(r,o){if(t.unwrap(o.isVisible)){var s=o.mdlWfmParameterOfWroup;if(e.isNumeric(t.unwrap(a[s.wfmParameterId]))){var l=t.unwrap(a[s.wfmParameterId])*t.unwrap(s.wfmParameter().uomCoef);"undefined"==typeof n||"undefined"==typeof i?n=i=l:l>i?i=l:n>l&&(n=l)}}})}),"undefined"!=typeof n&&(n-=n/20,i+=i/20),[n,i]},c.prototype.calcTimeBorder=function(){var e=t.unwrap(this.filteredByDateProductionDataSet);return 0===e.length?[]:[e[e.length-1].unixTime,e[0].unixTime]},c.prototype.calcFilteredByDatePD=function(){var e=[],n=t.unwrap(this.mdlPerfomanceOfWell.hstProductionDataSet),i=t.unwrap(this.mdlPerfomanceOfWell.histYearList);if(n.length>0&&i.length>0){var r,o=t.unwrap(this.mdlPerfomanceOfWell.dcaProductionDataSet),a=t.unwrap(this.isVisibleForecastData)?!0:!1;r=a?o.concat(n):n,t.unwrap(this.WPDDateStartYear)||this.WPDDateStartYear(i[0]),t.unwrap(this.WPDDateEndYear)||this.WPDDateEndYear(i[0]),t.unwrap(this.WPDDateStartMonth)||this.WPDDateStartMonth(1),t.unwrap(this.WPDDateEndMonth)||this.WPDDateEndMonth(12);var s=t.unwrap(this.WPDDateStartYear),l=t.unwrap(this.WPDDateEndYear),u=t.unwrap(this.WPDDateStartMonth),c=t.unwrap(this.WPDDateEndMonth),d=new Date(Date.UTC(s,u-1,1)).getTime()/1e3,p=new Date(Date.UTC(l,c-1,1)).getTime()/1e3;e=t.utils.arrayFilter(r,function(e){return e.unixTime>=d&&e.unixTime<=p})}return e},c}),define("viewmodels/widget-well-perfomance",["knockout","viewmodels/perfomance-of-well","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n,i){var r=function(e){i.call(this,e),this.vwmPerfomanceOfWell=new t(e.mdlStageContext,null,e.opts.startYear,e.opts.endYear,e.opts.startMonth,e.opts.endMonth,e.opts.selectedAttrGroupId,e.opts.isVisibleForecastData)};return n.inherits(r,i),r}),define("helpers/monitoring-helper",["knockout","d3","helpers/app-helper"],function(e,t,n){function i(t,i){var r=i.dict;for(var o in r)if(r.hasOwnProperty(o)){var a=e.unwrap(r[o]);n.isNumeric(a)&&(null===t[0]&&null===t[1]?t[0]=t[1]=a:(t[0]=Math.min(t[0],a),t[1]=Math.max(t[1],a)))}}var r={},o=function(t,n){return t(new Date(1e3*e.unwrap(n.unixTime)))},a=function(t,i,r,o){var a=e.unwrap(o.dict[i]);return t(n.isNumeric(a)?a*r:null)};return r.genFromParam=function(n,i,r,s){var l=e.unwrap(s.mdlWfmParameterOfWroup.wfmParameter),u=l.id,c=e.unwrap(l.uomCoef),d=t.svg.line().interpolate("monotone").x(o.bind(null,i)).y(a.bind(null,r,u,c));return{prmPath:d(n),prmStroke:e.unwrap(s.mdlWfmParameterOfWroup.color),prmVisible:e.unwrap(s.isVisible)}},r.getValueBorderArr=function(t){var n=e.unwrap(t),r=[null,null];return n.forEach(i.bind(this,r),this),console.log("value borders: ",r),r},r}),define("viewmodels/monitoring-of-well",["knockout","viewmodels/svg-graph","d3","viewmodels/wfm-parameter-of-wroup","helpers/monitoring-helper"],function(e,t,n,i,r){var o=function(n,i,o){this.mdlWell=n,this.mntrUnixTimeBorder={start:i,end:o},this.mntrUnixTimeBorder.start.subscribe(this.loadFilteredListOfMonitoringRecord,this),this.mntrUnixTimeBorder.end.subscribe(this.loadFilteredListOfMonitoringRecord,this),this.timeBorderArr=e.computed({read:this.getTimeBorderArr,deferEvaluation:!0,owner:this}),this.valueBorderArr=e.computed({read:r.getValueBorderArr.bind(null,this.mdlWell.listOfMonitoringRecord),deferEvaluation:!0,owner:this}),this.listOfMonitoredVwmParams=e.computed({read:this.getListOfMonitoredVwmParams,deferEvaluation:!0,owner:this}).trackHasItems(),this.pathsArr=e.computed({read:this.getPathsArr,deferEvaluation:!0,owner:this}),this.mntrGraph=new t(this.timeBorderArr,this.valueBorderArr,this.pathsArr)};return o.prototype.loadFilteredListOfMonitoringRecord=function(){console.log("load monitoring");var t=this.mntrUnixTimeBorder,n=e.unwrap(t.start);if(n){var i=e.unwrap(t.end);i&&this.mdlWell.loadListOfMonitoringRecord(n,i)}},o.prototype.getTimeBorderArr=function(){return[e.unwrap(this.mntrUnixTimeBorder.start),e.unwrap(this.mntrUnixTimeBorder.end)]},o.prototype.getListOfMonitoredVwmParams=function(){var t=e.unwrap(this.mdlWell.getWellGroup().listOfMonitoredParams);return t.map(function(e){return new i(e)})},o.prototype.removeAllMonitoringRecords=function(){confirm("Are you sure you want to delete all records for this well for all time?")&&this.mdlWell.removeAllMonitoringRecords()},o.prototype.getPathsArr=function(){var t=e.unwrap(this.mntrGraph.zoomTransform);if(t){var n=e.unwrap(this.listOfMonitoredVwmParams),i=e.unwrap(this.mntrGraph.scaleX),o=e.unwrap(this.mntrGraph.scaleY);if(i&&o){var a=e.unwrap(this.mdlWell.sortedListOfMonitoringRecord);return n.map(r.genFromParam.bind(null,a,i,o))}}return[]},o}),define("viewmodels/widget-well-monitoring",["knockout","viewmodels/monitoring-of-well","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n,i){var r=function(e){i.call(this,e),this.widgetVwmMonitoringOfWell=new t(e.mdlStageContext,e.opts.startUnixTime,e.opts.endUnixTime)};return n.inherits(r,i),r}),define("viewmodels/widget-well-sketch",["knockout","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n){var i=function(e){n.call(this,e)};return t.inherits(i,n),i}),define("viewmodels/history-of-well",["jquery","knockout","helpers/modal-helper"],function(e,t,n){var i=function(e,n,i,r,o){this.getVwmWell=function(){return n},this.filterUnixTime={start:i,end:r},this.idOfSlcJobType=o,this.mdlHistoryOfWell=e,this.isVisible=t.computed({read:this.checkIsVisibleRecord,deferEvaluation:!0,owner:this})};return i.prototype.createFileSpecOfHistoryOfWell=function(){function e(){r.okError("");var e=t.unwrap(i.slcVwmSectionFmg);if(!e)throw new Error("No selected section");var o=t.unwrap(e.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});return 1!==o.length?void r.okError("need to select one file"):void n.mdlHistoryOfWell.postFileSpecOfHistoryOfWell(o[0].id,function(){r.hide()},function(e){if(422===e.status){var t=e.responseJSON;require(["helpers/lang-helper"],function(e){var n=e.translate(t.errId)||"unknown error";r.okError(n)})}})}var n=this,i=this.getVwmWell();i.unzOfSlcVwmSectionFmg(i.mdlStage.stageKey+"-history");var r=i.fmgrModal;r.okCallback(e),r.okDescription("Please select a file for this history record"),r.show()},i.prototype.createImageFromFileSpec=function(){function i(){a.okError("");var i=t.unwrap(o.slcVwmSectionFmg);if(!i)throw new Error("No selected section");var s=t.unwrap(i.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});if(1!==s.length)return void a.okError("need to select one file");var l=s[0];a.hide();var u=document.createElement("div"),c=document.createElement("img");u.appendChild(c),c.onload=function(){require(["jquery.Jcrop"],function(){function t(e){i=[e.x,e.y,e.x2,e.y2]}var i=[0,0,0,0];e(c).Jcrop({onChange:t,onSelect:t,bgOpacity:.6}),n.openModalWideWindow(u,function(){r.mdlHistoryOfWell.postImageOfHistoryOfWell(l.id,i,function(){n.closeModalWideWindow()})},"Please select area to crop")})},c.src=l.fileUrl}var r=this,o=this.getVwmWell();o.unzOfSlcVwmSectionFmg(o.mdlStage.stageKey+"-history");var a=this.getVwmWell().fmgrModal;a.okCallback(i),a.okDescription("Please select a history image to crop"),a.show()},i.prototype.checkIsVisibleRecord=function(){var e=this,n=t.toJS(this.filterUnixTime);if(console.log("tmpFilterUnixTime",n),n.start||n.end){var i={start:t.unwrap(e.mdlHistoryOfWell.startUnixTime),end:t.unwrap(e.mdlHistoryOfWell.endUnixTime)};if(console.log("tmpElemUnixTime",i),n.start&&n.start>i.start)return!1;if(n.end&&n.end<i.end)return!1}var r=t.unwrap(e.idOfSlcJobType);return r&&t.unwrap(e.mdlHistoryOfWell.jobTypeId)!==r?!1:!0},i}),define("viewmodels/scope-of-history-of-well",["knockout","viewmodels/history-of-well"],function(e,t){var n=function(t,n,i,r,o,a){this.getVwmWell=function(){return t},this.mdlWell=n;var s=this.mdlWell.getWellGroup().getWellField().getWellRegion().getCompany();this.jobTypeList=s.jobTypeList,this.goToPostingJobType=function(){var e=window.prompt("Add job type to list");e&&s.postJobType(e)},this.startDate=i,this.endDate=r,this.jobTypeId=o,this.sortByDateOrder=a,this.sortByDateCss=e.computed({read:this.getSortByDateCss,deferEvaluation:!0,owner:this}),this.listOfVwmHistoryOfWell=e.computed({read:this.buildListOfVwmHistoryOfWell,deferEvaluation:!0,owner:this}).trackHasItems(),this.sortedListOfVwmHistoryOfWell=e.computed({read:this.buildSortedListOfVwmHistoryOfWell,deferEvaluation:!0,owner:this}),this.wellHistoryNew={startUnixTime:e.observable(),endUnixTime:e.observable()},this.isEnabledPostHistoryOfWell=e.computed({read:this.checkIsEnabledPostHistoryOfWell,deferEvaluation:!0,owner:this})};return n.prototype.checkIsEnabledPostHistoryOfWell=function(){return e.unwrap(this.wellHistoryNew.startUnixTime)?!0:!1},n.prototype.postVwmHistoryOfWell=function(){if(e.unwrap(this.isEnabledPostHistoryOfWell)){var t=e.toJS(this.wellHistoryNew);t.startUnixTime&&(t.endUnixTime||(t.endUnixTime=t.startUnixTime),this.mdlWell.postHistoryOfWell(t.startUnixTime,t.endUnixTime,this.scsPostHistoryOfWell.bind(this)))}},n.prototype.scsPostHistoryOfWell=function(e){this.mdlWell.pushHistoryOfWell(e),this.wellHistoryNew.startUnixTime(null),this.wellHistoryNew.endUnixTime(null)},n.prototype.removeVwmHistoryOfWell=function(e){confirm("Are you sure you want to delete record?")&&this.mdlWell.deleteWellHistory(e.mdlHistoryOfWell)},n.prototype.buildSortedListOfVwmHistoryOfWell=function(){var t=e.unwrap(this.listOfVwmHistoryOfWell),n=parseInt(e.unwrap(this.sortByDateOrder),10);return t.sort(function(t,i){return e.unwrap(t.mdlHistoryOfWell.startUnixTime)===e.unwrap(i.mdlHistoryOfWell.startUnixTime)?0:e.unwrap(t.mdlHistoryOfWell.startUnixTime)>e.unwrap(i.mdlHistoryOfWell.startUnixTime)?n:-n})},n.prototype.buildListOfVwmHistoryOfWell=function(){var n=e.unwrap(this.mdlWell.historyList),i=n.map(function(e){return new t(e,this.getVwmWell(),this.startDate,this.endDate,this.jobTypeId)},this);return console.log("Ready history list:",i),i},n.prototype.getSortByDateCss=function(){return 1===e.unwrap(this.sortByDateOrder)?"glyphicon-arrow-down":"glyphicon-arrow-up"},n.prototype.changeSortByDateOrder=function(){this.sortByDateOrder(-parseInt(e.unwrap(this.sortByDateOrder),10))},n}),define("viewmodels/widget-well-history",["knockout","viewmodels/scope-of-history-of-well","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n,i){var r=function(e){i.call(this,e),this.vwmScopeOfHistoryOfWell=new t(null,e.mdlStageContext,e.opts.startDate,e.opts.endDate,e.opts.jobTypeId,e.opts.sortByDateOrder)};return n.inherits(r,i),r}),define("viewmodels/map-tool",["knockout"],function(e){var t=function(t,n){t=t||{};var i=this;this.id=t.id,this.name=t.name,this.icon=t.icon,this.isPublicTool=t.isPublicTool,this.isSlc=e.computed({read:function(){return i.id===e.unwrap(n)},deferEvaluation:!0})};return t}),define("viewmodels/well-marker-of-map-of-wield",["knockout"],function(e){var t=function(t,n,i){this.mdlWellMarker=t,this.getVwmMapOfWield=function(){return i},this.isSlc=e.computed({read:function(){return this===e.unwrap(n)},deferEvaluation:!0,owner:this})};return t}),define("viewmodels/svg-map",["knockout","viewmodels/svg-block","helpers/app-helper","d3"],function(e,t,n,i){function r(e,t,n,i,r){var o={};return t/r>e?(o.height=i,o.width=e*i/t):(o.width=n,o.height=t*n/e),o}var o=function(e,n,i,o){t.call(this,.5,1200,o),this.imgUrl=e,this.imgWidthPx=n,this.imgHeightPx=i;var a=r(this.imgWidthPx,this.imgHeightPx,this.vboxOutSize.width,this.vboxOutSize.height,this.ratio);this.imgWidthVg=a.width,this.imgHeightVg=a.height,this.widthCoefVgToPx=this.imgWidthVg/this.imgWidthPx,this.heightCoefVgToPx=this.imgHeightVg/this.imgHeightPx,this.imgStartVgX=(this.vboxOutSize.width-this.imgWidthVg)/2,this.imgStartVgY=(this.vboxOutSize.height-this.imgHeightVg)/2};return n.inherits(o,t),o.prototype.getScaleX=function(){return i.scale.linear().range([this.imgStartVgX,this.imgStartVgX+this.imgWidthVg])},o.prototype.getScaleY=function(){return i.scale.linear().range([this.imgStartVgY,this.imgStartVgY+this.imgHeightVg])},o.prototype.zoomIn=function(){o.superClass_.zoomInOut.call(this,this.imgWidthVg,this.imgHeightVg,1)},o.prototype.zoomOut=function(){o.superClass_.zoomInOut.call(this,this.imgWidthVg,this.imgHeightVg,-1)},o.prototype.getVboxCenter=function(){return[this.vboxOutSize.width/2,this.vboxOutSize.height/2]},o}),define("viewmodels/map-of-wield",["knockout","viewmodels/map-tool","viewmodels/well-marker-of-map-of-wield","viewmodels/svg-map"],function(e,t,n,i){var r=[{id:"hand",name:"",icon:"glyphicon glyphicon-hand-up",isPublicTool:!0},{id:"marker",name:"Well marker",icon:"glyphicon glyphicon-map-marker",isPublicTool:!1}],o=function(t,n,r){this.mdlMapOfWield=t,this.vid=t.id,this.name=t.name,this.isSlcVwmMapOfWield=e.computed({read:function(){return this.vid===e.unwrap(n)},deferEvaluation:!0,owner:this}),this.handledAreas=e.computed({read:function(){return e.unwrap(this.mdlMapOfWield.areas)},deferEvaluation:!0,owner:this}),this.idOfSlcVwmMapTool=e.observable(),this.slcMapTool=e.computed({read:this.getSlcMapTool,deferEvaluation:!0,owner:!0}),this.mapTools=e.computed({read:this.buildMapTools,deferEvaluation:!0,owner:this}),this.listVwmWellMarker=e.computed({read:this.getListVwmWellMarker,deferEvaluation:!0,owner:this}),this.slcVwmWellMarker=e.observable(),this.svgMap=new i(this.mdlMapOfWield.fileSpec.fileUrl,this.mdlMapOfWield.fileSpec.imgWidth,this.mdlMapOfWield.fileSpec.imgHeight,r),this.vwmWellMarkerToAdd={coords:e.observable(),isDrilled:e.observable(!0),idOfWell:e.observable(),markerStyle:"well-marker_pre-created"},this.mapBindingOptions={imgUrl:this.svgMap.imgUrl,imgWidthPx:this.svgMap.imgWidthPx,imgHeightPx:this.svgMap.imgHeightPx,imgWidthVg:this.svgMap.imgWidthVg,imgHeightVg:this.svgMap.imgHeightVg,widthCoefVgToPx:this.svgMap.widthCoefVgToPx,heightCoefVgToPx:this.svgMap.heightCoefVgToPx,listOfVwmWellMarker:this.listVwmWellMarker,wellMarkerRadius:8,idOfSlcMapTool:this.idOfSlcVwmMapTool,vwmWellMarkerToAdd:this.vwmWellMarkerToAdd}};return o.prototype.getSlcMapTool=function(){var t=this,n=e.unwrap(t.mapTools);if(n.length>0){var i=e.unwrap(t.idOfSlcVwmMapTool);return i?n.filter(function(e){return e.id===i})[0]:(t.idOfSlcVwmMapTool(n[0].id),n[0])}},o.prototype.selectMapTool=function(e){this.idOfSlcVwmMapTool(e.id)},o.prototype.addWellMarkerToMap=function(){this.mdlMapOfWield.postWellMarker(e.unwrap(this.vwmWellMarkerToAdd.idOfWell),e.unwrap(this.vwmWellMarkerToAdd.coords),e.unwrap(this.vwmWellMarkerToAdd.isDrilled)),this.cancelAddingWellMarker()},o.prototype.cancelAddingWellMarker=function(){this.vwmWellMarkerToAdd.coords(null),this.vwmWellMarkerToAdd.idOfWell(null)},o.prototype.removeVwmWellMarker=function(e){confirm("Are you sure you want to delete?")&&this.mdlMapOfWield.removeWellMarker(e.mdlWellMarker)},o.prototype.selectVwmWellMarker=function(t){var n=this;n.slcVwmWellMarker(t);var i=n.svgMap.getVboxCenter();console.log("Center coords of this map: ",i);var r=e.unwrap(t.mdlWellMarker.coords),o=[r[0]*n.svgMap.widthCoefVgToPx+n.svgMap.imgStartVgX,r[1]*n.svgMap.heightCoefVgToPx+n.svgMap.imgStartVgY],a=[i[0]-o[0],i[1]-o[1]];n.svgMap.zoomTransform({scale:1,translate:a})},o.prototype.buildMapTools=function(){return r.map(function(e){return new t(e,this.idOfSlcVwmMapTool)},this)},o.prototype.getListVwmWellMarker=function(){return e.unwrap(this.mdlMapOfWield.wellMarkers).map(function(e){return new n(e,this.slcVwmWellMarker,this)},this)},o}),define("viewmodels/widget-wield-map",["knockout","viewmodels/map-of-wield","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n,i){var r=function(t){i.call(this,t),this.slcVwmMapOfWield=e.computed({read:this.getSlcVwmMapOfWield,deferEvaluation:!0,owner:this})};return n.inherits(r,i),r.prototype.getSlcVwmMapOfWield=function(){console.log("getSlcVwmMapOfWield has executed");var n=e.unwrap(this.mdlWidget.opts.idOfSlcMapOfWield);if(n){var i=e.unwrap(this.mdlWidget.mdlStageContext.WellFieldMaps),r=i.filter(function(e){return e.id===n})[0];if(r){var o=new t(r,this.mdlWidget.opts.idOfSlcMapOfWield,this.mdlWidget.opts.transform);return o}}},r}),define("viewmodels/widget-well-map",["knockout","helpers/app-helper","base-viewmodels/widget-base","viewmodels/map-of-wield","viewmodels/well-marker-of-map-of-wield"],function(e,t,n,i,r){var o=function(t){n.call(this,t),this.slcVwmMapMarker=e.computed({read:this.calcSlcVwmMapMarker,deferEvaluation:!0,owner:this})
};return t.inherits(o,n),o.prototype.calcSlcVwmMapMarker=function(){var t=e.unwrap(this.mdlWidget.opts.idOfSlcMapOfWield);if(t){var n=e.unwrap(this.mdlWidget.mdlStageContext.listOfMapMarker),o=n.filter(function(e){return e.idOfMapOfWield===t})[0];if(o){var a=this.mdlWidget.opts.transform,s=new i(o.getWellFieldMap(),null,a);return new r(o,null,s)}}},o}),define("viewmodels/widget-wield-stat",["knockout","helpers/app-helper","base-viewmodels/widget-base"],function(e,t,n){var i=function(e){n.call(this,e)};return t.inherits(i,n),i}),define("viewmodels/widgock",["knockout","constants/stage-constants","viewmodels/widget-default-summary","viewmodels/widget-well-perfomance","viewmodels/widget-well-monitoring","viewmodels/widget-well-sketch","viewmodels/widget-well-history","viewmodels/widget-wield-map","viewmodels/widget-well-map","viewmodels/widget-wield-stat"],function(e,t,n,i,r,o,a,s,l,u){var c=function(n,i){this.mdlWidgock=n,this.getVwmWidgout=function(){return i},this.listOfVwmWidget=e.computed({read:this.getListOfVwmWidget,deferEvaluation:!0,owner:this}),this.dictOfKeyOfStage=[{optValue:t.company.id,optText:t.company.single},{optValue:t.wegion.id,optText:t.wegion.single},{optValue:t.wield.id,optText:t.wield.single},{optValue:t.wroup.id,optText:t.wroup.single},{optValue:t.well.id,optText:t.well.single}],this.slcKeyOfStage=e.observable(this.mdlWidgock.getWidgout().getParent().stageKey),this.listOfPatternOfSection=e.computed({read:this.calcListOfPatternOfSection,deferEvaluation:!0,owner:this}),this.slcStagePatternForWidget=e.observable(null),this.canAddVwmWidget=e.computed({read:this.calcCanAddVwmWidget,deferEvaluation:!0,owner:this}),this.dictOfStage=e.computed({read:this.calcDictOfStage,deferEvaluation:!0,owner:this}),this.slcCntxStage=e.observable(null)};return c.prototype.calcDictOfStage=function(){var t=e.unwrap(this.slcKeyOfStage),n=[];if(t){var i=this.mdlWidgock.getWidgout().getParent().getListOfStageByKey(t);n=i.map(function(t){return{optValue:t,optText:e.unwrap(t.name)||e.unwrap(t.Name)}})}return n},c.prototype.calcListOfPatternOfSection=function(){var t=e.unwrap(this.mdlWidgock.getWidgout().getParent().getRootMdl().ListOfSectionPatternDto),n=e.unwrap(this.slcKeyOfStage);return t.filter(this.isPat.bind(this,n))},c.prototype.isPat=function(e,t){return t.idOfStage===e&&t.isWidget===!0},c.prototype.calcCanAddVwmWidget=function(){return e.unwrap(this.slcStagePatternForWidget)&&e.unwrap(this.slcCntxStage)?!0:!1},c.prototype.addVwmWidget=function(){var t=e.unwrap(this.slcStagePatternForWidget);if(t){this.slcStagePatternForWidget(null);var n=e.unwrap(this.slcCntxStage),i=n.id;if(i){var r=t.id.split("-")[0];"company"!==r&&(i=parseInt(i));var o=(e.unwrap(n.name)||e.unwrap(n.Name))+" "+e.unwrap(t.name);this.mdlWidgock.addWidget(o,t.id,i,this.afterAddingVwmWidget.bind(this))}n=null}},c.prototype.afterAddingVwmWidget=function(t){var n=this.mdlWidgock.buildWidget(t);this.mdlWidgock.widgetList.push(n);var i=n.id,r=e.unwrap(this.listOfVwmWidget).filter(function(e){return e.mdlWidget.id===i})[0];r&&r.showVisSettingPanel()},c.prototype.removeVwmWidget=function(t){var n=t.mdlWidget;confirm('Are you sure you want to delete "'+e.unwrap(n.name)+'"?')&&this.mdlWidgock.removeWidget(n)},c.prototype.getListOfVwmWidget=function(){return e.unwrap(this.mdlWidgock.widgetList).map(this.buildVwmWidget,this)},c.prototype.buildVwmWidget=function(e){var c=this.getVwmWidgout().getParentVwmStage();switch(e.idOfSectionPattern){case t.well.ptrn.summary:case t.wroup.ptrn.summary:case t.wield.ptrn.summary:case t.wegion.ptrn.summary:case t.company.ptrn.summary:return new n(e,c);case t.well.ptrn.perfomance:return new i(e,c);case t.well.ptrn.monitoring:return new r(e,c);case t.well.ptrn.history:return new a(e,c);case t.wield.ptrn.map:return new s(e,c);case t.wield.ptrn.stat:return new u(e,c);case t.well.ptrn.map:return new l(e,c);case t.well.ptrn.sketch:return new o(e,c)}},c}),define("viewmodels/widgout",["jquery","knockout","moment","viewmodels/widgock","helpers/lang-helper","helpers/modal-helper"],function(e,t,n,i,r,o){var a=function(e,n){this.mdlWidgout=e,this.getParentVwmStage=function(){return n},this.name=e.name,this.listOfVwmWidgock=t.computed({read:this.buildListOfVwmWidgock,deferEvaluation:!0,owner:this}),this.isReportInProgress=t.observable(!1),this.idOfReportFileSpec=t.observable(null),this.reportFileSpec=t.computed({read:this.calcReportFileSpec,deferEvaluation:!0,owner:this})};return a.prototype.buildListOfVwmWidgock=function(){return t.unwrap(this.mdlWidgout.widgocks).map(function(e){return new i(e,this)},this)},a.prototype.preGenerateReport=function(){var i=n().format("YYYY-MM-DD"),r=document.createElement("input");r.type="text";var a=e(r);a.prop({required:!0}).addClass("form-control").val(t.unwrap(this.name)+" "+i);var s=document.createElement("div");e(s).addClass("form-horizontal").append(o.gnrtDom("Name",r)),o.openModalWindow("Report",s,this.generateReport.bind(this,a))},a.prototype.generateReport=function(e){var t=e.val();o.closeModalWindow(),this.isReportInProgress(!0),this.mdlWidgout.postReport(t,this.scsGenerateReport.bind(this),this.errGenerateReport.bind(this))},a.prototype.scsGenerateReport=function(e){this.idOfReportFileSpec(e.IdOfFileSpec);var n=t.unwrap(this.getParentVwmStage().mdlStage.reportSection);n&&(n.isLoadedListOfFileSpec(!1),n.loadListOfFileSpec(!1)),this.isReportInProgress(!1)},a.prototype.errGenerateReport=function(e){if(this.isReportInProgress(!1),console.log(e),422===e.status){var t=e.responseJSON,n=r.translate(t.errId)||t.errId;alert(n)}},a.prototype.calcReportFileSpec=function(){console.log("calcReportFileSpec");var e=t.unwrap(this.idOfReportFileSpec);if(e){var n=t.unwrap(this.getParentVwmStage().mdlStage.reportSection);return n?t.unwrap(n.listOfFileSpec).filter(function(t){return t.id===e})[0]:void 0}},a.prototype.downloadWithClean=function(){var e=t.unwrap(this.reportFileSpec);e&&e.download(),this.idOfReportFileSpec(null)},a}),define("constants/stage-view-constants",["require","exports","module"],function(e,t,n){t={dashboard:{id:"dashboard",name:"Dashboard"},fmgr:{id:"fmgr",name:"File manager"}},n.exports=t}),define("viewmodels/fmgr-modal",["knockout"],function(e){var t=function(){this.isShowed=e.observable(!1),this.okDescription=e.observable(""),this.okError=e.observable(""),this.okCallback=e.observable()};return t.prototype.show=function(){this.isShowed(!0)},t.prototype.hide=function(){this.isShowed(!1),this.okDescription(""),this.okError(""),this.okCallback(null)},t}),define("base-viewmodels/stage-base",["knockout","helpers/history-helper","viewmodels/section-of-stage","viewmodels/widgout","constants/stage-view-constants","viewmodels/fmgr-modal"],function(e,t,n,i,r,o){var a=function(t,n,i){this.koUnqOfSlcVwmStage=n,this.isSlcVwmStage=e.computed({read:this.calcIsSlcVwmStage,deferEvaluation:!0,owner:this}),this.isActiveVwmStage=e.computed({read:this.calcIsActiveVwmStage,deferEvaluation:!0,owner:this}),this.unzOfSlcVwmSectionFmg=e.observable(),this.listOfVwmChild=e.computed({read:this.buildListOfVwmChild,deferEvaluation:!0,owner:this}),this.listOfVwmWidgout=e.computed({read:this.buildListOfVwmWidgout,deferEvaluation:!0,owner:this}),this.listOfVwmSection=e.computed({read:this.buildListOfVwmSection,deferEvaluation:!0,owner:this}),this.slcVwmSectionFmg=e.computed({read:this.calcSlcVwmSectionFmg,deferEvaluation:!0,owner:this}),this.slcVwmSectionFmg.subscribe(this.handleVwmSectionFmg,this),this.unzOfSlcVwmSectionWrk=e.observable(),this.slcVwmSectionWrk=e.computed({read:this.calcSlcVwmSectionWrk,deferEvaluation:!0,owner:this}),this.isNullSlcVwmSectionWrk=e.computed({read:this.calcIsNullSlcVwmSectionWrk,deferEvaluation:!0,owner:this}),this.slcStageView=e.observable(),this.isSlcStageViewDashboard=e.computed({read:function(){return e.unwrap(this.slcStageView)===r.dashboard.id},deferEvaluation:!0,owner:this}),this.isSlcStageViewFmgr=e.computed({read:function(){return e.unwrap(this.slcStageView)===r.fmgr.id},deferEvaluation:!0,owner:this}),this.patternOfSlcVwmSectionWrk=e.computed({read:this.calcPatternOfSlcVwmSectionWrk,deferEvaluation:!0,owner:this}),this.slcVwmSectionWrk.subscribe(this.handleVwmSectionWrk,this),this.slcVwmWidgout=e.observable(),this.fmgrModal=new o,this.unqOfSlcVwmChild=e.observable(i),this.slcVwmChild=e.computed({read:this.calcSlcVwmChild,deferEvaluation:!0,owner:this}),this.slcVwmChild.subscribe(this.handleSlcVwmChild,this),this.isOpenedItem=e.observable(!1),this.menuItemCss=e.computed({read:this.calcMenuItemCss,deferEvaluation:!0,owner:this}),t&&(this.unzOfSlcVwmSectionWrk(this.mdlStage.stageKey+"-"+t),t=null)};return a.prototype.handleVwmSectionFmg=function(e){e&&e.mdlSection.loadListOfFileSpec()},a.prototype.handleVwmSectionWrk=function(e){console.log("subscribe section",e);var n=t.getNavigationArr(this.mdlStage);if(e)this.loadSectionContent&&this.loadSectionContent(e.mdlSection.sectionPatternId),n.push("sections"),n.push(e.mdlSection.sectionPatternId.split("-")[1]);else{if(null!==e)throw new Error("VwmSection can not be undefined (only in init step)");this.mdlStage.loadWidgouts()}t.pushState("/"+n.join("/"))},a.prototype.selectImgFileSpec=function(t){var n=this;n.unzOfSlcVwmSectionFmg(n.mdlStage.stageKey+"-summary"),n.fmgrModal.okCallback(function(){n.fmgrModal.okError("");var i=e.unwrap(n.slcVwmSectionFmg);if(!i)throw new Error("No selected section when select image file for stage propery");var r=e.unwrap(i.mdlSection.listOfFileSpec).filter(function(t){return e.unwrap(t.isSelected)});return 1!==r.length?void n.fmgrModal.okError("need to select one file"):(n.mdlStage[t.addtData.nestedClientId](r[0].id),n.mdlStage.save(),void n.fmgrModal.hide())}),n.fmgrModal.okDescription("Please select one image"),n.fmgrModal.show()},a.prototype.removeVwmWidgout=function(t){confirm('Are you sure you want to delete "'+e.unwrap(t.mdlWidgout.name)+'"?')&&this.mdlStage.removeWidgout(t.mdlWidgout)},a.prototype.selectVwmSectionWrk=function(e){this.unzOfSlcVwmSectionWrk(e.unz)},a.prototype.selectVwmSectionWrkById=function(e){this.unzOfSlcVwmSectionWrk(e)},a.prototype.showStageViewDashboard=function(){this.unzOfSlcVwmSectionWrk(null),this.slcStageView(r.dashboard.id)},a.prototype.showStageViewFmgr=function(){this.unzOfSlcVwmSectionWrk(null),this.unselectVwmSectionFmg(),this.slcStageView(r.fmgr.id)},a.prototype.calcSlcVwmSectionWrk=function(){var t=e.unwrap(this.unzOfSlcVwmSectionWrk);return t?e.unwrap(this.listOfVwmSection).filter(function(e){return e.unz===t})[0]:null===t?null:void 0},a.prototype.selectVwmSectionFmg=function(e){this.unzOfSlcVwmSectionFmg(e.unz)},a.prototype.unselectVwmSectionFmg=function(){this.unzOfSlcVwmSectionFmg(null)},a.prototype.buildListOfVwmWidgout=function(){return e.unwrap(this.mdlStage.widgouts).map(function(e){return new i(e,this)},this)},a.prototype.calcSlcVwmSectionFmg=function(){var t=e.unwrap(this.unzOfSlcVwmSectionFmg);return t?e.unwrap(this.listOfVwmSection).filter(function(e){return e.unz===t})[0]:null===t?null:void 0},a.prototype.buildListOfVwmSection=function(){var t=e.unwrap(this.mdlStage.listOfSection);return t.map(function(e){return new n(e,this)},this)},a.prototype.selectAncestorVwms=function(){var e=this.getParentVwm();e&&(e.unqOfSlcVwmChild(this.unq),e.selectAncestorVwms())},a.prototype.calcIsSlcAncestorVwms=function(){for(var t=!0,n=this.getParentVwm();n&&(t=e.unwrap(n.isSlcVwmStage),t!==!1);)n=n.getParentVwm();return t},a.prototype.buildListOfVwmChild=function(){throw new Error("Need to ovveride in a subclass if there are stage children")},a.prototype.removeVwmChild=function(t){var n=t.mdlStage,i=e.unwrap(n.name?n.name:n.Name);confirm('Are you sure you want to delete "'+i+'"?')&&this.mdlStage.removeChild(n)},a.prototype.calcSlcVwmChild=function(){var t=e.unwrap(this.unqOfSlcVwmChild);return t?e.unwrap(this.listOfVwmChild).filter(function(e){return e.unq===t})[0]:void 0},a.prototype.handleSlcVwmChild=function(e){e&&"undefined"!=typeof e.isOpenedItem&&e.isOpenedItem(!0)},a.prototype.activateVwmChild=function(n){var i=t.getNavigationArr(n.mdlStage);t.pushState("/"+i.join("/")),"undefined"!=typeof n.unqOfSlcVwmChild&&n.unqOfSlcVwmChild(null),e.unwrap(n.unzOfSlcVwmSectionWrk)||n.showStageViewDashboard(),this.unqOfSlcVwmChild(n.unq),this.selectAncestorVwms()},a.prototype.deactivateVwmChild=function(){this.unqOfSlcVwmChild(null);var e=t.getNavigationArr(this.mdlStage);t.pushState("/"+e.join("/"))},a.prototype.calcIsSlcVwmStage=function(){return e.unwrap(this.koUnqOfSlcVwmStage)===e.unwrap(this.unq)},a.prototype.calcIsActiveVwmStage=function(){return e.unwrap(this.isSlcVwmStage)&&!e.unwrap(this.slcVwmChild)&&(console.log("stage is showed",this.mdlStage.stageKey),this.calcIsSlcAncestorVwms())?!0:!1},a.prototype.toggleItem=function(){this.isOpenedItem(!e.unwrap(this.isOpenedItem))},a.prototype.calcMenuItemCss=function(){return e.unwrap(this.isOpenedItem)?"glyphicon-circle-arrow-down":"glyphicon-circle-arrow-right"},a.prototype.calcPatternOfSlcVwmSectionWrk=function(){var t=e.unwrap(this.slcVwmSectionWrk);return t?t.mdlSection.sectionPatternId:void 0},a.prototype.calcIsNullSlcVwmSectionWrk=function(){return null===e.unwrap(this.slcVwmSectionWrk)},a}),define("viewmodels/sketch-of-well",["knockout"],function(e){var t=function(e,t,n,i){this.mdlSketchOfWell=e,this.fmgrModal=i,this.koWellUnzOfSlcVwmSectionFmg=t,this.koSlcVwmSectionFmg=n};return t.prototype.createSketchFromFile=function(){function t(){n.fmgrModal.okError("");var t=e.unwrap(n.koSlcVwmSectionFmg);if(!t)throw new Error("No selected section");var i=e.unwrap(t.mdlSection.listOfFileSpec).filter(function(t){return e.unwrap(t.isSelected)});return 1!==i.length?void n.fmgrModal.okError("need to select one file"):void n.mdlSketchOfWell.putSketchOfWell(i[0].id,e.unwrap(i[0].name),function(){n.fmgrModal.hide()})}var n=this,i=n.mdlSketchOfWell.getWell();n.koWellUnzOfSlcVwmSectionFmg(i.stageKey+"-sketch"),n.fmgrModal.okCallback(t),n.fmgrModal.okDescription("Please select a file for a sketch image"),n.fmgrModal.show()},t}),define("viewmodels/volume-of-well",["knockout"],function(e){var t=function(t,n){var i=this;this.mdlVolumeOfWell=t,this.vid=t.idOfFileSpec,this.isSlcVwmVolumeOfWell=e.computed({read:function(){return e.unwrap(n)===i.vid},deferEvaluation:!0})};return t}),define("viewmodels/log-of-well",["knockout"],function(e){var t=function(t,n){var i=this;this.mdlLogOfWell=t,this.vid=t.id,this.isSlc=e.computed({read:function(){return i.vid===e.unwrap(n)},deferEvaluation:!0})};return t}),define("viewmodels/nodal-analysis-of-well",["knockout"],function(e){var t=function(t,n){var i=this;this.mdlNodalAnalysis=t,this.vid=t.idOfFileSpec,this.isSlc=e.computed({read:function(){return i.vid===e.unwrap(n)},deferEvaluation:!0})};return t}),define("viewmodels/integrity-of-well",["knockout"],function(e){var t=function(t,n){var i=this;this.mdlIntegrity=t,this.vid=t.idOfFileSpec,this.isSlc=e.computed({read:function(){return i.vid===e.unwrap(n)},deferEvaluation:!0})};return t}),define("viewmodels/test-scope",["knockout"],function(e){var t=function(t){var n=this;this.mdlTestScope=t,this.isDetailed=e.observable(!1),this.toggleIsDetailed=function(){n.isDetailed(!e.unwrap(n.isDetailed))}};return t}),define("viewmodels/well",["jquery","knockout","helpers/modal-helper","helpers/app-helper","constants/stage-constants","base-viewmodels/stage-base","viewmodels/sketch-of-well","viewmodels/volume-of-well","viewmodels/scope-of-history-of-well","viewmodels/log-of-well","viewmodels/nodal-analysis-of-well","viewmodels/integrity-of-well","viewmodels/perfomance-of-well","viewmodels/test-scope","viewmodels/monitoring-of-well","viewmodels/map-of-wield","viewmodels/well-marker-of-map-of-wield"],function(e,t,n,i,r,o,a,s,l,u,c,d,p,f,h,m,g){function w(e,t){return Math.random()*(t-e)+e}function v(e){var t={};return e.forEach(function(e){t[e.wfmParameterId]=w(10,1e3)}),t}var y=function(e,n,i){this.mdlStage=e,this.unq=e.id,this.getParentVwm=function(){return n},o.call(this,i.wellSectionId,n.unqOfSlcVwmChild,null),this.vwmSketchOfWell=new a(this.mdlStage.sketchOfWell,this.unzOfSlcVwmSectionFmg,this.slcVwmSectionFmg,this.fmgrModal),this.listOfVwmVolumeOfWell=t.computed({read:this.buildListOfVwmVolumeOfWell,deferEvaluation:!0,owner:this}).trackHasItems(),this.vidOfSlcVwmVolumeOfWell=t.observable(),this.slcVwmVolumeOfWell=t.computed({read:this.calcSlcVwmVolumeOfWell,deferEvaluation:!0,owner:this}),this.vwmScopeOfHistoryOfWell=new l(this,this.mdlStage,t.observable(null),t.observable(null),t.observable(null),t.observable(-1));var s=this;this.listOfVwmLogOfWell=t.computed({read:function(){return t.unwrap(s.mdlStage.logsOfWell).map(function(e){return new u(e,s.vidOfSlcVwmLogOfWell)})},deferEvaluation:!0,owner:this}),this.vidOfSlcVwmLogOfWell=t.observable(),this.slcVwmLogOfWell=t.computed({read:function(){var e=t.unwrap(s.vidOfSlcVwmLogOfWell),n=t.unwrap(s.listOfVwmLogOfWell);if(e)return n.filter(function(t){return t.vid===e})[0];var i=n[0];return i?(s.vidOfSlcVwmLogOfWell(i.vid),i):void 0},deferEvaluation:!0}),this.selectVwmLogOfWell=function(e){s.vidOfSlcVwmLogOfWell(e.vid)},this.listOfVwmNodalAnalysis=t.computed({read:function(){return t.unwrap(s.mdlStage.listOfNodalAnalysis).map(function(e){return new c(e,s.vidOfSlcVwmNodalAnalysis)})},deferEvaluation:!0}),this.vidOfSlcVwmNodalAnalysis=t.observable(),this.slcVwmNodalAnalysis=t.computed({read:function(){var e=t.unwrap(s.vidOfSlcVwmNodalAnalysis),n=t.unwrap(s.listOfVwmNodalAnalysis);if(e)return n.filter(function(t){return t.vid===e})[0];var i=n[0];return i?(s.vidOfSlcVwmNodalAnalysis(i.vid),i):void 0},deferEvaluation:!0}),this.selectVwmNodalAnalysis=function(e){s.vidOfSlcVwmNodalAnalysis(e.vid)},this.removeVwmNodalAnalysis=function(e){confirm('Are you sure you want to delete "'+t.unwrap(e.mdlNodalAnalysis.name)+'"?')&&s.mdlStage.removeNodalAnalysis(e.mdlNodalAnalysis)},this.listOfVwmIntegrity=t.computed({read:this.buildListOfVwmIntegrity,deferEvaluation:!0,owner:this}),this.vidOfSlcVwmIntegrity=t.observable(),this.slcVwmIntegrity=t.computed({read:this.calcSlcVwmIntegrity,deferEvaluation:!0,owner:this}),this.mainVwmPerfomanceOfWell=new p(s.mdlStage,s,t.observable(null),t.observable(null),t.observable(null),t.observable(null),t.observable(null),t.observable(!1)),this.listOfVwmTestScope=t.computed({read:function(){return t.unwrap(this.mdlStage.listOfTestScope).map(function(e){return new f(e)})},deferEvaluation:!0,owner:this}),this.handledListOfVwmTestScope=t.computed({read:function(){return t.unwrap(s.listOfVwmTestScope).sort(function(e,n){var i=t.unwrap(e.mdlTestScope.startUnixTime),r=t.unwrap(n.mdlTestScope.startUnixTime);return i===r?0:r>i?1:-1})},deferEvaluation:!0}),this.mainVwmMonitoringOfWell=new h(this.mdlStage,t.observable(null),t.observable(null)),this.monitoringRecordForWroup=t.computed({read:this.calcMonitoringRecordForWroup,deferEvaluation:!0,owner:this}),this.listOfVwmMapMarker=t.computed({read:this.buildListOfVwmMapMarker,deferEvaluation:!0,owner:this}),this.idOfMapOfSlcVwmMapMarker=t.observable(),this.slcVwmMapMarker=t.computed({read:this.calcSlcVwmMapMarker,deferEvaluation:!0,owner:this}),console.log("history pattern",r.well.ptrn.history),this.isSlcPtrnWellHistory=t.computed({read:this.calcIsSlcPtrn.bind(this,r.well.ptrn.history),deferEvaluation:!0,owner:this}),this.isSlcPtrnWellIntegrity=t.computed({read:this.calcIsSlcPtrn.bind(this,r.well.ptrn.integrity),deferEvaluation:!0,owner:this}),this.isSlcPtrnWellLog=t.computed({read:this.calcIsSlcPtrn.bind(this,r.well.ptrn.log),deferEvaluation:!0,owner:this}),this.isSlcPtrnWellNodalAnalysis=t.computed({read:this.calcIsSlcPtrn.bind(this,r.well.ptrn.nodalAnalysis),deferEvaluation:!0,owner:this}),this.isSlcPtrnWellPerfomance=t.computed({read:this.calcIsSlcPtrn.bind(this,r.well.ptrn.perfomance),deferEvaluation:!0,owner:this}),this.isSlcPtrnWellMap=t.computed({read:this.calcIsSlcPtrn.bind(this,r.well.ptrn.map),deferEvaluation:!0,owner:this})};return i.inherits(y,o),y.prototype.calcIsSlcPtrn=function(e){return t.unwrap(this.patternOfSlcVwmSectionWrk)===e},y.prototype.calcSlcVwmMapMarker=function(){var e=t.unwrap(this.idOfMapOfSlcVwmMapMarker);if(e){var n=t.unwrap(this.listOfVwmMapMarker);return n.filter(function(t){return t.mdlWellMarker.idOfMapOfWield===e})[0]}},y.prototype.selectVwmMapMarker=function(e){this.idOfMapOfSlcVwmMapMarker(e.mdlWellMarker.idOfMapOfWield)},y.prototype.buildListOfVwmMapMarker=function(){var e=t.unwrap(this.mdlStage.listOfMapMarker),n=this.slcVwmMapMarker;return e.map(function(e){var i=new m(e.getWellFieldMap(),null,t.observable({scale:1,translate:[0,0]}));return new g(e,n,i)},this)},y.prototype.loadSectionContent=function(e){switch(e){case r.well.ptrn.history:this.mdlStage.loadWellHistoryList();break;case r.well.ptrn.sketch:this.mdlStage.sketchOfWell.load();break;case r.well.ptrn.volume:this.mdlStage.loadVolumes();break;case r.well.ptrn.perfomance:this.mdlStage.getWellGroup().loadListOfWfmParameterOfWroup(),this.mdlStage.perfomanceOfWell.forecastEvolution.getDict(),this.mdlStage.perfomanceOfWell.getHstProductionDataSet();break;case r.well.ptrn.nodalAnalysis:this.mdlStage.loadListOfNodalAnalysis();break;case r.well.ptrn.integrity:this.mdlStage.loadListOfIntegrity();break;case r.well.ptrn.log:this.mdlStage.loadLogsOfWell();break;case r.well.ptrn.test:this.mdlStage.loadListOfTestScope(),this.mdlStage.getWellGroup().loadListOfWfmParameterOfWroup();break;case r.well.ptrn.monitoring:this.mdlStage.getWellGroup().loadListOfWfmParameterOfWroup(),this.mdlStage.getWellGroup().loadProcentBordersForAllWells(),this.mainVwmMonitoringOfWell.loadFilteredListOfMonitoringRecord();break;case r.well.ptrn.map:var t=this.mdlStage.getWellGroup().getWellField();t.loadMapsOfWield()}},y.prototype.createDemoMonitoringRecords=function(){for(var e=new Date,n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())/1e3,i=86400,r=n-35*i,o=this.getParentVwm(),a=t.unwrap(o.mdlStage.listOfMonitoredParams),s=r;n>=s;s+=i)this.mdlStage.postMonitoringRecord(s,a,v(a),s===n?o.reloadMonitoringRecords.bind(o):null)},y.prototype.createMonitoringRecord=function(){var e=this.getParentVwm(),n=t.unwrap(e.monitoringUnixTime);if(n){var i=t.unwrap(e.mdlStage.listOfMonitoredParams);this.mdlStage.postMonitoringRecord(n,i,{},e.reloadMonitoringRecords.bind(e))}},y.prototype.calcMonitoringRecordForWroup=function(){var e=t.unwrap(this.getParentVwm().monitoringUnixTime);if(e){var n=t.unwrap(this.mdlStage.listOfMonitoringRecord),i=n.filter(function(n){return t.unwrap(n.unixTime)===e})[0];return i}},y.prototype.createVolumeFromFile=function(){function e(){n.fmgrModal.okError("");var e=t.unwrap(n.slcVwmSectionFmg);if(!e)throw new Error("No selected section");var i=t.unwrap(e.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});return 1!==i.length?void n.fmgrModal.okError("need to select one file"):void n.mdlStage.postVolumeOfWell(i[0].id,t.unwrap(i[0].name),function(){n.fmgrModal.hide()},function(e){if(422===e.status){var t=e.responseJSON;require(["helpers/lang-helper"],function(e){var i=e.translate(t.errId)||"unknown error";n.fmgrModal.okError(i)})}})}var n=this;n.unzOfSlcVwmSectionFmg(n.mdlStage.stageKey+"-volume"),n.fmgrModal.okCallback(e),n.fmgrModal.okDescription("Please select a file for a volume"),n.fmgrModal.show()},y.prototype.createLogOfWellFromFileSpec=function(){function i(){r.fmgrModal.okError("");var i=t.unwrap(r.slcVwmSectionFmg);if(!i)throw new Error("No selected section");var o=t.unwrap(i.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});if(1!==o.length)return void r.fmgrModal.okError("need to select one file");var a=o[0];r.mdlStage.getLogColumnAttributes(i.mdlSection.id,a.id,function(i){function o(){var i=e(h).find(".pd-parameter").map(function(){return e(this).val()}).get();return i.length<4?void alert("All fields required"):(r.mdlStage.postLogOfWell(a.id,t.unwrap(a.name),i),void n.closeModalWindow())}r.fmgrModal.hide();var s=document.createElement("select");e(s).addClass("pd-parameter");var l=document.createElement("select");e(l).addClass("pd-parameter");var u=document.createElement("select");e(u).addClass("pd-parameter");var c=document.createElement("select");e(c).addClass("pd-parameter");for(var d=0,p=i.length;p>d;d++){var f=document.createElement("option");switch(e(f).val(i[d].Id).html(i[d].Name+(i[d].Format()?", "+i[d].Format():"")),i[d].Name){case"DEPTH":case"DEPT":s.appendChild(f);break;case"SP":case"SPC":l.appendChild(f);break;case"GR":case"HGRT":case"GRDS":case"SGR":case"NGRT":u.appendChild(f);break;case"RS":case"RES":case"RESD":c.appendChild(f)}}var h=document.createElement("div");e(h).addClass("form-horizontal").append(n.gnrtDom("Depth",s),n.gnrtDom("GR",u),n.gnrtDom("SP",l),n.gnrtDom("Resistivity",c)),n.openModalWindow("Column match",h,o)})}var r=this;r.unzOfSlcVwmSectionFmg(r.mdlStage.stageKey+"-log"),r.fmgrModal.okCallback(i),r.fmgrModal.okDescription("Please select a file for a log"),r.fmgrModal.show()},y.prototype.postVwmNodalAnalysis=function(){function e(){n.fmgrModal.okError("");var e=t.unwrap(n.slcVwmSectionFmg);if(!e)throw new Error("No selected section");var i=t.unwrap(e.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});return 1!==i.length?void n.fmgrModal.okError("need to select one file"):void n.mdlStage.postNodalAnalysis(i[0].id,t.unwrap(i[0].name),"",function(){n.fmgrModal.hide()},function(e){if(422===e.status){var t=e.responseJSON;require(["helpers/lang-helper"],function(e){var i=e.translate(t.errId)||"unknown error";n.fmgrModal.okError(i)})}})}var n=this;n.unzOfSlcVwmSectionFmg(n.mdlStage.stageKey+"-nodalanalysis"),n.fmgrModal.okCallback(e),n.fmgrModal.okDescription("Please select a file for a nodal analysis"),n.fmgrModal.show()},y.prototype.postVwmIntegrity=function(){function e(){n.fmgrModal.okError("");var e=t.unwrap(n.slcVwmSectionFmg);if(!e)throw new Error("No selected section");var i=t.unwrap(e.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});return 1!==i.length?void n.fmgrModal.okError("need to select one file"):void n.mdlStage.postIntegrity(i[0].id,t.unwrap(i[0].name),"",function(){n.fmgrModal.hide()},function(e){if(422===e.status){var t=e.responseJSON;require(["helpers/lang-helper"],function(e){var i=e.translate(t.errId)||"unknown error";n.fmgrModal.okError(i)})}})}var n=this;n.unzOfSlcVwmSectionFmg(n.mdlStage.stageKey+"-integrity"),n.fmgrModal.okCallback(e),n.fmgrModal.okDescription("Please select an integrity file"),n.fmgrModal.show()},y.prototype.buildListOfVwmVolumeOfWell=function(){return t.unwrap(this.mdlStage.volumes).map(function(e){return new s(e,this.vidOfSlcVwmVolumeOfWell)},this)},y.prototype.calcSlcVwmVolumeOfWell=function(){var e=t.unwrap(this.vidOfSlcVwmVolumeOfWell),n=t.unwrap(this.listOfVwmVolumeOfWell);return e?n.filter(function(t){return t.vid===e})[0]:n.length>0?(this.vidOfSlcVwmVolumeOfWell(n[0].vid),n[0]):void 0},y.prototype.selectVwmVolumeOfWell=function(e){this.vidOfSlcVwmVolumeOfWell(e.vid)},y.prototype.removeVwmVolumeOfWell=function(e){confirm('Are you sure you want to delete "'+t.unwrap(e.mdlVolumeOfWell.name)+'"?')&&this.mdlStage.removeVolumeOfWell(e.mdlVolumeOfWell)},y.prototype.buildListOfVwmIntegrity=function(){return t.unwrap(this.mdlStage.listOfIntegrity).map(this.createVwmIntegrity,this)},y.prototype.createVwmIntegrity=function(e){return new d(e,this.vidOfSlcVwmIntegrity)},y.prototype.selectVwmIntegrity=function(e){this.vidOfSlcVwmIntegrity(e.vid)},y.prototype.calcSlcVwmIntegrity=function(){var e=t.unwrap(this.vidOfSlcVwmIntegrity),n=t.unwrap(this.listOfVwmIntegrity);if(e)return n.filter(function(t){return t.vid===e})[0];var i=n[0];return i?(this.vidOfSlcVwmIntegrity(i.vid),i):void 0},y.prototype.removeVwmIntegrity=function(e){confirm('Are you sure you want to delete "'+t.unwrap(e.mdlIntegrity.name)+'"?')&&this.mdlStage.removeIntegrity(e.mdlIntegrity)},y}),define("viewmodels/wroup",["jquery","knockout","helpers/modal-helper","helpers/app-helper","viewmodels/well","base-viewmodels/stage-base","viewmodels/wfm-parameter-of-wroup"],function(e,t,n,i,r,o,a){var s=function(e){return t.unwrap(e).filter(function(e){return t.unwrap(e.mdlWfmParameterOfWroup.isMonitored)})},l=function(e,n,i){this.mdlStage=e,this.getParentVwm=function(){return n},this.unq=e.id,this.defaultSlcData=i,o.call(this,i.wroupSectionId,n.unqOfSlcVwmChild,i.wellId),this.listOfVwmWfmParameterOfWroup=t.computed({read:this.calcListOfVwmWfmParameterOfWroup,deferEvaluation:!0,owner:this}),this.slcWfmParameter=t.observable(),this.unselectedWfmParameterList=t.computed({read:this.calcUnselectedWfmParameterList,deferEvaluation:!0,owner:this}),this.listOfMonitoredVwmParams=t.computed({read:s.bind(null,this.listOfVwmWfmParameterOfWroup),deferEvaluation:!0,owner:!0}).trackHasItems(),this.monitoringUnixTime=t.observable(),this.isMonthlyProcentView=t.observable(!1),this.turnOnMonthlyProcentView=function(){this.isMonthlyProcentView(!0)},this.turnOffMonthlyProcentView=function(){this.isMonthlyProcentView(!1)},this.monitoringUnixTime.subscribe(this.reloadMonitoringRecords,this),this.listOfMonitoredVwmParams.subscribe(this.reloadMonitoringRecords,this)};i.inherits(l,o),l.prototype.postVwmWell=function(){function t(){var t=e(r).val();t&&(i.mdlStage.postWell(t,function(){}),n.closeModalWindow())}var i=this,r=document.createElement("input");r.type="text",e(r).prop({required:!0}).addClass("form-control");var o=document.createElement("div");e(o).addClass("form-horizontal").append(n.gnrtDom("Name",r)),n.openModalWindow("Well",o,t)},l.prototype.loadSectionContent=function(e){var n=this;switch(e){case"wroup-unit":n.mdlStage.loadListOfWfmParameterOfWroup();break;case"wroup-potential":n.mdlStage.loadListOfWfmParameterOfWroup(),t.unwrap(n.mdlStage.wells).forEach(function(e){e.loadListOfTestScope()});break;case"wroup-monitoring":n.mdlStage.loadListOfWfmParameterOfWroup(),n.mdlStage.loadProcentBordersForAllWells();var i=t.unwrap(n.monitoringUnixTime);if(!i){var r=new Date,o=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())/1e3;i=o}n.monitoringUnixTime(null),n.monitoringUnixTime(i)}},l.prototype.removeVwmWfmParameterOfWroup=function(e){var n=this;console.log("Remove parameter {0} from {1}",e,this);var i=t.unwrap(t.unwrap(e.mdlWfmParameterOfWroup.wfmParameter).name);confirm('Are you sure you want to delete "'+i+'"?')&&n.mdlStage.removeWfmParameterOfWroup(e.mdlWfmParameterOfWroup)},l.prototype.buildListOfVwmChild=function(){return t.unwrap(this.mdlStage.wells).map(function(e){return new r(e,this,this.defaultSlcData)},this)},l.prototype.addWellGroupWfmParameter=function(){var e=t.unwrap(this.slcWfmParameter);e&&this.mdlStage.postWfmParameterOfWroup(e.id,t.unwrap(e.defaultColor),t.unwrap(e.uom))},l.prototype.calcListOfVwmWfmParameterOfWroup=function(){return t.unwrap(this.mdlStage.listOfWfmParameterOfWroup).map(function(e){return new a(e)})};var u=function(e,t){var n=!1;return e.forEach(function(e){e.wfmParameterId===t.id&&(n=!0)}),!n};return l.prototype.calcUnselectedWfmParameterList=function(){return t.unwrap(this.mdlStage.getRootMdl().wfmParameterList).filter(u.bind(null,t.unwrap(this.mdlStage.listOfWfmParameterOfWroup)))},l.prototype.goToMonitoringOfWell=function(e){e.unzOfSlcVwmSectionWrk("well-monitoring"),e.loadSectionContent("well-monitoring"),this.activateVwmChild(e)},l.prototype.goToMonitoringOfWroup=function(){this.unzOfSlcVwmSectionWrk("wroup-monitoring"),this.loadSectionContent("wroup-monitoring"),this.getParentVwm().activateVwmChild(this)},l.prototype.reloadMonitoringRecords=function(){var e=t.unwrap(this.monitoringUnixTime);if(e){var n=t.unwrap(this.mdlStage.listOfMonitoredParams);n.length>0&&this.mdlStage.loadListOfScopeOfMonitoring(e,n)}},l}),define("viewmodels/wield",["jquery","knockout","helpers/modal-helper","helpers/app-helper","viewmodels/wroup","viewmodels/map-of-wield","base-viewmodels/stage-base"],function(e,t,n,i,r,o,a){var s=function(e,n,i){this.getParentVwm=function(){return n},this.defaultSlcData=i,this.mdlStage=e,this.unq=this.mdlStage.id,a.call(this,i.wieldSectionId,n.unqOfSlcVwmChild,i.wroupId),this.listOfVwmMapOfWield=t.computed({read:this.buildListOfVwmMapOfWield,deferEvaluation:!0,owner:this}),this.sortedListOfVwmMapOfWield=t.computed({read:this.getSortedVwmMaps,deferEvaluation:!0,owner:this}),this.vidOfSlcVwmMapOfWield=t.observable(),this.slcVwmMapOfWield=t.computed({read:this.getSlcVwmMapOfWield,deferEvaluation:!0,owner:this})
};return i.inherits(s,a),s.prototype.selectVwmMapOfWield=function(e){this.vidOfSlcVwmMapOfWield(e.vid)},s.prototype.loadSectionContent=function(e){switch(e){case"wield-map":this.mdlStage.loadMapsOfWield()}},s.prototype.getSortedVwmMaps=function(){return t.unwrap(this.listOfVwmMapOfWield).sort(function(e,n){return t.unwrap(e.mdlMapOfWield.name)>t.unwrap(n.mdlMapOfWield.name)})},s.prototype.addVwmWroup=function(){function t(){i.mdlStage.postWroup(e(r).val()),n.closeModalWindow()}var i=this,r=document.createElement("input");r.type="text",e(r).prop({required:!0}).addClass("form-control");var o=document.createElement("div");e(o).addClass("form-horizontal").append(n.gnrtDom("Name",r)),n.openModalWindow("Well group",o,t)},s.prototype.removeVwmMapOfWield=function(e){var n=e.mdlMapOfWield;confirm('Are you sure you want to delete "'+t.unwrap(n.name)+'"?')&&this.mdlStage.removeMapOfWield(n)},s.prototype.createMapFromFile=function(){function e(){n.fmgrModal.okError("");var e=t.unwrap(n.slcVwmSectionFmg);if(!e)throw new Error("No selected section");var i=t.unwrap(e.mdlSection.listOfFileSpec).filter(function(e){return t.unwrap(e.isSelected)});return 1!==i.length?void n.fmgrModal.okError("need to select one file"):void n.mdlStage.postMapOfWield(i[0].id,t.unwrap(i[0].name),function(){n.fmgrModal.hide()})}this.unzOfSlcVwmSectionFmg(this.mdlStage.stageKey+"-map");var n=this;n.fmgrModal.okCallback(e),n.fmgrModal.okDescription("Please select a file for a map"),n.fmgrModal.show()},s.prototype.getSlcVwmMapOfWield=function(){var e=t.unwrap(this.vidOfSlcVwmMapOfWield),n=t.unwrap(this.sortedListOfVwmMapOfWield);if(e)return n.filter(function(t){return t.vid===e})[0];var i=n[0];return i?(this.vidOfSlcVwmMapOfWield(i.vid),i):void 0},s.prototype.buildListOfVwmMapOfWield=function(){var e=this;return t.unwrap(this.mdlStage.WellFieldMaps).map(function(n){return new o(n,e.vidOfSlcVwmMapOfWield,t.observable({scale:1,translate:[0,0]}))})},s.prototype.buildListOfVwmChild=function(){var e=this;return t.unwrap(this.mdlStage.wroups).map(function(t){return new r(t,e,e.defaultSlcData)})},s}),define("viewmodels/wegion",["jquery","knockout","helpers/modal-helper","helpers/app-helper","viewmodels/wield","base-viewmodels/stage-base"],function(e,t,n,i,r,o){var a=function(e,t,n){this.mdlStage=e,this.defaultSlcData_=n,this.unq=this.mdlStage.id,this.getParentVwm=function(){return t},o.call(this,this.defaultSlcData_.wegionSectionId,t.unqOfSlcVwmChild,this.defaultSlcData_.wieldId)};return i.inherits(a,o),a.prototype.addVwmWield=function(){function t(){i.mdlStage.postWield(e(r).val()),n.closeModalWindow()}var i=this,r=document.createElement("input");r.type="text",e(r).prop({required:!0}).addClass("form-control");var o=document.createElement("div");e(o).addClass("form-horizontal").append(n.gnrtDom("Name",r)),n.openModalWindow("Well field",o,t)},a.prototype.buildListOfVwmChild=function(){return t.unwrap(this.mdlStage.wields).map(function(e){return new r(e,this,this.defaultSlcData_)},this)},a}),define("viewmodels/company",["jquery","knockout","helpers/app-helper","helpers/modal-helper","viewmodels/wegion","base-viewmodels/stage-base"],function(e,t,n,i,r,o){var a=function(e,t,n){this.getParentVwm=function(){return t},this.mdlStage=e,this.unq=this.mdlStage.id,this.defaultSlcData_=n,o.call(this,this.defaultSlcData_.companySectionId,t.unqOfSlcVwmChild,this.defaultSlcData_.wegionId)};return n.inherits(a,o),a.prototype.buildListOfVwmChild=function(){var e=t.unwrap(this.mdlStage.wegions);return e.map(function(e){return new r(e,this,this.defaultSlcData_)},this)},a.prototype.prePostVwmWegion=function(){var t=document.createElement("input");t.type="text";var n=e(t);n.prop({required:!0}).addClass("form-control");var r=document.createElement("div");e(r).addClass("form-horizontal").append(i.gnrtDom("Name",t)),i.openModalWindow("Well region",r,this.postVwmWegion.bind(this,n))},a.prototype.postVwmWegion=function(e){this.mdlStage.postWegion(e.val(),this.successPostVwmWegion.bind(this))},a.prototype.successPostVwmWegion=function(e){this.mdlStage.pushWegion(e),i.closeModalWindow()},a}),define("viewmodels/employee",["knockout","viewmodels/company"],function(e,t){var n=function(n,i,r){var o=this;this.mdlEmployee=n,this.vwmCompany=new t(o.mdlEmployee.company,i,r),this.unq=o.vwmCompany.unq,this.isEditMode=e.observable(!1),this.toggleEditMode=function(){o.mdlEmployee.canEditAll&&o.isEditMode(!e.unwrap(o.isEditMode))}};return n}),define("viewmodels/user-profile",["knockout","viewmodels/employee","helpers/app-helper","base-viewmodels/stage-base"],function(e,t,n,i){var r=function(t,n){this.defaultSlcData_=n,this.getParentVwm=function(){return null},this.mdlStage=t,this.unq=this.mdlStage.id,i.call(this,null,e.observable(this.unq),this.defaultSlcData_.companyId),this.mdlStage.loadEmployees()};return n.inherits(r,i),r.prototype.buildListOfVwmChild=function(){var n=e.unwrap(this.mdlStage.employees);return n.map(function(e){return new t(e,this,this.defaultSlcData_)},this)},r}),define("constants/global-css-constants",["require","exports","module"],function(e,t,n){t=[{path:"css/main-light.css",lbl:"Light theme"},{path:"css/main-dark.css",lbl:"Dark theme"}],n.exports=t}),define("viewmodels/workspace",["require","exports","module","jquery","knockout","helpers/history-helper","helpers/cookie-helper","viewmodels/user-profile","constants/global-css-constants"],function(e,t,n){function i(e){return e?JSON.parse('{"'+e.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(e,t){return""===e?t:decodeURIComponent(t)}):{}}function r(e,t){var n=i(t);console.log(n);var r={cache:!1,type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:"code="+n.code,xhrFields:{withCredentials:!0}};o.ajax("//wfm-report.herokuapp.com/api/session-manager",r).done(function(t){console.log("response from wfm-node",t),e()}).fail(function(e){console.log("error from wfm-node",e)})}var o=e("jquery"),a=e("knockout"),s=e("helpers/history-helper"),l=e("helpers/cookie-helper"),u=e("viewmodels/user-profile"),c=e("constants/global-css-constants"),d=function(e,t,n){var i,r=t.authWindow.location;try{i=r.href}catch(o){}if(console.log(i),i){var a=i.split("?");if(a[0].indexOf(e)>=0){var s=a[1];clearInterval(t.authInterval),t.authWindow.close(),n(s)}}},p=function(e){var t="//"+window.location.host;"//ivanrave.github.io"===t&&(t+="/wfm-client");var n=t+"/handle-auth-code.html",i={authWindow:null,authInterval:null};i.authInterval=setInterval(d.bind(null,n,i,e),1e3),i.authWindow=window.open("//petrohelp-auth.herokuapp.com/dialog/authorize?response_type=code&client_id=abc123&redirect_uri="+n,"_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes")};t=function(e){this.mdlWorkspace=e,this.isVisibleMenu=a.observable(!0),this.listOfGlobalCss=c,this.curGlobalCss=a.observable(null),this.curGlobalCss.subscribe(this.changeGlobalCss,this),this.sidebarWrapCss=a.computed({read:this.calcSidebarWrapCss,deferEvaluation:!0,owner:this}),this.workAreaCss=a.computed({read:this.calcWorkAreaCss,deferEvaluation:!0,owner:this}),this.sidebarToggleCss=a.computed({read:this.calcSidebarToggleCss,deferEvaluation:!0,owner:this}),this.isEmployeeInEditMode=a.computed({read:this.calcIsEmployeeInEditMode,deferEvaluation:!0,owner:this}),this.defaultSlcData_=s.getInitialData(document.location.hash.substring(1)),this.vwmUserProfile=a.computed({read:this.buildVwmUserProfile,deferEvaluation:!0,owner:this}),this.isLoginInProgress=a.observable(!1),this.mdlWorkspace.tryToLoadUserProfile()},t.prototype.openAuth=function(){var e=this;this.isLoginInProgress(!0),p(r.bind(null,function(){e.mdlWorkspace.setUserProfile({Id:null,Email:"todo@change.email",Roles:null}),e.isLoginInProgress(!1)}))},t.prototype.accountLogOff=function(){this.mdlWorkspace.accountLogOff()},t.prototype.buildVwmUserProfile=function(){var e=a.unwrap(this.mdlWorkspace.userProfile);return e?new u(e,this.defaultSlcData_):void 0},t.prototype.toggleIsVisibleMenu=function(){this.isVisibleMenu(!a.unwrap(this.isVisibleMenu))},t.prototype.calcIsEmployeeInEditMode=function(){var e=a.unwrap(this.vwmUserProfile);if(e){var t=a.unwrap(e.slcVwmChild);if(t)return a.unwrap(t.isEditMode)}},t.prototype.calcSidebarToggleCss=function(){return a.unwrap(this.isVisibleMenu)?"sidebar-toggle-visible":"sidebar-toggle-hidden"},t.prototype.calcWorkAreaCss=function(){return a.unwrap(this.isVisibleMenu)?"work-area":""},t.prototype.calcSidebarWrapCss=function(){return a.unwrap(this.isVisibleMenu)?"sidebar-wrap-visible":"hidden"},t.prototype.changeGlobalCss=function(e){if(e){var t=document.getElementById("wfm-style-link");t.href=e.path+"?0.9.9",l.createCookie("wfmstylelink",e.path,30)}},n.exports=t}),define("models/file-spec",["knockout","moment","helpers/file-helper"],function(e,t,n){var i=function(n){n=n||{},this.id=n.Id,this.fileUrl="//wfm-report.herokuapp.com"+n.FileUrl,this.name=e.observable(n.Name),this.extension=n.Extension,this.contentType=n.ContentType,this.createdUnixTime=n.CreatedUnixTime,this.length=n.Length,this.imgWidth=n.ImgWidth,this.imgHeight=n.ImgHeight,this.lengthInKb=parseInt(this.length/1024,10),this.fullTitle="Size: "+this.length+" bytes\nExtension: "+this.extension+"\nCreated: "+t(1e3*this.createdUnixTime).format("YYYY-MM-DD HH:mm:ss"),this.namePlusExtension=e.computed({read:this.calcNamePlusExtension,deferEvaluation:!0,owner:this}),this.isSelected=e.observable(!1)};return i.prototype.calcNamePlusExtension=function(){return e.unwrap(this.name)+e.unwrap(this.extension)},i.prototype.toPlainFileSpec=function(){return{Id:this.id,Name:e.unwrap(this.name),Extension:e.unwrap(this.extension),CreatedUnixTime:e.unwrap(this.createdUnixTime),Length:e.unwrap(this.length),ImgWidth:e.unwrap(this.imgWidth),ImgHeight:e.unwrap(this.imgHeight)}},i.prototype.download=function(){n.downloadURL(this.fileUrl)},i}),define("services/widget",["helpers/ajax-request","constants/stage-constants"],function(e,t){var n=function(e,n,i){if(!t[e])throw new ReferenceError("No such key for stage constants: "+e);return"//wfm-report.herokuapp.com/api/"+t[e].plural+"/widget-blocks/"+n+"/widgets"+(i?"/"+i:"")},i={get:function(t,i,r){return e("GET",n(t,i,r))},post:function(t,i,r){return e("POST",n(t,i),r)},put:function(t,i,r,o){return e("PUT",n(t,i,r),o)},remove:function(t,i,r){return e("DELETE",n(t,i,r))}};return i}),define("base-models/widget-base",["knockout","services/widget"],function(e,t){var n=function(t,n){t=t||{},this.getWidgock=function(){return n},this.id=t.Id,this.name=e.observable(t.Name),this.idOfSectionPattern=t.IdOfSectionPattern,this.widgockId=t.WidgockId,this.orderNumber=e.observable(t.OrderNumber);var i=this.idOfSectionPattern.split("-")[0];this.idOfCntxStage="company"!==i?parseInt(t.IdOfCntxStage):t.IdOfCntxStage,this.mdlStageContext=this.getWidgock().getWidgout().getParent().findCognateStage(i,this.idOfCntxStage),this.widgetTpl="widget-tpl-"+(this.idOfSectionPattern.indexOf("-summary")>0?"default-summary":this.idOfSectionPattern)};return n.prototype.putWidget=function(n){t.put(this.getWidgock().getWidgout().getParent().stageKey,this.widgockId,this.id,{id:e.unwrap(this.id),name:e.unwrap(this.name),idOfSectionPattern:e.unwrap(this.idOfSectionPattern),widgockId:e.unwrap(this.widgockId),orderNumber:e.unwrap(this.orderNumber),idOfCntxStage:this.idOfCntxStage,opts:this.toPlainOpts()}).done(n)},n}),define("models/widget-default-summary",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(e,t){n.call(this,e,t),this.tmpOpts=JSON.parse(e.Opts);var i=this.mdlStageContext.propSpecList;this.opts={},i.forEach(this.setPropSpec,this)};return t.inherits(i,n),i.prototype.setPropSpec=function(t){t.tpe&&(this.opts["isVis"+t.serverId]=e.observable(this.tmpOpts["isVis"+t.serverId]))},i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i}),define("models/widget-well-history",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(t,i){n.call(this,t,i);var r=JSON.parse(t.Opts);this.opts={startDate:e.observable(r.startDate),endDate:e.observable(r.endDate),jobTypeId:e.observable(r.jobTypeId),sortByDateOrder:e.observable(r.sortByDateOrder||-1)}};return t.inherits(i,n),i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i}),define("models/widget-well-map",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(t,i){n.call(this,t,i);var r=JSON.parse(t.Opts);this.opts={idOfSlcMapOfWield:e.observable(r.idOfSlcMapOfWield),transform:e.observable({scale:r.transform?r.transform.scale||1:1,translate:r.transform?r.transform.translate||[0,0]:[0,0]})},this.dictOfMapMarker=e.computed({read:this.buildDictOfMapMarker,deferEvaluation:!0,owner:this})};return t.inherits(i,n),i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i.prototype.buildDictOfMapMarker=function(){var t=e.unwrap(this.mdlStageContext.listOfMapMarker);return t.map(function(t){return{optValue:e.unwrap(t.idOfMapOfWield),optText:e.unwrap(t.nameOfMap)}})},i}),define("models/widget-well-monitoring",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(t,i){n.call(this,t,i);var r=JSON.parse(t.Opts);this.opts={startUnixTime:e.observable(r.startUnixTime),endUnixTime:e.observable(r.endUnixTime)}};return t.inherits(i,n),i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i}),define("models/widget-well-perfomance",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(t,i){n.call(this,t,i);var r=JSON.parse(t.Opts);this.opts={startYear:e.observable(r.startYear),endYear:e.observable(r.endYear),startMonth:e.observable(r.startMonth),endMonth:e.observable(r.endMonth),selectedAttrGroupId:e.observable(r.selectedAttrGroupId),isVisibleForecastData:e.observable(r.isVisibleForecastData)}};return t.inherits(i,n),i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i}),define("models/widget-well-sketch",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(t,i){n.call(this,t,i);var r=JSON.parse(t.Opts);this.opts={isVisImg:e.observable(r.isVisImg),isVisDescription:e.observable(r.isVisDescription)}};return t.inherits(i,n),i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i}),define("models/widget-wield-map",["knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=function(t,i){n.call(this,t,i);var r=JSON.parse(t.Opts);this.opts={idOfSlcMapOfWield:e.observable(r.idOfSlcMapOfWield),isVisName:e.observable(r.isVisName),isVisImg:e.observable(r.isVisImg),transform:e.observable({scale:r.transform?r.transform.scale||1:1,translate:r.transform?r.transform.translate||[0,0]:[0,0]})},this.dictOfMap=e.computed({read:this.getDictOfMap,deferEvaluation:!0,owner:this})};return t.inherits(i,n),i.prototype.toPlainOpts=function(){return e.toJSON(this.opts)},i.prototype.getDictOfMap=function(){console.log("mdl stage context from dict of map",this.mdlStageContext);var t=e.unwrap(this.mdlStageContext.WellFieldMaps);return t.map(function(t){return{optValue:e.unwrap(t.id),optText:e.unwrap(t.name)}})},i}),define("models/widget-wield-stat",["require","exports","module","knockout","helpers/app-helper","base-models/widget-base"],function(e,t,n){var i=e("knockout"),r=e("helpers/app-helper"),o=e("base-models/widget-base");t=function(e,t){o.call(this,e,t);var n=JSON.parse(e.Opts);this.opts={isVisWellActivity:i.observable(n.isVisWellActivity)},this.listOfWell=i.computed({read:this.mdlStageContext.calcListOfWell.bind(this.mdlStageContext),deferEvaluation:!0}),this.wellActivityData=i.computed({read:this.calcWellActivityData,deferEvaluation:!0,owner:this})},r.inherits(t,o),t.prototype.toPlainOpts=function(){return i.toJSON(this.opts)},t.prototype.calcWellActivityData=function(){var e=i.unwrap(this.listOfWell),t=0,n=0;return e.forEach(function(e){i.unwrap(e.IsActive)?t+=1:n+=1}),[{lbl:t||"",val:t,name:"Active wells",color:"#79a0c1"},{lbl:n||"",val:n,name:"Non-active wells",color:"#999"}]},n.exports=t}),define("models/widgock",["knockout","constants/stage-constants","services/widget","models/widget-default-summary","models/widget-well-history","models/widget-well-map","models/widget-well-monitoring","models/widget-well-perfomance","models/widget-well-sketch","models/widget-wield-map","models/widget-wield-stat"],function(e,t,n,i,r,o,a,s,l,u,c){var d=function(t,n){t=t||{},this.getWidgout=function(){return n},this.id=t.Id,this.orderNumber=e.observable(t.OrderNumber),this.columnCount=e.observable(t.ColumnCount),this.columnStyle=e.computed({read:this.calcColumnStyle,deferEvaluation:!0,owner:this}),this.widgetList=e.observableArray([]),this.importWidgetList(t.WidgetDtoList)};return d.prototype.importWidgetList=function(e){this.widgetList((e||[]).map(this.buildWidget,this))},d.prototype.calcColumnStyle=function(){return"col-md-"+e.unwrap(this.columnCount)},d.prototype.removeWidget=function(e){n.remove(this.getWidgout().getParent().stageKey,this.id,e.id).done(this.removeWidgetFromList.bind(this,e))},d.prototype.removeWidgetFromList=function(e){this.widgetList.remove(e)},d.prototype.addWidget=function(t,i,r,o){var a,s=e.unwrap(this.widgetList);a=s.length>0?e.unwrap(s[s.length-1].orderNumber):0;var l=this.getWidgout().getParent();n.post(l.stageKey,this.id,{Name:t,IdOfSectionPattern:i,OrderNumber:a+1,Opts:"{}",WidgockId:this.id,IdOfCntxStage:r}).done(o)},d.prototype.buildWidget=function(e){var n=this;switch(e.IdOfSectionPattern){case t.well.ptrn.summary:case t.wroup.ptrn.summary:case t.wield.ptrn.summary:case t.wegion.ptrn.summary:case t.company.ptrn.summary:return new i(e,n);case t.well.ptrn.perfomance:return new s(e,n);case t.well.ptrn.monitoring:return new a(e,n);case t.well.ptrn.history:return new r(e,n);case t.well.ptrn.map:return new o(e,n);case t.well.ptrn.sketch:return new l(e,n);case t.wield.ptrn.map:return new u(e,n);case t.wield.ptrn.stat:return new c(e,n)}},d}),define("services/report",["helpers/ajax-request"],function(e){var t=function(){return"//wfm-report.herokuapp.com/api/report"},n={post:function(n,i){return e("POST",t(),{idOfWidgout:n,nameOfReport:i})}};return n}),define("models/widgout",["knockout","models/widgock","services/widgout","services/report"],function(e,t,n,i){function r(e,n){return(e||[]).map(function(e){return new t(e,n)})}var o=function(t,n){t=t||{},this.getParent=function(){return n},this.id=t.Id,this.name=e.observable(t.Name),this.name.subscribe(this.saveWidgout,this),this.widgocks=e.observableArray(r(t.WidgockDtoList,this))};return o.prototype.saveWidgout=function(){var t=this.getParent().Id||this.getParent().id;n.put(this.getParent().stageKey,t,this.id,{id:this.id,name:e.unwrap(this.name)})},o.prototype.postReport=function(e,t,n){i.post(this.id,e).done(t).fail(n)},o}),define("base-models/stage-base",["knockout","models/file-spec","models/widgout","services/widgout"],function(e,t,n,i){function r(e,t){return(e||[]).map(function(e){return new n(e,t)})}var o=function(n){this.propSpecList.forEach(function(i){"FileLine"===i.tpe?(this[i.clientId]=e.observable(),n[i.serverId]&&this[i.clientId](new t(n[i.serverId]))):this[i.clientId]=e.observable(n[i.serverId])},this),this.listOfSection=e.observableArray(),this.stagePatterns=e.computed({read:this.calcStagePatterns,deferEvaluation:!0,owner:this}),this.widgouts=e.observableArray([]).trackHasItems(),this.isLoadedWidgouts=e.observable(!1),this.widgoutTemplates=i.getWidgoutTemplates(),this.slcWidgoutTemplate=e.observable(),this.reportSection=e.computed({read:this.calcReportSection,owner:this,deferEvaluation:!0})};return o.prototype.getPropSpecByClientId=function(e){var t=this.propSpecList.filter(function(t){return t.clientId===e});return t[0]},o.prototype.deleteImgFileSpec=function(e){this[e.addtData.nestedClientId](null),this[e.clientId](null),this.save()},o.prototype.postWidgout=function(){var t=this,r=e.unwrap(this.slcWidgoutTemplate);r&&i.post(t.stageKey,t.id||t.Id,r).done(function(e){var i=new n(e,t);t.widgouts.push(i),t.slcWidgoutTemplate(null)})},o.prototype.removeWidgout=function(e){var t=this;i.remove(t.stageKey,t.id||t.Id,e.id).done(function(){t.widgouts.remove(e)})},o.prototype.loadWidgouts=function(){var t=this;e.unwrap(t.isLoadedWidgouts)||i.get(t.stageKey,t.id||t.Id).done(function(e){t.widgouts(r(e,t)),t.isLoadedWidgouts(!0)})},o.prototype.calcStagePatterns=function(){var t=e.unwrap(this.getRootMdl().ListOfSectionPatternDto);return t},o.prototype.getListOfStageByKey=function(){throw new Error("need to ovveride in sub-classes")},o.prototype.findCognateStage=function(e,t){return this.getListOfStageByKey(e).filter(function(e){return e.id===t})[0]},o.prototype.removeChild=function(){throw new Error("Need to override in a subclass")},o.prototype.getIdOfCompany=function(){throw new Error("Need to override in a subclass")},o.prototype.calcReportSection=function(){return e.unwrap(this.listOfSection).filter(function(e){return e.sectionPatternId===this.stageKey+"-report"},this)[0]},o}),define("services/map-of-wield",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/well-fields/"+e+"/maps"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/area-of-map-of-wield",["jquery","knockout","services/datacontext","helpers/app-helper"],function(e,t,n,i){function r(r,o){var a=this;r=r||{},a.getWellFieldMap=function(){return o},a.Id=r.Id,a.Name=t.observable(r.Name),a.Description=t.observable(r.Description),a.Coords=t.observable(r.Coords),a.WellFieldMapId=r.WellFieldMapId,a.Opacity=t.observable(r.Opacity),a.StrokeWidth=t.observable(r.StrokeWidth),a.FillColor=t.observable(r.FillColor);var s=255,l=Math.max(a.getWellFieldMap().Width,a.getWellFieldMap().Height)/s;a.coordsFromTopLeft=t.computed(function(){var t=[];return e.each(a.Coords().split(" "),function(e,n){var i=n.split(","),r=parseFloat(i[0]),o=parseFloat(i[1]),a=o*l,u=(s-r)*l;t.push([a,u])}),t}),a.deleteWellFieldMapArea=function(){n.deleteWellFieldMapArea(a).done(function(){a.getWellFieldMap().WellFieldMapAreas.remove(a)})},a.saveChangedWellFieldMapArea=function(){n.saveChangedWellFieldMapArea(a)},a.areaSize=t.computed(function(){var e=Math.pow(a.getWellFieldMap().ScaleCoefficient(),2),t=i.getArea(i.stringToTwoDimArray(a.Coords()));return t/=Math.pow(.3048,2),t*e}),a.toPlainJson=function(){return t.toJS(a)}}n.createWellFieldMapArea=function(e,t){return new r(e,t)}}),define("services/well-marker-of-map-of-wield",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/well-fields/maps/"+e+"/well-markers"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/well-marker-of-map-of-wield",["knockout","services/well-marker-of-map-of-wield"],function(e,t){var n=function(t,n){t=t||{},this.getWellFieldMap=function(){return n},this.coords=e.observable([t.CoordX,t.CoordY]),this.isDrilled=e.observable(t.IsDrilled),this.idOfMapOfWield=t.IdOfMapOfWield,this.idOfWell=t.IdOfWell,this.markerStyle=e.computed({read:this.calcMarkerStyle,deferEvaluation:!0,owner:this}),this.wellName=e.computed({read:this.calcWellName,deferEvaluation:!0,owner:this}),this.nameOfMap=e.computed({read:this.calcNameOfMap,deferEvaluation:!0,owner:this}),this.coords.subscribe(this.save,this)};return n.prototype.calcNameOfMap=function(){return e.unwrap(this.getWellFieldMap().name)},n.prototype.save=function(){var n=this;t.put(n.idOfMapOfWield,n.idOfWell,{IdOfMapOfWield:n.idOfMapOfWield,IdOfWell:n.idOfWell,CoordX:e.unwrap(n.coords)[0],CoordY:e.unwrap(n.coords)[1],IsDrilled:e.unwrap(n.isDrilled)})},n.prototype.calcMarkerStyle=function(){var t=e.unwrap(this.isDrilled);return t===!0?"well-marker_drilled":t===!1?"well-marker_non-drilled":"well-marker_pre-created"},n.prototype.calcWellName=function(){var t=this.getWell();return t?e.unwrap(t.Name):void 0},n.prototype.getWell=function(){for(var t=this.getWellFieldMap().getWellField(),n=e.unwrap(t.wroups),i=this.idOfWell,r=0;r<n.length;r+=1)for(var o=e.unwrap(n[r].wells),a=0;a<o.length;a+=1)if(o[a].id===i)return o[a];return null},n}),define("models/map-of-wield",["jquery","knockout","services/datacontext","helpers/modal-helper","helpers/app-helper","models/file-spec","services/map-of-wield","viewmodels/map-of-wield","models/area-of-map-of-wield","models/well-marker-of-map-of-wield","services/well-marker-of-map-of-wield"],function(e,t,n,i,r,o,a,s,l,u,c){function d(e,t){return(e||[]).map(function(e){return n.createWellFieldMapArea(e,t)})}function p(e,t){return(e||[]).map(function(e){return new u(e,t)})}var f=function(e,n){e=e||{},this.getWellField=function(){return n},this.id=e.Id,this.name=t.observable(e.Name),this.idOfFileSpec=e.IdOfFileSpec,this.fileSpec=new o(e.FileSpecDto),this.description=t.observable(e.Description),this.scaleCoefficient=t.observable(e.ScaleCoefficient),this.idOfWield=e.WellFieldId,this.areas=t.observableArray(),this.wellMarkers=t.observableArray(),this.outWellsOfWield=t.computed({read:this.getOutWellsOfWield,deferEvaluation:!0,owner:this}),this.wellMarkers(p(e.ListOfDtoOfWellMarker,this)),this.areas(d(e.WellFieldMapAreasDto,this))};return f.prototype.postWellMarker=function(e,t,n){var i=this;c.post(i.id,{IdOfWell:e,IdOfMapOfWield:i.id,CoordX:t[0],CoordY:t[1],IsDrilled:n}).done(function(e){i.wellMarkers.push(new u(e,i))})},f.prototype.removeWellMarker=function(e){var t=this;c.remove(t.id,e.idOfWell).done(function(){t.wellMarkers.remove(e)})},f.prototype.toPlainJson=function(){return t.toJS(this)},f.prototype.editWellFieldMap=function(){function n(){r.name(e(o).val()),r.description(e(s).val()),r.scaleCoefficient(e(l).val()),a.put(r.idOfWield,r.id,r.toPlainJson()).done(function(e){r.name(e.Name),r.description(e.Description),r.scaleCoefficient(e.ScaleCoefficient)}),i.closeModalWindow()}var r=this,o=document.createElement("input");o.type="text",e(o).val(t.unwrap(r.name)).prop({required:!0});var s=document.createElement("input");s.type="text",e(s).val(t.unwrap(r.description));var l=document.createElement("input");l.type="text",e(l).val(t.unwrap(r.scaleCoefficient)).prop({required:!0});var u=document.createElement("div");e(u).addClass("form-horizontal").append(i.gnrtDom("Name",o),i.gnrtDom("Description",s),i.gnrtDom("ScaleCoefficient, 1:",l)),i.openModalWindow("Well field map",u,n)},f.prototype.getOutWellsOfWield=function(){var n=this,i=t.unwrap(n.wellMarkers),r=i.map(function(e){return e.idOfWell}),o=t.unwrap(n.getWellField().wroups),a=[];return o.forEach(function(e){a=a.concat(t.unwrap(e.wells))}),a.filter(function(t){return-1===e.inArray(t.id,r)})},f}),define("services/file-spec",["constants/stage-constants","helpers/ajax-request"],function(e,t){var n=function(t,n,i){var r=e[t].plural;return"//wfm-report.herokuapp.com/api/"+r+"/sections/"+n+"/file-specs"+(i?"/"+i:"")},i={getUrl:function(e,t,i){return n(e,t,i)},get:function(e,i){return t("GET",n(e,i))},getColumnAttributes:function(e,i,r){return t("GET",n(e,i,r)+"/column-attributes")},getPerfomanceFragment:function(e,i,r,o,a){return t("GET",n(e,i,r)+"/perfomance-fragment/"+o+"/"+a)},postPerfomanceData:function(e,i,r,o,a){return t("POST",n(e,i,r)+"/perfomance-data/"+o,a)},put:function(e,i,r,o){return t("PUT",n(e,i,r),o)},deleteArray:function(e,i,r){return t("DELETE",n(e,i),r)}};return i}),define("models/pre-file",["knockout"],function(e){var t=function(t,n,i,r,o,a){this.name=t,this.size=n,this.sizeInKb=parseInt(100*this.size/1024,10)/100,this.sizeInMb=parseInt(100*this.size/1024/1024,10)/100,this.contentType=i,this.bytesLoaded=e.observable(0),this.bytesLoadedInKb=e.computed({read:this.calcBytesLoadedInKb,deferEvaluation:!0,owner:this}),this.progressPercent=e.computed({read:this.calcProgressPercent,deferEvaluation:!0,owner:this}),this.progressPercentString=e.computed({read:this.calcProgressPercentString,deferEvaluation:!0,owner:this}),this.maxSize=o,this.regExpString=r,this.supportedTypes=this.regExpString.replace(/[\\,\$,\^]/g,"").split("|").join(", "),this.isSuccessType=new RegExp(this.regExpString).test(this.contentType)===!0,this.isSuccessSize=this.size<=this.maxSize,this.isSuccess=this.isSuccessSize&&this.isSuccessType,this.abortUploading=function(){console.log("abort callback"),a()}};return t.prototype.calcProgressPercent=function(){return parseInt(e.unwrap(this.bytesLoaded)/this.size*100,10)},t.prototype.calcBytesLoadedInKb=function(){return parseInt(e.unwrap(this.bytesLoaded)/1024*100,10)/100},t.prototype.calcProgressPercentString=function(){return e.unwrap(this.progressPercent)+"%"},t}),define("models/section-of-stage",["knockout","constants/stage-constants","helpers/app-helper","models/file-spec","services/file-spec","models/pre-file"],function(e,t,n,i,r,o){function a(e){return(e||[]).map(function(e){return new i(e)})}var s=function(n,i,r){this.getParent=function(){return i},this.idOfParentStage=r,this.stageKey=this.getParent().stageKey,this.id=n.Id,this.isVisible=e.observable(n.IsVisible),this.sectionPatternId=n.SectionPatternId,this.sectionPattern=e.computed({read:this.calcSectionPattern,deferEvaluation:!0,owner:this}),this.isSectionPatternIdIsWellPerfomance=this.sectionPatternId===t.well.ptrn.perfomance,this.isSectionPatternIdIsWellSketch=this.sectionPatternId===t.well.ptrn.sketch,this.isSectionPatternIdIsWellVolume=this.sectionPatternId===t.well.ptrn.volume,this.isVisibleAsView=e.computed({read:this.calcIsVisibleAsView,deferEvaluation:!0,owner:this}),this.listOfFileSpec=e.observableArray([]),this.listOfPreFile=e.observableArray([]),this.readyListOfFileSpec=e.computed({read:this.buildReadyListOfFileSpec,deferEvaluation:!0,owner:this}).trackHasItems(),this.isLoadedListOfFileSpec=e.observable(!1),this.listOfSlcFileSpec=e.computed({read:this.calcListOfSlcFileSpec,deferEvaluation:!0,owner:this}),this.maxSizeOfFile=10485760,this.maxSizeOfFileInMb=this.maxSizeOfFile/1024/1024,this.isSlcAllFiles=e.computed({read:this.calcIsSlcAllFiles,write:this.setIsSlcAllFiles,deferEvaluation:!0,owner:this})};return s.prototype.setIsSlcAllFiles=function(t){e.unwrap(this.listOfFileSpec).forEach(function(e){e.isSelected(t)})},s.prototype.updateSectionAfterRemovingFiles=function(e){switch(e){case"well-volume":this.getParent().isLoadedVolumes(!1),this.getParent().loadVolumes();break;case"well-sketch":this.getParent().sketchOfWell.isLoaded(!1),this.getParent().sketchOfWell.load();break;case"well-history":this.getParent().isLoadedHistoryList(!1),this.getParent().loadWellHistoryList()}},s.prototype.calcListOfSlcFileSpec=function(){return e.unwrap(this.listOfFileSpec).filter(function(t){return e.unwrap(t.isSelected)})},s.prototype.removeSlcFileSpecs=function(e){var t=e.map(function(e){return{id:e.id}}),n=this;r.deleteArray(n.stageKey,n.id,t).done(function(){e.forEach(function(e){n.listOfFileSpec.remove(e),n.updateSectionAfterRemovingFiles(n.sectionPatternId)})})},s.prototype.getFileSpecById=function(t){return e.unwrap(this.listOfFileSpec).filter(function(e){return e.id===t})[0]},s.prototype.deleteFileSpecById=function(e,t){var n=this;r.deleteArray(this.stageKey,this.id,[{id:e}]).done(function(){var i=n.getFileSpecById(e);i&&n.listOfFileSpec.remove(i),t&&t()})},s.prototype.saveFileSpec=function(e){r.put(this.stageKey,this.id,e.id,e.toPlainFileSpec())},s.prototype.loadListOfFileSpec=function(){return console.log("load list of file specs"),e.unwrap(this.isLoadedListOfFileSpec)?void e.unwrap(this.listOfFileSpec).forEach(function(e){e.isSelected(!1)}):void r.get(this.stageKey,this.id).done(this.scsLoadListOfFileSpec.bind(this))},s.prototype.scsLoadListOfFileSpec=function(e){this.listOfFileSpec(a(e)),this.isLoadedListOfFileSpec(!0)},s.prototype.buildReadyListOfFileSpec=function(){var t=e.unwrap(this.listOfFileSpec);return t.sort(function(e,t){return t.createdUnixTime-e.createdUnixTime})},s.prototype.calcSectionPattern=function(){var t=e.unwrap(this.getParent().stagePatterns),n=this.sectionPatternId,i=t.filter(function(e){return e.id===n
});return 1===i.length?i[0]:void 0},s.prototype.calcIsVisibleAsView=function(){var t=e.unwrap(this.sectionPattern),n=e.unwrap(this.isVisible);return t?t.isView&&n:!1},s.prototype.getSectionFiloader=function(){var t=this,n=100,a=e.unwrap(t.sectionPattern).fileTypeRegExp,s=this.maxSizeOfFile;return{url:r.getUrl(t.stageKey,this.id),addCallback:function(e){var r=e.files[0];if(!r)throw new Error("No file is selected");var l=new o(r.name,r.size,r.type,a,s,function(){e.abort()});if(t.listOfPreFile.push(l),console.log("tmpPreFile",l,e),l.isSuccess!==!1){console.log("successful upload");var u=window.setInterval(function(){l.bytesLoaded(e._progress.loaded),e._progress.loaded===l.size&&window.clearInterval(u)},n);e.submit().done(function(e){t.listOfPreFile.remove(l),t.listOfFileSpec.push(new i(e[0]))}).fail(function(e,n,i){window.clearInterval(u),"abort"===n?t.listOfPreFile.remove(l):(console.log(e,n,i),alert(n+": "+e.responseText+" ("+i+")"))})}}}},s.prototype.removePreFile=function(e){console.log("remove a pre file"),this.listOfPreFile.remove(e)},s.prototype.calcIsSlcAllFiles=function(){var t=e.unwrap(this.listOfFileSpec);return 0===t.length?!1:0===t.filter(function(t){return e.unwrap(t.isSelected)===!1}).length},s}),define("models/production-data",["jquery","knockout","services/datacontext","moment"],function(e,t,n,i){function r(n,i){if("LiquidRate"===n){var r=t.unwrap(i.OilRate),o=t.unwrap(i.WaterRate);return e.isNumeric(r)===!1?{error:{msg:"required as a number",param:"OilRate",mainParam:"LiquidRate"}}:e.isNumeric(o)===!1?{error:{msg:"required as a number",param:"WaterRate",mainParam:"LiquidRate"}}:{response:r+o}}if("WaterRate"===n){var a=t.unwrap(i.LiquidRate),s=t.unwrap(i.WaterCut);return e.isNumeric(a)===!1?{error:{msg:"required as a number",param:"LiquidRate",mainParam:"WaterRate"}}:e.isNumeric(s)===!1?{error:{msg:"required as a number",param:"WaterCut",mainParam:"WaterRate"}}:{response:a*(s/100)}}if("GOR"===n){var l=t.unwrap(i.GasRate),u=t.unwrap(i.OilRate);return e.isNumeric(l)===!1?{error:{msg:"required as a number",param:"GasRate",mainParam:"GOR"}}:e.isNumeric(u)===!1?{error:{msg:"required as a number",param:"OilRate",mainParam:"GOR"}}:0===u?{error:{msg:"can not be 0",param:"OilRate",mainParam:"GOR"}}:{response:l/u}}if("OilCum"===n||"WaterCum"===n||"LiquidCum"===n||"GasCum"===n){var c=n.replace("Cum","Rate"),d=t.unwrap(i[c]);if(e.isNumeric(d)===!1)return{error:{msg:"required as a number",param:c,mainParam:n}};for(var p=t.unwrap(i.getWell().perfomanceOfWell.hstProductionDataSet),f=0,h=0,m=p.length;m>h;h+=1)p[h].unixTime<=i.unixTime&&(f+=parseInt(p[h].ProdDays,10)*parseFloat(t.unwrap(p[h][c])));return{response:f}}}var o=["LiquidRate","WaterRate","OilCum","WaterCum","LiquidCum","GasCum","GOR"],a=function(n,a){var s=this;n=n||{},s.getWell=function(){return a},s.unixTime=n.UnixTime,s.WellId=n.WellId,s.ProdDays=n.ProdDays,s.prfYear=new Date(1e3*s.unixTime).getFullYear(),s.prfMonthStr=i(1e3*s.unixTime).format("MMM"),s.isForecast=n.IsForecast;for(var l in n.Dict)n.Dict.hasOwnProperty(l)&&-1===e.inArray(o,l)&&(e.isNumeric(n.Dict[l])?s[l]=t.observable(+n.Dict[l]):console.log("Production data parameter is not float ["+l+": "+n.Dict[l]+"]"));e.each(o,function(i,o){s[o]=t.computed({read:function(){var i=e.grep(t.unwrap(s.getWell().getWellGroup().listOfWfmParameterOfWroup),function(e){return e.wfmParameterId===o})[0];if(i){if(t.unwrap(i.isCalc)!==!1){var a=r(o,s);return a.error?(i.isCalc(!1),console.log(i.isCalc()),void alert(a.error.mainParam+" calculation: "+a.error.param+" "+a.error.msg)):a.response}if("undefined"!=typeof n.Dict[o]){if(e.isNumeric(n.Dict[o]))return+n.Dict[o];console.log("Production data parameter is not float ["+o+": "+n.Dict[o]+"]")}}},deferEvaluation:!0})}),s.toPlainJson=function(){return t.toJS(s)}};return a}),define("models/forecast-evolution",["jquery","knockout","services/datacontext"],function(e,t,n){var i={desc:{LiquidEvolutionA:"Liquid evolution A",LiquidEvolutionB:"Liquid evolution B",WctEvolutionC:"WCT evolution C",WctEvolutionD:"WCT evolution D",GorEvolutionF:"GOR evolution F",GorEvolutionG:"GOR evolution G"},format:{LiquidEvolutionA:"A * exp(B*X)",LiquidEvolutionB:"A * exp(B*X)",WctEvolutionC:"C * Ln(X) - D",WctEvolutionD:"C * Ln(X) - D",GorEvolutionF:"F * Ln(X) + G",GorEvolutionG:"F * Ln(X) + G"}},r=function(r,o){var a=this;r=r||{},a.getWell=function(){return o},a.WellId=r.WellId,a.Dict=t.observable({}),a.save=function(){n.postForecastEvolution(a)},a.Lib=i,a.EvoList=Object.keys(a.Lib.desc),e.each(a.EvoList,function(e,n){a.Dict()[n]=t.observable()}),a.isLoadedDict=t.observable(!1),a.getDict=function(){t.unwrap(a.isLoadedDict)||n.getForecastEvolution(a.WellId).done(function(n){e.each(a.EvoList,function(e,i){t.unwrap(a.Dict)[i](n.Dict[i])}),a.isLoadedDict(!0)})},a.requiredForecastEvoListNaN=t.computed({read:function(){var n=t.unwrap(a.Dict);return e.grep(a.EvoList,function(i){return e.isNumeric(t.unwrap(n[i]))===!1})},deferEvaluation:!0}),a.requiredForecastEvoListNaNString=t.computed(function(){return t.unwrap(a.requiredForecastEvoListNaN).join(", ")}),a.toPlainJson=function(){return t.toJS(a)}};return r}),define("models/perfomance-of-well",["jquery","knockout","services/datacontext","services/file-spec","helpers/app-helper","moment","models/production-data","models/forecast-evolution"],function(e,t,n,i,r,o,a,s){function l(e,t){return(e||[]).map(function(e){return new a(e,t)})}var u=function(u){var c=this;c.getWellObj=function(){return u},c.hstProductionDataSet=t.observableArray(),c.isLoadedHstProductionData=t.observable(!1),c.prdColumnAttributeList=t.observableArray(),c.deleteWellProductionData=function(){n.deleteWellProductionData(u.id).done(function(){c.hstProductionDataSet([])})},c.getPerfomanceFragment=function(e,t,n,r,o,a){i.getPerfomanceFragment(e,t,n,r,o).done(function(e){a(e)})},c.postPerfomanceData=function(e,t,n,r,o,a,s){i.postPerfomanceData(e,t,n,r,o).done(a).fail(s)},c.forecastEvolution=new s({WellId:u.Id}),c.forecastDayCount=t.observable(3600),c.LastProductionData=t.computed({read:function(){return t.unwrap(c.hstProductionDataSet)[0]},deferEvaluation:!0}),c.isVisibleForecastPanel=t.observable(!1),c.DZADiffLiquid=t.computed({read:function(){if(t.unwrap(c.LastProductionData)){var n=t.unwrap(t.unwrap(c.LastProductionData).LiquidCum);if(e.isNumeric(n)){var i=t.unwrap(t.unwrap(c.forecastEvolution).Dict),r=t.unwrap(i.LiquidEvolutionA),o=t.unwrap(i.LiquidEvolutionB);if(e.isNumeric(r)===!0&&e.isNumeric(o)===!0)return+r*Math.exp(+o*+n)}}},deferEvaluation:!0}),c.DZADiffLiquidResult=t.computed({read:function(){var n=t.unwrap(c.DZADiffLiquid);if(e.isNumeric(n)){var i=t.unwrap(t.unwrap(c.LastProductionData).LiquidRate);if(e.isNumeric(i))return+n-+i}},deferEvaluation:!0}),c.DZADiffWCT=t.computed({read:function(){if(t.unwrap(c.LastProductionData)){var n=t.unwrap(t.unwrap(c.LastProductionData).OilCum);if(e.isNumeric(n)){var i=t.unwrap(t.unwrap(c.forecastEvolution).Dict),r=t.unwrap(i.WctEvolutionC),o=t.unwrap(i.WctEvolutionD);if(e.isNumeric(r)&&e.isNumeric(o))return+r*Math.log(+n)-+o}}},deferEvaluation:!0}),c.DZADiffWCTResult=t.computed({read:function(){var n=t.unwrap(c.DZADiffWCT);if(e.isNumeric(n)){var i=t.unwrap(t.unwrap(c.LastProductionData).WaterCut);if(e.isNumeric(i))return+n-+i}},deferEvaluation:!0}),c.DZADiffGOR=t.computed({read:function(){if(t.unwrap(c.LastProductionData)){var n=t.unwrap(t.unwrap(c.LastProductionData).OilCum);if(e.isNumeric(n)){var i=t.unwrap(t.unwrap(c.forecastEvolution).Dict),r=t.unwrap(i.GorEvolutionF),o=t.unwrap(i.GorEvolutionG);if(e.isNumeric(r)&&e.isNumeric(o))return+r*Math.log(+n)+ +o}}},deferEvaluation:!0}),c.DZADiffGORResult=t.computed({read:function(){var n=t.unwrap(c.DZADiffGOR);if(e.isNumeric(n)){var i=t.unwrap(t.unwrap(c.LastProductionData).GOR);if(e.isNumeric(i))return+n-+i}},deferEvaluation:!0}),c.requiredForecastParamListNaN=t.computed({read:function(){var n=t.unwrap(c.LastProductionData),i=["OilCum","WaterCum","GasCum","LiquidRate","LiquidCum","GOR"];return n?e.grep(i,function(i){return e.isNumeric(t.unwrap(n[i]))===!1}):i},deferEvaluation:!0}),c.requiredForecastParamListNaNString=t.computed({read:function(){return t.unwrap(c.requiredForecastParamListNaN).join(", ")},deferEvaluation:!0}),c.firstForecastPd=t.computed({read:function(){var n=t.unwrap(c.LastProductionData);if(n&&!(t.unwrap(c.requiredForecastParamListNaN).length>0||t.unwrap(c.forecastEvolution.requiredForecastEvoListNaN).length>0)){if(e.isNumeric(t.unwrap(c.DZADiffLiquidResult))===!1)return void console.log("DZADiffLiquidResult is not number");if(e.isNumeric(t.unwrap(c.DZADiffWCTResult))===!1)return void console.log("DZADiffWCTResult is not number");if(e.isNumeric(t.unwrap(c.DZADiffGORResult))===!1)return void console.log("DZADiffGORResult is not number");var i={OilCum:+t.unwrap(n.OilCum),GasCum:+t.unwrap(n.GasCum),WaterCum:+t.unwrap(n.WaterCum)},r=t.unwrap(t.unwrap(c.forecastEvolution).Dict),o=+t.unwrap(r.LiquidEvolutionA),s=+t.unwrap(r.LiquidEvolutionB),l=+t.unwrap(r.WctEvolutionC),d=+t.unwrap(r.WctEvolutionD),p=+t.unwrap(r.GorEvolutionF),f=+t.unwrap(r.GorEvolutionG),h=+t.unwrap(c.DZADiffLiquidResult),m=+t.unwrap(c.DZADiffWCTResult),g=+t.unwrap(c.DZADiffGORResult);return i.LiquidCum=i.OilCum+i.WaterCum,i.LiquidRate=o*Math.exp(s*i.LiquidCum)-h,i.WaterCut=l*Math.log(i.OilCum)-d-m,i.OilRate=(100-i.WaterCut)*i.LiquidRate/100,i.WaterRate=i.LiquidRate-i.OilRate,i.GOR=p*Math.log(i.OilCum)+f-g,i.GasRate=i.GOR*i.OilRate,new a({WellId:+t.unwrap(u.Id),UnixTime:+t.unwrap(n.unixTime),ProdDays:+t.unwrap(n.ProdDays),Dict:i,IsForecast:!0},u)}},deferEvaluation:!0}),c.startForecastUnixTime=t.computed({read:function(){var e=t.unwrap(c.firstForecastPd);return e?e.unixTime+24*e.ProdDays*60*60:void 0},deferEvaluation:!0}),c.endForecastUnixTime=t.computed({read:function(){return t.unwrap(c.startForecastUnixTime)?t.unwrap(c.startForecastUnixTime)+24*t.unwrap(c.forecastDayCount)*60*60:void 0},deferEvaluation:!0}),c.histYearList=t.computed({read:function(){var e=[],n=t.unwrap(c.hstProductionDataSet),i=n.length;if(i>0)for(var r=new Date(1e3*t.unwrap(n[i-1].unixTime)),o=new Date(1e3*t.unwrap(n[0].unixTime)),a=o.getFullYear(),s=r.getFullYear();a>=s;a-=1)e.push(a);return e},deferEvaluation:!0}),c.forecastYearList=t.computed({read:function(){var e=[],n=t.unwrap(c.startForecastUnixTime),i=t.unwrap(c.endForecastUnixTime);return n&&i&&(e=r.getYearList(new Date(1e3*n).getFullYear()+1,new Date(1e3*i).getFullYear())),e},deferEvaluation:!0}),c.getHstProductionDataSet=function(){t.unwrap(c.isLoadedHstProductionData)||n.getProductionData({well_id:u.Id}).done(function(e){c.hstProductionDataSet(l(e,u)),console.log("prodData",c.hstProductionDataSet()),c.isLoadedHstProductionData(!0)})},c.isForecastPossible=t.computed({read:function(){return t.unwrap(c.firstForecastPd)?!0:!1},deferEvaluation:!0}),c.dcaProductionDataSet=t.computed({read:function(){var e=[],n=t.unwrap(c.firstForecastPd);if(n){e.push(n);for(var i=+t.unwrap(c.startForecastUnixTime),r=+t.unwrap(c.endForecastUnixTime),s=t.unwrap(t.unwrap(c.forecastEvolution).Dict),l=+t.unwrap(s.LiquidEvolutionA),d=+t.unwrap(s.LiquidEvolutionB),p=+t.unwrap(s.WctEvolutionC),f=+t.unwrap(s.WctEvolutionD),h=+t.unwrap(s.GorEvolutionF),m=+t.unwrap(s.GorEvolutionG),g=+t.unwrap(c.DZADiffLiquidResult),w=+t.unwrap(c.DZADiffWCTResult),v=+t.unwrap(c.DZADiffGORResult),y=i;r>y;){var b=o(1e3*y).daysInMonth(),S={};S.LiquidRate=l*Math.exp(d*+t.unwrap(n.LiquidCum))-g,S.WaterCut=p*Math.log(+t.unwrap(n.OilCum))-f-w,S.OilRate=(100-S.WaterCut)*S.LiquidRate/100,S.WaterRate=S.LiquidRate-S.OilRate,S.OilCum=+t.unwrap(n.OilCum)+b*S.OilRate,S.GOR=h*Math.log(S.OilCum)+m-v,S.GasRate=S.GOR*S.OilRate,S.GasCum=+t.unwrap(n.GasCum)+S.GasRate*b,S.WaterCum=+t.unwrap(n.WaterCum)+S.WaterRate*b,S.LiquidCum=S.WaterCum+S.OilCum,n=new a({UnixTime:y,ProdDays:b,Dict:S,IsForecast:!0},u),e.unshift(n),y+=24*b*60*60}}return e},deferEvaluation:!0})};return u}),define("services/sketch-of-well",["helpers/ajax-request"],function(e){function t(e){return"//wfm-report.herokuapp.com/api/wells/"+e+"/sketches"}var n={get:function(n){return e("GET",t(n))},put:function(n,i){return e("PUT",t(n),i)},remove:function(n){return e("DELETE",t(n))}};return n}),define("models/sketch-of-well",["knockout","models/file-spec","services/sketch-of-well"],function(e,t,n){var i=function(i){var r=this;this.getWell=function(){return i},this.idOfWell=r.getWell().Id,this.idOfFileSpec=e.observable(),this.fileSpec=e.observable(),this.name=e.observable(),this.description=e.observable(),this.isLoaded=e.observable(!1),this.load=function(){e.unwrap(r.isLoaded)||n.get(r.idOfWell).done(function(e){if(e.length>0){var n=e[0];r.name(n.Name),r.description(n.Description),r.idOfFileSpec(n.IdOfFileSpec),r.fileSpec(new t(n.FileSpecDto))}else r.name(null),r.description(null),r.idOfFileSpec(null),r.fileSpec(null);r.isLoaded(!0)})},this.save=function(){n.put(r.idOfWell,{idOfWell:r.idOfWell,idOfFileSpec:e.unwrap(r.idOfFileSpec),name:e.unwrap(r.name),description:e.unwrap(r.description)}).done(function(e){r.name(e.Name),r.description(e.Description),r.idOfFileSpec(e.IdOfFileSpec),r.fileSpec(new t(e.FileSpecDto))})},this.clearSketchOfWell=function(){confirm('Are you sure you want to delete "'+e.unwrap(r.name)+'"?')&&n.remove(r.idOfWell).done(function(){r.name(null),r.description(null),r.idOfFileSpec(null),r.fileSpec(null)})},this.putSketchOfWell=function(i,o,a){n.put(r.idOfWell,{idOfWell:r.idOfWell,idOfFileSpec:i,name:o||"",description:e.unwrap(r.description)||""}).done(function(e){r.name(e.Name),r.description(e.Description),r.idOfFileSpec(e.IdOfFileSpec),r.fileSpec(new t(e.FileSpecDto)),a()})}};return i}),define("models/prop-spec",[],function(){var e=function(e,t,n,i,r){this.clientId=e,this.serverId=t,this.ttl=n,this.tpe=i,this.addtData=r};return e}),define("services/well",["jquery","helpers/ajax-request"],function(e,t){var n=function(t){return"//wfm-report.herokuapp.com/api/well/"+(t?"?"+e.param(t):"")},i={get:function(){return t("GET",n())},post:function(e){return t("POST",n(),e)},put:function(e,i){return t("PUT",n({id:e}),i)},remove:function(e){return t("DELETE",n({id:e}))}};return i}),define("models/integrity-of-well",["knockout","models/file-spec"],function(e,t){var n=function(n){n=n||{},this.idOfWell=n.IdOfWell,this.idOfFileSpec=n.IdOfFileSpec,this.name=e.observable(n.Name),this.description=e.observable(n.Description),this.fileSpec=new t(n.FileSpecDto)};return n}),define("services/integrity-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/wells/"+e+"/integrities"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/nodal-analysis-of-well",["knockout","models/file-spec"],function(e,t){var n=function(n){n=n||{},this.idOfWell=n.IdOfWell,this.idOfFileSpec=n.IdOfFileSpec,this.name=e.observable(n.Name),this.description=e.observable(n.Description),this.fileSpec=new t(n.FileSpecDto)};return n}),define("services/nodal-analysis-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/wells/"+e+"/nodal-analyzes"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/volume-of-well",["knockout","models/file-spec"],function(e,t){var n=function(n){n=n||{},this.idOfWell=n.IdOfWell,this.idOfFileSpec=n.IdOfFileSpec,this.name=e.observable(n.Name),this.description=e.observable(n.Description),this.fileSpec=new t(n.FileSpecDto)};return n}),define("services/volume-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/wells/"+e+"/volumes"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/file-spec-of-history-of-well",["knockout","models/file-spec"],function(e,t){var n=function(n){n=n||{},this.idOfHistoryOfWell=n.IdOfHistoryOfWell,this.idOfFileSpec=n.IdOfFileSpec,this.description=e.observable(n.Description),this.fileSpec=new t(n.FileSpecDto)};return n}),define("services/file-spec-of-history-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/well-histories/"+e+"/history-files"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/wfm-image",["models/file-spec"],function(e){var t=function(t){t=t||{},this.id=t.Id,this.idOfFileSpec=t.IdOfFileSpec,this.fileSpec=new e(t.FileSpecDto),this.x1=t.X1,this.y1=t.Y1,this.x2=t.X2,this.y2=t.Y2,this.cropXUnits=t.CropXUnits,this.cropYUnits=t.CropYUnits,this.croppedImageUrl=t.CroppedImageUrl};return t}),define("services/image-of-history-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/well-histories/"+e+"/history-images"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/history-of-well",["jquery","knockout","services/datacontext","helpers/app-helper","models/file-spec-of-history-of-well","services/file-spec-of-history-of-well","models/wfm-image","services/image-of-history-of-well"],function(e,t,n,i,r,o,a,s){function l(e){return(e||[]).map(function(e){return new r(e)})}function u(e){return(e||[]).map(function(e){return new a(e)})}var c=function(e,n){e=e||{},this.getWell=function(){return n},this.id=e.Id,this.historyText=t.observable(e.HistoryText),this.startUnixTime=t.observable(e.StartUnixTime),this.endUnixTime=t.observable(e.EndUnixTime),this.jobTypeId=e.JobTypeId?t.observable(e.JobTypeId):t.observable(),this.wellId=e.WellId,this.WfmImages=t.observableArray(),this.WellHistoryFiles=t.observableArray(l(e.WellHistoryFiles)),this.listOfJobTypeOfCompany=t.computed({read:this.calcListOfJobTypeOfCompany,deferEvaluation:!0,owner:this}),this.jobType=t.computed({read:this.calcJobTypeById,deferEvaluation:!0,owner:this}),this.isVisibleEndUnixTime=t.computed({read:this.calcIsVisEndUnixTime,deferEvaluation:!0,owner:this}),this.startUnixTime.subscribe(this.putWellHistory,this),this.endUnixTime.subscribe(this.putWellHistory,this),this.jobTypeId.subscribe(this.putWellHistory,this),e.WfmImagesDto&&this.WfmImages(u(e.WfmImagesDto))};return c.prototype.calcListOfJobTypeOfCompany=function(){return t.unwrap(this.getWell().getWellGroup().getWellField().getWellRegion().getCompany().jobTypeList)},c.prototype.calcJobTypeById=function(){var e=t.unwrap(this.jobTypeId);if(e){var n=t.unwrap(this.listOfJobTypeOfCompany);return i.getElementByPropertyValue(n,"id",e)}},c.prototype.calcIsVisEndUnixTime=function(){return t.unwrap(this.startUnixTime)!==t.unwrap(this.endUnixTime)},c.prototype.putWellHistory=function(){n.putWellHistory({id:t.unwrap(this.id),startUnixTime:t.unwrap(this.startUnixTime),endUnixTime:t.unwrap(this.endUnixTime),wellId:t.unwrap(this.wellId),historyText:t.unwrap(this.historyText),jobTypeId:t.unwrap(this.jobTypeId)})},c.prototype.removeWfmImage=function(e){if(confirm("Are you sure you want to delete?")){var t=this;s.remove(this.id,e.id).done(function(){t.WfmImages.remove(e)})}},c.prototype.removeFileSpecOfHistoryOfWell=function(e){if(confirm("Are you sure you want to delete this file?")){var t=this;o.remove(t.id,e.idOfFileSpec).done(function(){t.WellHistoryFiles.remove(e)})}},c.prototype.postFileSpecOfHistoryOfWell=function(e,t,n){var i=this;o.post(i.id,{idOfFileSpec:e,idOfHistoryOfWell:i.id,description:""}).done(function(e){i.WellHistoryFiles.push(new r(e)),t()}).fail(n)},c.prototype.postImageOfHistoryOfWell=function(e,t,n){var i=this;s.post(i.id,{IdOfFileSpec:e,X1:t[0],X2:t[2],Y1:t[1],Y2:t[3],CropXUnits:0,CropYUnits:0}).done(function(e){i.WfmImages.push(new a(e)),n()})},c}),define("services/log-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/wells/"+e+"/logs"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},getUrl:function(e,n){return t(e,n)},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/svg-elem",["knockout"],function(e){var t=function(t){t=t||{},this.id=t.Id,this.color=e.observable(t.Color),this.tpe=t.Tpe,this.opts=e.observable(JSON.parse(t.Opts)),this.toDto=function(){return{Id:this.id,Color:e.unwrap(this.color),Tpe:e.unwrap(this.tpe),Opts:JSON.stringify(e.unwrap(this.opts))}}};return t}),define("services/svg-elem-of-log-of-well",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/well-logs/"+e+"/svg-elements"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/log-of-well",["jquery","knockout","services/log-of-well","models/svg-elem","services/svg-elem-of-log-of-well"],function(e,t,n,i,r){function o(e){return(e||[]).map(function(e){return new i(e)})}var a=function(e){e=e||{};var i=this;this.id=e.Id,this.idOfWell=e.IdOfWell,this.idOfFileSpec=e.IdOfFileSpec,this.name=t.observable(e.Name),this.description=t.observable(e.Description),this.representationUrl=n.getUrl(i.idOfWell,i.id),this.imgFigures=t.observableArray(o(e.ListOfSvgElemDto)),this.isEnabledSavingSvgElems=t.observable(!0),this.saveSvgElems=function(){var e=t.unwrap(i.imgFigures),n=e.filter(function(e){return!e.id});0!==n.length&&(i.isEnabledSavingSvgElems(!1),n.forEach(function(e,t){r.post(i.id,e.toDto()).done(function(r){e.id=r.Id,t===n.length-1&&i.isEnabledSavingSvgElems(!0)})}))},this.checkedLogTool=t.observable("tool-hand")};return a}),define("services/test-data",["jquery","helpers/ajax-request"],function(e,t){var n=function(t,n){var i={testscope_id:t,hournumber:n};return"//wfm-report.herokuapp.com/api/testdata"+(t?"?"+e.param(i):"")},i={post:function(e){return t("POST",n(),e)},put:function(e,i,r){return t("PUT",n(e,i),r)},remove:function(e,i){return t("DELETE",n(e,i))}};return i}),define("models/test-data",["require","exports","module","jquery","knockout","services/test-data"],function(e,t,n){var i=e("jquery"),r=e("knockout"),o=e("services/test-data");t=function(e,t){e=e||{},this.getTestScope=function(){return t},this.hourNumber=e.HourNumber,this.testScopeId=e.TestScopeId,this.comment=r.observable(e.Comment),this.dict=e.Dict,this.isEdit=r.observable(!1),this.cancelData=null},t.prototype.editTestData=function(){this.cancelData={comment:r.unwrap(this.comment),dict:i.extend({},this.dict)},this.isEdit(!0)},t.prototype.cancelEditTestData=function(){this.comment(this.cancelData.comment),this.dict=i.extend({},this.cancelData.dict),this.isEdit(!1)},t.prototype.cbkSaveTestData=function(e){this.getTestScope().testDataListUpdateDate(new Date),this.comment(e.Comment),this.dict=e.Dict,this.isEdit(!1)},t.prototype.saveTestData=function(){o.put(this.testScopeId,this.hourNumber,r.toJS(this)).done(this.cbkSaveTestData.bind(this))},n.exports=t}),define("services/test-scope",["jquery","helpers/ajax-request"],function(e,t){var n=function(t){return"//wfm-report.herokuapp.com/api/testscope/"+(t?"?"+e.param(t):"")},i={get:function(e){return t("GET",n({well_id:e}))},post:function(e){return t("POST",n(),e)},put:function(e,i){return t("PUT",n({id:e}),i)}};return i}),define("models/test-scope",["require","exports","module","knockout","moment","models/test-data","services/test-data","services/test-scope"],function(e,t,n){function i(e,t){return(e||[]).map(function(e){return new a(e,t)})}var r=e("knockout"),o=e("moment"),a=e("models/test-data"),s=e("services/test-data"),l=e("services/test-scope");t=function(e,t){e=e||{},this.getWell=function(){return t},this.id=e.Id,this.wellId=e.WellId,this.startUnixTime=r.observable(e.StartUnixTime),this.isApproved=r.observable(e.IsApproved),this.conductedBy=r.observable(e.ConductedBy),this.certifiedBy=r.observable(e.CertifiedBy),this.startUnixTimeDateView=r.computed({read:this.calcStartUnixTimeDateView,deferEvaluation:!0,owner:this}),this.testDataList=r.observableArray(),this.testDataListUpdateDate=r.observable(new Date),this.testDataTotal=r.computed({read:this.calcTestDataTotal,deferEvaluation:!0,owner:this}),this.testDataList(i(e.TestDataDtoList,this))},t.prototype.saveTestScope=function(){l.put(this.id,this.toPlainJson())},t.prototype.toPlainJson=function(){var e=r.toJS(this);return delete e.startUnixTimeDateView,delete e.testDataTotal,delete e.testDataListUpdateDate,e},t.prototype.unsetTestData=function(e){this.testDataList.remove(e)},t.prototype.setTestData=function(e){this.testDataList.push(new a(e,this))},t.prototype.deleteTestData=function(e){confirm("Are you sure you want to delete?")===!0&&s.remove(e.testScopeId,e.hourNumber).done(this.unsetTestData.bind(this,e))},t.prototype.addTestData=function(){s.post({Comment:"",HourNumber:r.unwrap(this.testDataList).length,TestScopeId:this.id,Dict:{}}).done(this.setTestData.bind(this))},t.prototype.setStatusToApproved=function(){this.isApproved(!0),this.saveTestScope()},t.prototype.setStatusToDeclined=function(){this.isApproved(!1),this.saveTestScope()},t.prototype.setStatusToNull=function(){this.isApproved(null),this.saveTestScope()};var u=function(e,t,n){"undefined"!=typeof n.dict[t.wfmParameterId]&&null!==n.dict[t.wfmParameterId]&&e.push(parseFloat(n.dict[t.wfmParameterId]))};t.prototype.calcEachTotal=function(e,t){var n=[];if(r.unwrap(this.testDataList).forEach(u.bind(null,n,t)),n.length>0){var i=n.reduce(function(e,t){return e+t});e[t.wfmParameterId]=parseFloat(i/n.length).toFixed(2),r.unwrap(t.wfmParameter().isCumulative)===!0&&(e[t.wfmParameterId]*=24)}},t.prototype.calcTestDataTotal=function(){var e={};return r.unwrap(this.testDataList).length>0&&r.unwrap(this.testDataListUpdateDate)&&r.unwrap(this.getWell().getWellGroup().listOfWfmParameterOfWroup).forEach(this.calcEachTotal.bind(this,e)),e},t.prototype.calcStartUnixTimeDateView=function(){return o(1e3*r.unwrap(this.startUnixTime)).format("YYYY-MM-DD HH:mm")},n.exports=t}),define("services/procent-border",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/wells/"+e+"/procent-borders"+(t?"/"+t:"")},n=function(e){return"//wfm-report.herokuapp.com/api/well-groups/"+e+"/wells/all/procent-borders"},i={get:function(n){return e("GET",t(n))},insertOrUpdate:function(n,i){return e("POST",t(n),i)},remove:function(n,i){return e("DELETE",t(n,i))},getForAllWells:function(t){return e("GET",n(t))}};return i}),define("models/procent-border",["jquery","knockout","services/procent-border"],function(e,t,n){var i=function(i,r){i=i||{};var o=this;this.idOfWell=i.IdOfWell,this.idOfWfmParameter=i.IdOfWfmParameter,this.procent=t.observable(i.Procent),this.isSaveProgress=t.observable(!1),this.save=function(){o.isSaveProgress(!0),n.insertOrUpdate(o.idOfWell,{IdOfWell:o.idOfWell,IdOfWfmParameter:o.idOfWfmParameter,Procent:t.unwrap(o.procent)}).done(function(){o.isSaveProgress(!1)})},this.procent.subscribe(function(t){return e.isNumeric(t)===!1||0>+t||+t>100?(r.removeProcentBorder(o),void o.procent(null)):void o.save()})};return i}),define("services/monitoring-record",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/wells/"+e+"/monitoring-records"+(t?"/"+t:"")},n=function(e,t,n){return"//wfm-report.herokuapp.com/api/wells/"+e+"/monitoring-records/time-start/"+t+"/time-end/"+n},i=function(e,t){return"//wfm-report.herokuapp.com/api/well-groups/"+e+"/wells/all/monitoring-records/"+t},r={getListOfScope:function(t,n){return e("GET",i(t,n))},getFilteredData:function(t,i,r){return e("GET",n(t,i,r))},upsert:function(n,i,r){return e("POST",t(n,i),r)},removeAll:function(n){return e("DELETE",t(n))},remove:function(n,i){return e("DELETE",t(n,i))}};return r}),define("models/monitoring-record",["knockout","helpers/app-helper","services/monitoring-record"],function(e,t,n){var i=function(t,n,i){t=t||{},this.koObjProcentBorders=i,this.idOfWell=t.IdOfWell,this.unixTime=e.observable(t.UnixTime),this.isSaveProgress=e.observable(!1),this.dict={},this.aveDict={},this.diffDict={},this.diffClassDict={},this.loadData(t,n)};return i.prototype.loadData=function(e,t){t.forEach(this.loadItem.bind(this,e.Dict||{},e.AverageDict||{}))},i.prototype.loadItem=function(t,n,i){this.dict[i.wfmParameterId]=e.observable(t[i.wfmParameterId]),this.dict[i.wfmParameterId].subscribe(this.upsertMonitoringRecord,this),this.aveDict[i.wfmParameterId]=e.observable(n[i.wfmParameterId]),this.diffDict[i.wfmParameterId]=e.computed({read:this.genDiffDictItem.bind(this,i),deferEvaluation:!0,owner:this}),this.diffClassDict[i.wfmParameterId]=e.computed({read:this.genDiffClassItem.bind(this,i),deferEvaluation:!0,owner:this})},i.prototype.genDiffClassItem=function(t){var n=e.unwrap(this.diffDict[t.wfmParameterId]);return n===!0?"danger":n===!1?"success":void 0},i.prototype.genDiffDictItem=function(n){var i=e.unwrap(this.koObjProcentBorders)[n.wfmParameterId];if(i){var r=e.unwrap(i.procent);if(t.isNumeric(r)){r=+r;var o=e.unwrap(this.dict[n.wfmParameterId]);if(t.isNumeric(o)){o=+o;var a=e.unwrap(this.aveDict[n.wfmParameterId]);if(t.isNumeric(a)){a=+a;var s=a*(r/100);return console.log("procent for elem ",n.wfmParameterId,r,s),o>a+s?!0:a-s>o?!0:!1}}}}},i.prototype.upsertMonitoringRecord=function(){var i=e.toJS(this.dict);for(var r in i)if(i.hasOwnProperty(r))if(t.isNumeric(i[r]))i[r]=+i[r];else{if(i[r])return void alert("Only numbers for "+r+": "+i[r]);i[r]=null}this.isSaveProgress(!0),n.upsert(this.idOfWell,e.unwrap(this.unixTime),{IdOfWell:this.idOfWell,UnixTime:e.unwrap(this.unixTime),Dict:i}).done(this.scsUpsertMonitoringRecord.bind(this))},i.prototype.scsUpsertMonitoringRecord=function(){this.isSaveProgress(!1)},i}),define("models/well",["jquery","knockout","services/datacontext","helpers/file-helper","helpers/app-helper","moment","base-models/stage-base","models/perfomance-of-well","models/section-of-stage","models/sketch-of-well","models/prop-spec","services/well","models/integrity-of-well","services/integrity-of-well","models/nodal-analysis-of-well","services/nodal-analysis-of-well","constants/stage-constants","models/volume-of-well","services/volume-of-well","models/history-of-well","models/log-of-well","services/log-of-well","services/file-spec","models/column-attribute","models/test-scope","services/test-scope","models/procent-border","services/procent-border","models/monitoring-record","services/monitoring-record"],function(e,t,n,i,r,o,a,s,l,u,c,d,p,f,h,m,g,w,v,y,b,S,O,k,W,D,_,T,E,P){function M(e){return(e||[]).map(function(e){return new w(e)})}function x(e){return(e||[]).map(function(e){return new b(e)})}function C(e){return(e||[]).map(function(e){return new h(e)})}function I(e){return(e||[]).map(function(e){return new p(e)})}function F(e){return e.map(function(e){return new k(e)})}function L(e,t){return e.map(function(e){return new y(e,t)})}function V(e,t){return e.map(function(e){return new l(e,t)})}var N=[new c("Name","Name","Well name","SingleLine",{maxLength:255}),new c("Description","Description","Description","MultiLine",{}),new c("IsActive","IsActive","Is active","BoolLine",{}),new c("DrillingDate","DrillingDate","Drilling date","DateLine",{}),new c("ProductionHistory","ProductionHistory","Production history","MultiLine",{}),new c("CompletionType","CompletionType","Completion type","MultiLine",{}),new c("FormationCompleteState","FormationCompleteState","Formation complete state","MultiLine",{}),new c("IntegrityStatus","IntegrityStatus","Integrity status","MultiLine",{}),new c("LastInterventionType","LastInterventionType","Last intervention type","MultiLine",{}),new c("LastInterventionDate","LastInterventionDate","Last intervention date","DateLine",{}),new c("PerforationDepth","PerforationDepth","Perforation depth","MultiLine",{}),new c("PressureData","PressureData","Pressure data","MultiLine",{}),new c("Pvt","Pvt","PVT","MultiLine",{}),new c("ReservoirData","ReservoirData","Reservoir data","MultiLine",{})],A=function(e,i){e=e||{};
var r=this;this.getWellGroup=function(){return i},this.getRootMdl=function(){return this.getWellGroup().getRootMdl()},this.Id=e.Id,this.id=e.Id,this.WellType=t.observable(e.WellType),this.FlowType=t.observable(e.FlowType),this.propSpecList=N,this.stageKey=g.well.id,a.call(this,e),this.Comment=t.observable(e.Comment),this.WellGroupId=e.WellGroupId,this.sketchOfWell=new u(r),this.listOfMapMarker=t.computed({read:this.calcMarkersForWell,deferEvaluation:!0,owner:this}),this.listOfTestScope=t.observableArray(),this.lastApprovedTestScope=t.computed({read:this.calcLastApprovedTestScope,deferEvaluation:!0,owner:this}),this.testScopeNewStartUnixTime={unixDate:t.observable(),hour:t.observable(0),minute:t.observable(0)},this.isEnabledPostTestScope=t.computed({read:this.calcIsEnabledPostTestScope,deferEvaluation:!0,owner:this}),this.logsOfWell=t.observableArray(),this.isLoadedLogsOfWell=t.observable(!1),this.loadLogsOfWell=function(){t.unwrap(r.isLoadedLogsOfWell)||S.get(r.id).done(function(e){r.logsOfWell(x(e)),r.isLoadedLogsOfWell(!0)})},this.getLogColumnAttributes=function(e,t,n){O.getColumnAttributes(r.stageKey,e,t).done(function(e){n(F(e))})},this.postLogOfWell=function(e,t,n){S.post(r.id,{IdOfWell:r.id,IdOfFileSpec:e,Name:t,Description:n.join(",")}).done(function(e){r.logsOfWell.push(new b(e))})},this.historyList=t.observableArray(),this.isLoadedHistoryList=t.observable(!1),this.listOfNodalAnalysis=t.observableArray(),this.isLoadedListOfNodalAnalysis=t.observable(!1),this.loadListOfNodalAnalysis=function(){t.unwrap(r.isLoadedListOfNodalAnalysis)||m.get(r.id).done(function(e){r.listOfNodalAnalysis(C(e)),r.isLoadedListOfNodalAnalysis(!0)})},this.postNodalAnalysis=function(e,t,n,i,o){m.post(r.id,{IdOfWell:r.id,IdOfFileSpec:e,Name:t,Description:n}).done(function(e){r.listOfNodalAnalysis.push(new h(e)),i()}).fail(o)},this.removeNodalAnalysis=function(e){m.remove(e.idOfWell,e.idOfFileSpec).done(function(){r.listOfNodalAnalysis.remove(e)})},this.listOfIntegrity=t.observableArray(),this.isLoadedListOfIntegrity=t.observable(!1),this.loadListOfIntegrity=function(){t.unwrap(r.isLoadedListOfIntegrity)||f.get(r.id).done(function(e){r.listOfIntegrity(I(e)),r.isLoadedListOfIntegrity(!0)})},this.postIntegrity=function(e,t,n,i,o){f.post(r.id,{IdOfWell:r.id,IdOfFileSpec:e,Name:t,Description:n}).done(function(e){r.listOfIntegrity.push(new p(e)),i()}).fail(o)},this.removeIntegrity=function(e){f.remove(e.idOfWell,e.idOfFileSpec).done(function(){r.listOfIntegrity.remove(e)})},this.volumes=t.observableArray(),this.isLoadedVolumes=t.observable(!1),this.loadVolumes=function(){t.unwrap(r.isLoadedVolumes)||v.get(r.id).done(function(e){r.isLoadedVolumes(!0),r.volumes(M(e))})},this.postVolumeOfWell=function(e,t,n,i){v.post(r.id,{idOfWell:r.id,idOfFileSpec:e,name:t||"",description:""}).done(function(e){r.volumes.push(new w(e)),n()}).fail(i)},this.removeVolumeOfWell=function(e){v.remove(e.idOfWell,e.idOfFileSpec).done(function(){r.volumes.remove(e)})},this.perfomanceOfWell=new s(r),this.perfomanceOfWell.prdColumnAttributeList(F(n.getColumnAttributesLocal())),this.procentBorders=t.observableArray(),this.objProcentBorders=t.computed({read:this.calcObjProcentBorders,deferEvaluation:!0,owner:this}),this.listOfMonitoringRecord=t.observableArray(),this.sortedListOfMonitoringRecord=t.computed({read:this.calcSortedListOfMonitoringRecord,deferEvaluation:!0,owner:this}),this.isLoadedListOfMonitoringRecord=t.observable(!1),this.listOfSection(V(e.ListOfSectionOfWellDto,r))};return r.inherits(A,a),A.prototype.removeProcentBorder=function(e){var t=this;T.remove(e.idOfWell,e.idOfWfmParameter).done(function(){t.procentBorders.remove(e)})},A.prototype.calcMarkersForWell=function(){var e=t.unwrap(this.getWellGroup().getWellField().WellFieldMaps);console.log("calc markers for a well",e);var n=this.id,i=[];return e.forEach(function(e){var r=t.unwrap(e.wellMarkers),o=r.filter(function(e){return t.unwrap(e.idOfWell)===n&&t.unwrap(e.isDrilled)?!0:!1});if(1===o.length)i.push(o[0]);else if(o.length>1)throw new Error("Only one well per each map")}),i},A.prototype.loadWellHistoryList=function(){t.unwrap(this.isLoadedHistoryList)||n.getWellHistoryList({well_id:this.id}).done(this.successLoadWellHistoryList.bind(this))},A.prototype.successLoadWellHistoryList=function(e){this.historyList(L(e,this)),this.isLoadedHistoryList(!0)},A.prototype.postHistoryOfWell=function(e,t,i){n.postWellHistory({wellId:this.id,historyText:"",startUnixTime:e,endUnixTime:t}).done(i)},A.prototype.pushHistoryOfWell=function(e){this.historyList.push(new y(e,this))},A.prototype.unlinkHistoryOfWell=function(e){this.historyList.remove(e)},A.prototype.deleteWellHistory=function(e){n.deleteWellHistory(e.id).done(this.unlinkHistoryOfWell.bind(this,e))},A.prototype.loadListOfMonitoringRecord=function(e,t){this.isLoadedListOfMonitoringRecord(!1),P.getFilteredData(this.id,e,t).done(this.scsLoadListOfMinitoringRecord.bind(this))},A.prototype.scsLoadListOfMinitoringRecord=function(e){this.isLoadedListOfMonitoringRecord(!0),this.importMonitoringRecords(e)},A.prototype.importMonitoringRecords=function(e){var n=t.unwrap(this.getWellGroup().listOfMonitoredParams),i=e.map(function(e){return new E(e,n,this.objProcentBorders)},this);this.listOfMonitoringRecord(i),i=null},A.prototype.postMonitoringRecord=function(e,t,n,i){P.upsert(this.id,e,{IdOfWell:this.id,UnixTime:e,Dict:n}).done(i)},A.prototype.calcObjProcentBorders=function(){var e=t.unwrap(this.getWellGroup().listOfWfmParameterOfWroup),n=t.unwrap(this.procentBorders),i={};return e.forEach(this.fillObjProcentBorder.bind(this,i,n)),n=null,e=null,i},A.prototype.fillObjProcentBorder=function(e,t,n){var i=t.filter(function(e){return e.idOfWfmParameter===n.wfmParameterId})[0];e[n.wfmParameterId]=i?i:new _({IdOfWell:this.id,IdOfWfmParameter:n.wfmParameterId},this)},A.prototype.calcSortedListOfMonitoringRecord=function(){return t.unwrap(this.listOfMonitoringRecord).sort(function(e,n){return t.unwrap(e.unixTime)>t.unwrap(n.unixTime)?1:-1})},A.prototype.removeAllMonitoringRecords=function(){P.removeAll(this.id).done(this.cleanListOfMonitoringRecord.bind(this))},A.prototype.cleanListOfMonitoringRecord=function(){this.listOfMonitoringRecord([])},A.prototype.importProcentBorders=function(e){this.procentBorders(e.map(function(e){return new _(e,this)},this))},A.prototype.loadListOfTestScope=function(){D.get(this.id).done(this.importListOfTestScope.bind(this))},A.prototype.importListOfTestScope=function(e){e=e||[],this.listOfTestScope(e.map(this.createTestScope,this))},A.prototype.createTestScope=function(e){return new W(e,this)},A.prototype.calcLastApprovedTestScope=function(){var e=t.unwrap(this.listOfTestScope).filter(function(e){return t.unwrap(e.isApproved)===!0}),n=e[0];return e.forEach(function(e){t.unwrap(e.startUnixTime)>t.unwrap(n.startUnixTime)&&(n=e)}),e=null,n},A.prototype.calcIsEnabledPostTestScope=function(){return t.unwrap(this.testScopeNewStartUnixTime.unixDate)&&t.unwrap(this.testScopeNewStartUnixTime.hour)>=0&&t.unwrap(this.testScopeNewStartUnixTime.minute)>=0?!0:!1},A.prototype.setDefaultTimeForTestScopeNew=function(){this.testScopeNewStartUnixTime.unixDate(null),this.testScopeNewStartUnixTime.hour(0),this.testScopeNewStartUnixTime.minute(0)},A.prototype.postTestScope=function(){if(this.isEnabledPostTestScope){var e=t.unwrap(this.testScopeNewStartUnixTime.unixDate);e+=60*new Date(1e3*e).getTimezoneOffset(),e+=3600*t.unwrap(this.testScopeNewStartUnixTime.hour),e+=60*t.unwrap(this.testScopeNewStartUnixTime.minute),D.post({WellId:this.id,StartUnixTime:e,IsApproved:null,ConductedBy:"",CertifiedBy:""}).done(this.scsPostTestScope.bind(this))}},A.prototype.scsPostTestScope=function(e){this.setDefaultTimeForTestScopeNew(),this.unshiftTestScope(e)},A.prototype.unshiftTestScope=function(e){this.listOfTestScope.unshift(new W(e,this))},A.prototype.getListOfStageByKey=function(e){switch(e){case g.company.id:return[this.getWellGroup().getWellField().getWellRegion().getCompany()];case g.wegion.id:return[this.getWellGroup().getWellField().getWellRegion()];case g.wield.id:return[this.getWellGroup().getWellField()];case g.wroup.id:return[this.getWellGroup()];case g.well.id:return[this]}},A.prototype.save=function(){d.put(this.id,this.toDto())},A.prototype.toDto=function(){var e={Id:this.Id,WellGroupId:this.WellGroupId,WellType:t.unwrap(this.WellType),FlowType:t.unwrap(this.FlowType),Comment:t.unwrap(this.Comment)};return this.propSpecList.forEach(function(n){e[n.serverId]=t.unwrap(this[n.clientId])},this),e},A.prototype.getIdOfCompany=function(){return this.getWellGroup().getWellField().getWellRegion().getCompany().id},A}),define("helpers/uom-helper",[],function(){var e={};return e.getUomCoefFromDict=function(e,t){var n;for(var i in t)if(t.hasOwnProperty(i))for(var r in t[i])t[i].hasOwnProperty(r)&&e===r&&(n=t[i][r]);return n},e.convertMatrixToStr=function(e){for(var t=[],n=0;n<e.length;n+=1)t.push(e[n].join("*"));return t.join("/")},e.convertStrToMatrix=function(e){for(var t=e.split("/"),n=[],i=0;i<t.length;i+=1)n.push(t[i].split("*"));return n},e}),define("constants/uom-constants",["require","exports","module"],function(e,t,n){t={time:{sec:1,min:60,hr:3600,d:86400},volume:{m3:1,bbl:.159159637116027,Mbbl:159.159637116027,MMbbl:159159.637116027,scf:.028316846592,Mcf:28.316846592,MMcf:28316.846592,in3:16387064e-12,L:.001,galUS:.003785411784,galUK:.00454609},temperature:{"°F":1}},n.exports=t}),define("models/wfm-parameter",["knockout","helpers/uom-helper","constants/uom-constants"],function(e,t,n){var i=function(n){n=n||{},this.id=n.Id,this.name=e.observable(n.Name),this.uom=e.observable(n.Uom),this.sourceUomMatrix=t.convertStrToMatrix(n.Uom),this.uomMatrix=e.computed({read:this.calcUomMatrix,deferEvaluation:!0,owner:this}),this.defaultColor=e.observable(n.DefaultColor),this.isCumulative=e.observable(n.IsCumulative),this.isSystem=e.observable(n.IsSystem),this.wfmParamSquadId=e.observable(n.WfmParamSquadId),this.uomCoef=e.computed({read:this.calcUomCoef.bind(this),deferEvaluation:!0,owner:this}),this.toPlainJson=function(){return e.toJS(this)}};return i.prototype.calcUomCoef=function(){for(var i=1,r=e.unwrap(this.uomMatrix),o=0;o<this.sourceUomMatrix.length;o+=1)for(var a=0;a<this.sourceUomMatrix[o].length;a+=1){var s=r[o][a],l=this.sourceUomMatrix[o][a];s!==l&&(0===o?i*=t.getUomCoefFromDict(l,n)/t.getUomCoefFromDict(s,n):1===o&&(i/=t.getUomCoefFromDict(l,n)/t.getUomCoefFromDict(s,n)))}return i},i.prototype.changeSelectedUom=function(n,i,r){var o=e.unwrap(this.uomMatrix).slice();o[i][r]=n,this.uom(t.convertMatrixToStr(o))},i.prototype.getPossibleUomListForSelectedUom=function(e){var t;for(var i in n)if(n.hasOwnProperty(i))for(var r in n[i])n[i].hasOwnProperty(r)&&r===e&&(t=n[i]);var o=[];if(t)for(var a in t)t.hasOwnProperty(a)&&a!==e&&o.push(a);return o},i.prototype.calcUomMatrix=function(){return t.convertStrToMatrix(e.unwrap(this.uom))},i}),define("services/wfm-parameter-of-wroup",["helpers/ajax-request"],function(e){var t=function(e,t){return"//wfm-report.herokuapp.com/api/well-groups/"+e+"/wfm-parameters"+(t?"/"+t:"")},n={get:function(n,i){return e("GET",t(n,i))},post:function(n,i){return e("POST",t(n),i)},put:function(n,i,r){return e("PUT",t(n,i),r)},remove:function(n,i){return e("DELETE",t(n,i))}};return n}),define("models/wfm-parameter-of-wroup",["knockout","models/wfm-parameter","services/wfm-parameter-of-wroup"],function(e,t,n){var i=function(n,i){n=n||{},this.getWellGroup=function(){return i},this.wellGroupId=n.WellGroupId,this.wfmParameterId=n.WfmParameterId,this.serialNumber=e.observable(n.SerialNumber),this.color=e.observable(n.Color),this.uom=e.observable(n.Uom),this.isMonitored=e.observable(n.IsMonitored),this.isCalc=e.observable(!1),this.wfmParameter=e.observable(),n.WfmParameterDto||console.log("TODO: remove"),n.WfmParameterDto&&(console.log("try to find a parameter from loaded parameters"),this.wfmParameter(new t(n.WfmParameterDto))),this.isMonitored.subscribe(this.save,this),this.color.subscribe(this.save,this),this.uom.subscribe(this.save,this)};return i.prototype.save=function(){n.put(this.wellGroupId,this.wfmParameterId,{WellGroupId:this.wellGroupId,WfmParameterId:this.wfmParameterId,IsMonitored:e.unwrap(this.isMonitored),Color:e.unwrap(this.color),SerialNumber:e.unwrap(this.serialNumber),Uom:e.unwrap(this.uom)})},i}),define("services/wroup",["jquery","helpers/ajax-request"],function(e,t){var n=function(t){return"//wfm-report.herokuapp.com/api/wellgroup/"+(t?"?"+e.param(t):"")},i={get:function(){return t("GET",n())},post:function(e){return t("POST",n(),e)},put:function(e,i){return t("PUT",n({id:e}),i)},remove:function(e){return t("DELETE",n({id:e}))}};return i}),define("models/wroup",["jquery","knockout","services/datacontext","models/well","models/wfm-parameter-of-wroup","services/wfm-parameter-of-wroup","models/section-of-stage","base-models/stage-base","models/prop-spec","services/wroup","constants/stage-constants","services/procent-border","services/monitoring-record","helpers/app-helper"],function(e,t,n,i,r,o,a,s,l,u,c,d,p,f){function h(e,t){return(e||[]).map(function(e){return new r(e,t)})}function m(e,t){return e.map(function(e){return new i(e,t)})}function g(e,t){return e.map(function(e){return new a(e,t)})}var w=[new l("Name","Name","Group name","SingleLine",{maxLength:255}),new l("Description","Description","Description","MultiLine",{})],v=function(e,n){e=e||{};var i=this;this.getWellField=function(){return n},this.getRootMdl=function(){return this.getWellField().getRootMdl()},this.Id=e.Id,this.id=e.Id,this.WellFieldId=e.WellFieldId,this.propSpecList=w,this.stageKey=c.wroup.id,s.call(this,e),this.wells=t.observableArray(),this.listOfWfmParameterOfWroup=t.observableArray(),this.isLoadedListOfWfmParameterOfWroup=t.observable(!1),this.totalTestScopeOfWells=t.computed({read:function(){var e={},n=t.unwrap(i.wells).filter(function(e){return t.unwrap(e.IsActive)===!0}),r=t.unwrap(i.listOfWfmParameterOfWroup);return n.forEach(function(n){var i=t.unwrap(n.lastApprovedTestScope);if(i){var o=t.unwrap(i.testDataTotal);r.forEach(function(t){e[t.wfmParameterId]||(e[t.wfmParameterId]=0),e[t.wfmParameterId]+=+(o[t.wfmParameterId]||0)})}}),e},deferEvaluation:!0}),this.listOfMonitoredParams=t.computed({read:function(){var e=t.unwrap(i.listOfWfmParameterOfWroup);return e.filter(function(e){return t.unwrap(e.isMonitored)})},deferEvaluation:!0}),this.isLoadedProcentBordersForAllWells=t.observable(!1),this.wells(m(e.WellsDto,i)),this.listOfSection(g(e.ListOfSectionOfWroupDto,i))};return f.inherits(v,s),v.prototype.loadProcentBordersForAllWells=function(){var e=this;t.unwrap(e.isLoadedProcentBordersForAllWells)||d.getForAllWells(e.id).done(function(n){e.isLoadedProcentBordersForAllWells(!0),console.log(n);var i=t.unwrap(e.wells);i.forEach(function(e){var t=n.filter(function(t){return t.IdOfWell===e.id})[0].ArrayOfProcentBorder;e.importProcentBorders(t)})})},v.prototype.toDto=function(){var e=this,n={Id:e.Id,WellFieldId:e.WellFieldId};return e.propSpecList.forEach(function(i){n[i.serverId]=t.unwrap(e[i.clientId])}),n},v.prototype.loadListOfScopeOfMonitoring=function(e,n){var i=this;p.getListOfScope(i.id,e).done(function(e){var r=t.unwrap(i.wells);r.forEach(function(t){var i=e.filter(function(e){return e.IdOfWell===t.id})[0];i&&t.importMonitoringRecords(i.ListOfMonitoringRecord,n)})})},v.prototype.save=function(){u.put(this.id,this.toDto())},v.prototype.removeChild=function(e){var t=this;n.deleteWell(e).done(function(){t.wells.remove(e)})},v.prototype.postWell=function(e,t){var r=this;n.postWell({Name:e,Description:"",WellGroupId:r.id,IsActive:!0}).done(function(e){r.wells.push(new i(e,r)),t()})},v.prototype.loadListOfWfmParameterOfWroup=function(e){t.unwrap(this.isLoadedListOfWfmParameterOfWroup)?f.isFunction(e)&&e():o.get(this.id).done(this.scsLoadListOfWfmParameterOfWroup.bind(this,e))},v.prototype.scsLoadListOfWfmParameterOfWroup=function(e,t){this.listOfWfmParameterOfWroup(h(t)),this.isLoadedListOfWfmParameterOfWroup(!0),f.isFunction(e)&&e()},v.prototype.removeWfmParameterOfWroup=function(e){var t=this;o.remove(e.wellGroupId,e.wfmParameterId).done(function(){t.listOfWfmParameterOfWroup.remove(e)})},v.prototype.postWfmParameterOfWroup=function(e,t,n){o.post(this.id,{Color:t,SerialNumber:1,WellGroupId:this.id,WfmParameterId:e,IsMonitored:!1,Uom:n}).done(this.pushWfmParameterOfWroup.bind(this))},v.prototype.pushWfmParameterOfWroup=function(e){this.listOfWfmParameterOfWroup.push(new r(e,this))},v.prototype.getListOfStageByKey=function(e){switch(e){case c.company.id:return[this.getWellField().getWellRegion().getCompany()];case c.wegion.id:return[this.getWellField().getWellRegion()];case c.wield.id:return[this.getWellField()];case c.wroup.id:return[this];case c.well.id:return t.unwrap(this.wells)}},v.prototype.getIdOfCompany=function(){return this.getWellField().getWellRegion().getCompany().id},v}),define("services/wield",["jquery","helpers/ajax-request"],function(e,t){var n=function(t){return"//wfm-report.herokuapp.com/api/wellfield/"+(t?"?"+e.param(t):"")},i={get:function(){return t("GET",n())},post:function(e){return t("POST",n(),e)},put:function(e,i){return t("PUT",n({id:e}),i)},remove:function(e){return t("DELETE",n({id:e}))}};return i}),define("models/wield",["knockout","services/datacontext","helpers/file-helper","base-models/stage-base","models/map-of-wield","services/map-of-wield","models/section-of-stage","models/wroup","models/prop-spec","services/wield","services/wroup","constants/stage-constants","helpers/app-helper"],function(e,t,n,i,r,o,a,s,l,u,c,d,p){function f(e,t){return(e||[]).map(function(e){return new r(e,t)})}function h(e,t){return(e||[]).map(function(e){return new s(e,t)})}function m(e,t){return(e||[]).map(function(e){return new a(e,t)})}var g=[new l("name","Name","Field name","SingleLine",{maxLength:255}),new l("description","Description","Description","MultiLine",{})],w=function(t,n){t=t||{};var r=this;this.getWellRegion=function(){return n},this.getRootMdl=function(){return this.getWellRegion().getRootMdl()},this.propSpecList=g,this.Id=t.Id,this.id=t.Id,this.idOfWegion=t.WellRegionId,this.stageKey=d.wield.id,i.call(this,t),this.wroups=e.observableArray(),this.WellFieldMaps=e.observableArray(),this.isLoadedMapsOfWield=e.observable(!1),this.save=function(){u.put(r.Id,r.toDto())},this.toDto=function(){var t={Id:r.Id,WellRegionId:r.idOfWegion};return r.propSpecList.forEach(function(n){t[n.serverId]=e.unwrap(r[n.clientId])}),t},this.wroups(h(t.WellGroupsDto,this)),this.listOfSection(m(t.ListOfSectionOfWieldDto,this))};return p.inherits(w,i),w.prototype.loadMapsOfWield=function(){if(!e.unwrap(this.isLoadedMapsOfWield)){var t=this;o.get(this.id).done(function(n){t.isLoadedMapsOfWield(!0),t.WellFieldMaps(f(n,t)),console.log("maps are loaded",n,e.unwrap(t.WellFieldMaps))})}},w.prototype.postMapOfWield=function(e,t,n){var i=this;o.post(i.id,{WellFieldId:i.id,ScaleCoefficient:1,Description:"",Name:t,IdOfFileSpec:e}).done(function(e){i.WellFieldMaps.push(new r(e,i)),n()})},w.prototype.getWroupById=function(t){var n=e.unwrap(this.wroups);return n.filter(function(e){return e.id===t})[0]},w.prototype.postWroup=function(e){var t=this;c.post({Name:e,Description:"",WellFieldId:t.id}).done(function(e){t.wroups.push(new s(e,t))})},w.prototype.removeChild=function(e){var t=this;c.remove(e.id).done(function(){t.wroups.remove(e)})},w.prototype.removeMapOfWield=function(e){var t=this;o.remove(t.id,e.id).done(function(){t.WellFieldMaps.remove(e)})},w.prototype.getListOfStageByKey=function(t){switch(t){case d.company.id:return[this.getWellRegion().getCompany()];case d.wegion.id:return[this.getWellRegion()];case d.wield.id:return[this];case d.wroup.id:return e.unwrap(this.wroups);case d.well.id:return this.calcListOfWell()}},w.prototype.calcListOfWell=function(){var t=[];return e.unwrap(this.wroups).forEach(function(n){e.unwrap(n.wells).forEach(function(e){t.push(e)})}),t},w.prototype.getIdOfCompany=function(){return this.getWellRegion().getCompany().id},w}),define("services/wegion",["jquery","helpers/ajax-request"],function(e,t){var n=function(t){return"//wfm-report.herokuapp.com/api/wellregion/"+(t?"?"+e.param(t):"")},i={getInclusive:function(e){return t("GET",n({company_id:e,is_inclusive:!0}))},get:function(){return t("GET",n())},post:function(e){return t("POST",n(),e)},put:function(e,i){return t("PUT",n({id:e}),i)},remove:function(e){return t("DELETE",n({id:e}))}};return i}),define("models/wegion",["jquery","knockout","services/datacontext","models/wield","base-models/stage-base","models/section-of-stage","models/prop-spec","services/wegion","services/wield","constants/stage-constants","helpers/app-helper"],function(e,t,n,i,r,o,a,s,l,u,c){function d(e,t){return e.map(function(e){return new i(e,t)})}function p(e,t){return e.map(function(e){return new o(e,t)})}var f=[new a("name","Name","Region name","SingleLine",{maxLength:255}),new a("description","Description","Description","MultiLine",{})],h=function(e,n){e=e||{},this.getCompany=function(){return n},this.getRootMdl=function(){return this.getCompany().getRootMdl()},this.id=e.Id,this.companyId=e.CompanyId,this.wields=t.observableArray([]),this.propSpecList=f,this.stageKey=u.wegion.id,r.call(this,e),this.wields(d(e.WellFieldsDto,this)),this.listOfSection(p(e.ListOfSectionOfWegionDto,this))};return c.inherits(h,r),h.prototype.removeChild=function(e){l.remove(e.id).done(this.removeFromListOfWield.bind(this,e))},h.prototype.removeFromListOfWield=function(e){this.wields.remove(e)},h.prototype.toDto=function(){var e={Id:this.id,CompanyId:this.companyId};return this.propSpecList.forEach(function(n){e[n.serverId]=t.unwrap(this[n.clientId])},this),e},h.prototype.postWield=function(e){l.post({Name:e,Description:"",WellRegionId:this.id}).done(this.pushWield.bind(this))},h.prototype.pushWield=function(e){this.wields.push(new i(e,this))},h.prototype.save=function(){s.put(this.id,this.toDto())},h.prototype.getListOfStageByKey=function(e){switch(e){case u.company.id:return[this.getCompany()];case u.wegion.id:return[this];case u.wield.id:return t.unwrap(this.wields);case u.wroup.id:return this.calcListOfWroup();case u.well.id:return this.calcListOfWell()}},h.prototype.calcListOfWroup=function(){var e=[];return t.unwrap(this.wields).forEach(function(n){t.unwrap(n.wroups).forEach(function(t){e.push(t)})}),e},h.prototype.calcListOfWell=function(){var e=[];return t.unwrap(this.wields).forEach(function(n){t.unwrap(n.wroups).forEach(function(n){t.unwrap(n.wells).forEach(function(t){e.push(t)})})}),e},h.prototype.getIdOfCompany=function(){return this.getCompany().id},h}),define("models/job-type",["knockout"],function(e){var t=function(t){t=t||{},this.id=t.Id,this.name=e.observable(t.Name),this.description=e.observable(t.Description),this.companyId=t.CompanyId};return t}),define("services/company",["jquery","helpers/ajax-request"],function(e,t){var n=function(t){return"//wfm-report.herokuapp.com/api/company/"+(t?"?"+e.param({id:t}):"")},i={get:function(){return t("GET",n())},post:function(e){return t("POST",n(),e)},put:function(e,i){return t("PUT",n(e),i)},remove:function(e){return t("DELETE",n(e))}};return i}),define("models/company",["jquery","knockout","models/wegion","models/job-type","services/datacontext","helpers/modal-helper","helpers/history-helper","base-models/stage-base","models/section-of-stage","models/prop-spec","services/company","models/file-spec","services/wegion","constants/stage-constants","helpers/app-helper","helpers/knockout-lazy"],function(e,t,n,i,r,o,a,s,l,u,c,d,p,f,h){function m(e,t){return(e||[]).map(function(e){return new n(e,t)})}function g(e,t){return(e||[]).map(function(e){return new l(e,t,e.CompanyId)})}var w=[new u("name","Name","Company name","SingleLine",{maxLength:255}),new u("description","Description","Company description","MultiLine",{}),new u("fileSpecOfLogo","FileSpecOfLogo","Company logo","FileLine",{width:100,nestedClientId:"idOfFileSpecOfLogo"}),new u("idOfFileSpecOfLogo","IdOfFileSpecOfLogo","","",{})],v=function(e,n){e=e||{},this.getRootMdl=function(){return n.getRootMdl()},this.id=e.Id,this.propSpecList=w,this.stageKey=f.company.id,s.call(this,e),this.wegions=t.observableArray(),this.isLoadedWegions=t.observable(!1),this.jobTypeList=t.lazyObservableArray(this.loadJobTypeList,this),this.listOfSection(g(e.ListOfSectionOfCompanyDto,this)),this.loadWegions()};return h.inherits(v,s),v.prototype.toDto=function(){var e={Id:this.id};return this.propSpecList.forEach(function(n){e[n.serverId]=t.unwrap(this[n.clientId])},this),e},v.prototype.postJobType=function(e){r.postCompanyJobType(this.id,{name:e,description:"",companyId:this.id}).done(this.pushJobType.bind(this))},v.prototype.pushJobType=function(e){this.jobTypeList.push(new i(e))},v.prototype.loadWegions=function(){t.unwrap(this.isLoadedWegions)||p.getInclusive(this.id).done(this.successLoadWegions.bind(this))},v.prototype.successLoadWegions=function(e){this.wegions(m(e,this)),this.isLoadedWegions(!0)},v.prototype.removeChild=function(e){var t=this;p.remove(e.id).done(function(){t.wegions.remove(e)})},v.prototype.getListOfStageByKey=function(e){switch(e){case f.company.id:return[this];case f.wegion.id:return t.unwrap(this.wegions);case f.wield.id:return this.calcListOfWield();case f.wroup.id:return this.calcListOfWroup();case f.well.id:return this.calcListOfWell()}},v.prototype.calcListOfWield=function(){var e=[];return t.unwrap(this.wegions).forEach(function(n){t.unwrap(n.wields).forEach(function(t){e.push(t)})}),e},v.prototype.calcListOfWroup=function(){var e=[];return t.unwrap(this.wegions).forEach(function(n){t.unwrap(n.wields).forEach(function(n){t.unwrap(n.wroups).forEach(function(t){e.push(t)})})}),e},v.prototype.calcListOfWell=function(){var e=[];return t.unwrap(this.wegions).forEach(function(n){t.unwrap(n.wields).forEach(function(n){t.unwrap(n.wroups).forEach(function(n){t.unwrap(n.wells).forEach(function(t){e.push(t)})})})}),e},v.prototype.save=function(){c.put(this.id,this.toDto()).done(this.successSave.bind(this))},v.prototype.successSave=function(e){var t=this.propSpecList.filter(function(e){return"fileSpecOfLogo"===e.clientId})[0];if(!t)throw new ReferenceError("No fileSpecOfLogo property for company model");var n=e[t.serverId];this[t.clientId](n?new d(n):null)},v.prototype.postWegion=function(e,t){p.post({Name:e,Description:"",CompanyId:this.id}).done(t)},v.prototype.pushWegion=function(e){this.wegions.push(new n(e,this))},v.prototype.loadJobTypeList=function(){r.getJobTypeList(this.id).done(this.importJobTypeList.bind(this))},v.prototype.importJobTypeList=function(e){e=e||[],this.jobTypeList(e.map(function(e){return new i(e)}))},v.prototype.getIdOfCompany=function(){return this.id},v}),define("models/employee",["knockout","models/company"],function(e,t){var n=function(e,n){e=e||{};var i=this;this.getRootMdl=function(){return n.getRootMdl()},this.companyId=e.CompanyId,this.company=new t(e.CompanyDto,i),this.userProfileId=e.UserProfileId,this.accessLevel=e.AccessLevel,this.canViewAll=4===(4&this.accessLevel),this.canEditAll=2===(2&this.accessLevel),this.canManageAll=1===(1&this.accessLevel)};return n}),define("models/section-pattern",[],function(){var e=function(e){e=e||{},this.id=e.Id,this.name=e.Name,this.iconClass=this.id+"-icon",this.idOfStage=e.IdOfStage,this.fileTypeRegExp=e.FileFormatRegExp,this.isView=e.IsView,this.isFolder=e.IsFolder,this.isWidget=e.IsWidget};return e}),define("models/user-profile",["knockout","models/employee","helpers/lang-helper","services/company-user","services/company","helpers/history-helper","constants/stage-constants","models/prop-spec","base-models/stage-base","helpers/app-helper"],function(e,t,n,i,r,o,a,s,l,u){function c(e,n){return e.map(function(e){return new t(e,n)})}var d=[new s("email","Email","Email","SingleLine",{maxLength:320})],p=function(t,n){t=t||{};var i=this;this.stageKey=a.upro.id,this.getRootMdl=function(){return n},this.propSpecList=d,this.id=t.Id,l.call(i,t),this.employees=e.observableArray(),this.isLoadedEmployees=e.observable(!1),this.nameOfCreatedCompany=e.observable(""),this.postEmployee=function(){var t=e.unwrap(i.nameOfCreatedCompany);t&&r.post({Name:t,Description:""}).done(function(){i.isLoadedEmployees(!1),i.loadEmployees()})},i.isOwnerAlready=e.computed({read:function(){var t=!1,n=e.unwrap(i.employees);return n.forEach(function(n){e.unwrap(n.canManageAll)&&(t=!0)}),t},deferEvaluation:!0})};return u.inherits(p,l),p.prototype.loadEmployees=function(){if(!e.unwrap(this.isLoadedEmployees)){var t=this;i.getCompanyUserList().done(function(e){t.employees(c(e,t)),t.isLoadedEmployees(!0)})}},p.prototype.removeChild=function(t){var n=this,i=e.unwrap(t.id);r.remove(i).done(function(){n.isLoadedEmployees(!1),n.loadEmployees()})},p}),define("models/wfm-param-squad",["knockout","models/wfm-parameter"],function(e,t){function n(e){return(e||[]).map(function(e){return new t(e)})}var i=function(t){t=t||{},this.id=t.Id,this.wfmParameterList=e.observableArray(),this.toPlainJson=function(){return e.toJS(this)},t.WfmParameterDtoList&&this.wfmParameterList(n(t.WfmParameterDtoList))};return i}),define("services/wfm-param-squad",["helpers/ajax-request"],function(e){var t=function(e){return"//wfm-report.herokuapp.com/api/wfm-param-squads"+(e?"/inclusive":"")},n={get:function(){return e("GET",t())},getInclusive:function(){return e("GET",t(!0))}};return n}),define("models/workspace",["knockout","helpers/app-helper","models/user-profile","models/section-pattern","services/section-pattern","models/wfm-param-squad","services/wfm-param-squad","services/auth","helpers/knockout-lazy"],function(e,t,n,i,r,o,a,s){var l=function(){this.wfmParamSquadList=e.lazyObservableArray(this.loadParamSquadList,this),this.ListOfSectionPatternDto=e.lazyObservableArray(this.loadListOfSectionPattern,this),this.wfmParameterList=e.computed({read:this.calcWfmParameterList,deferEvaluation:!0,owner:this}),this.userProfile=e.observable(),this.isTriedToLoadUserProfile=e.observable(!1)};return l.prototype.setUserProfile=function(e){this.userProfile(new n(e,this))},l.prototype.cleanUserProfile=function(){this.userProfile(null)},l.prototype.tryToLoadUserProfile=function(){s.getUserProfile().done(this.setUserProfile.bind(this)).always(this.setTryStatus.bind(this))},l.prototype.setTryStatus=function(){this.isTriedToLoadUserProfile(!0)},l.prototype.accountLogOff=function(){s.accountLogOff(),this.cleanUserProfile()},l.prototype.calcWfmParameterList=function(){var t=[];return e.unwrap(this.wfmParamSquadList).forEach(function(n){e.unwrap(n.wfmParameterList).forEach(function(e){t.push(e)})}),t},l.prototype.loadParamSquadList=function(){a.getInclusive().done(this.applyParamSquadList.bind(this))},l.prototype.applyParamSquadList=function(e){e=e||[],this.wfmParamSquadList(e.map(function(e){return new o(e)}))},l.prototype.loadListOfSectionPattern=function(){r.get().done(this.applyListOfSectionPattern.bind(this))},l.prototype.applyListOfSectionPattern=function(e){e=e||[],this.ListOfSectionPatternDto(e.map(function(e){return new i(e)}))},l});
//# sourceMappingURL=main-bundle-0.9.9.js.map