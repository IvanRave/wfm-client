<!-- vwmWell -->
<div data-bind="with: mdlStage">
  <div class="clearfix" data-bind="if: $root.isEmployeeInEditMode">
    <!-- ko with: testScopeNewStartUnixTime -->
    <div class="pull-left">
      {{capitalizeFirst lang.date}}:
      <input class="input-sm" type="text" size="10" data-bind="datepicker: unixDate, datepickerOptions: { format: 'yyyy-mm-dd', selectYears: true, selectMonths: true }" />
    </div>
    <div class="pull-left min-left-margin">
      {{capitalizeFirst lang.hours}}:
      <input class="input-sm" type="number" min="0" max="23" data-bind="value: hour" placeholder="{{lang.hours}}"></input>
    </div>
    <div class="pull-left min-left-margin">
      {{capitalizeFirst lang.minutes}}:
      <input class="input-sm" type="number" min="0" max="59" data-bind="value: minute" placeholder="{{lang.minutes}}"></input>
    </div>
    <!-- /ko -->
    <div class="pull-left">
      <button type="button" class="btn btn-default btn-sm" data-bind="enable: isEnabledPostTestScope, click: postTestScope">
        <i class="glyphicon glyphicon-plus"></i> {{capitalizeFirst lang.toCreateTest}}
      </button>
    </div>
  </div>
  <div data-bind="foreach: { data: sortedListOfTestScope, as: 'testScope' }">
    <div style="margin-top: 16px; background-color: #f5f5f5">
      <div class="test-header clearfix" data-bind="css: { 'test-approved': isApproved, 'test-declined': isApproved() === false }">
        <div class="pull-left" style="padding:2px 0">
          <button class="btn btn-default btn-xs" data-bind="click: $parent.chooseTestScope">
            <i class="glyphicon glyphicon-chevron-up" data-bind="visible: $parent.selectedTestScope() === testScope"></i> 
            <i class="glyphicon glyphicon-chevron-down" data-bind="visible: $parent.selectedTestScope() !== testScope"></i>
            Details
          </button>
        </div>
        <div class="pull-left" style="margin-left: 16px; padding:2px;">
          <span data-bind="text: startUnixTimeDateView"></span>
        </div>
        <div class="pull-right">
          <div class="btn-group" data-bind="if: isApproved() === null">
            <button type="button" class="btn btn-sm btn-success" data-bind="click: function(){ setIsApproved(true); }">{{capitalizeFirst lang.approve}}</button>
            <button type="button" class="btn btn-sm btn-danger" data-bind="click: function(){ setIsApproved(false); }">{{capitalizeFirst lang.decline}}</button>
          </div>
          <span data-bind="if: isApproved() === true">{{capitalizeFirst lang.valid}}</span>
          <span data-bind="if: isApproved() === false">{{capitalizeFirst lang.invalid}}</span>
        </div>
      </div>
      <table class="table table-condensed">
        <thead>
          <tr>
            <th>Hour</th>
            <!-- ko foreach: $parent.getWellGroup().listOfWfmParameterOfWroup -->
            <th>
              <span data-bind="text: wfmParameterId"></span>
            </th>
            <!-- /ko -->
            <th data-bind="slideVisible: $parent.selectedTestScope() === testScope">{{capitalizeFirst lang.comment}}</th>
            <th data-bind="slideVisible: $parent.selectedTestScope() === testScope"></th>
          </tr>
        </thead>
        <tbody data-bind="slideVisible: $parent.selectedTestScope() === testScope">
          <!-- ko foreach: {data: testDataList, as: 'testData'} -->
          <tr>
            <td>
              <span data-bind="text: hourNumber"></span>
            </td>
            <!-- ko foreach: $parents[1].getWellGroup().listOfWfmParameterOfWroup -->
            <td>
              <div data-bind="if: testData.isEdit() === true">
                <input class="input-sm" style="width: 50px" data-bind="value: testData.dict[$data.wfmParameterId]" />
              </div>
              <div data-bind="if: testData.isEdit() === false">
                <span data-bind="text: testData.dict[$data.wfmParameterId]"></span>
              </div>
            </td>
            <!-- /ko -->
            <td>
              <div data-bind="if: isEdit() === true">
                <input data-bind="value: comment" />
              </div>
              <div data-bind="if: isEdit() === false">
                <span data-bind="text: comment"></span>
              </div>
            </td>
            <td>
              <button type="button" class="btn btn-default btn-xs" data-bind="click: editTestData, slideVisible: isEdit() === false">{{capitalizeFirst lang.toEdit}}</button>
              <button type="button" class="btn btn-default btn-xs" data-bind="click: saveTestData, slideVisible: isEdit() === true">{{capitalizeFirst lang.toSave}}</button>
              <button type="button" class="btn btn-default btn-xs" data-bind="click: cancelEditTestData, slideVisible: isEdit() === true">{{capitalizeFirst lang.toCancel}}</button>
              <button type="button" class="btn btn-default btn-xs" data-bind="click: testScope.deleteTestData, slideVisible: $index() === ($parent.testDataList().length - 1)">{{capitalizeFirst lang.toDelete}}</button>
            </td>
          </tr>
          <!-- /ko -->
          <tr>
            <td colspan="6">
              <button type="button" class="btn btn-xs btn-default" data-bind="click: testScope.addTestData">{{capitalizeFirst lang.toAddHour}}</button>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td>{{capitalizeFirst lang.total}}</td>
            <!-- ko foreach: $parent.getWellGroup().listOfWfmParameterOfWroup -->
            <td>
              <b data-bind="text: testScope.testDataTotal()[$data.wfmParameterId] "></b>
            </td>
            <!-- /ko -->
            <td data-bind="slideVisible: $parent.selectedTestScope() === testScope"></td>
            <td data-bind="slideVisible: $parent.selectedTestScope() === testScope"></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>